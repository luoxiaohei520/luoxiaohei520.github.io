<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><div id="myscoll"></div><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>05Spring Boot çš„å®é™…å¼€å‘ä¸­ç”Ÿäº§å°±ç»ªåŠŸèƒ½ | Miaow.Y.Huçš„åšå®¢ğŸ¥</title><meta name="keywords" content="Spring Boot"><meta name="author" content="Miaow.Y.HuğŸ¥"><meta name="copyright" content="Miaow.Y.HuğŸ¥"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="Spring Bootåœ¨å®é™…å¼€å‘ä¸­çš„è¿ç”¨ï¼Œå¯å¸®åŠ©ä½ åœ¨å°†åº”ç”¨ç¨‹åºæ¨é€åˆ°ç”Ÿäº§ç¯å¢ƒæ—¶ç›‘æ§å’Œç®¡ç†åº”ç”¨ç¨‹åºã€‚ä½ å¯ä»¥é€‰æ‹©ä½¿ç”¨ HTTP ç«¯ç‚¹æˆ– JMX æ¥ç®¡ç†å’Œç›‘æ§åº”ç”¨ç¨‹åºã€‚å®¡è®¡ã€å¥åº·å’ŒæŒ‡æ ‡æ”¶é›†ä¹Ÿå¯ä»¥è‡ªåŠ¨åº”ç”¨äºä½ çš„åº”ç”¨ç¨‹åºã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="05Spring Boot çš„å®é™…å¼€å‘ä¸­ç”Ÿäº§å°±ç»ªåŠŸèƒ½">
<meta property="og:url" content="https://www.blog.909111.xyz/posts/f95521c8.html">
<meta property="og:site_name" content="Miaow.Y.Huçš„åšå®¢ğŸ¥">
<meta property="og:description" content="Spring Bootåœ¨å®é™…å¼€å‘ä¸­çš„è¿ç”¨ï¼Œå¯å¸®åŠ©ä½ åœ¨å°†åº”ç”¨ç¨‹åºæ¨é€åˆ°ç”Ÿäº§ç¯å¢ƒæ—¶ç›‘æ§å’Œç®¡ç†åº”ç”¨ç¨‹åºã€‚ä½ å¯ä»¥é€‰æ‹©ä½¿ç”¨ HTTP ç«¯ç‚¹æˆ– JMX æ¥ç®¡ç†å’Œç›‘æ§åº”ç”¨ç¨‹åºã€‚å®¡è®¡ã€å¥åº·å’ŒæŒ‡æ ‡æ”¶é›†ä¹Ÿå¯ä»¥è‡ªåŠ¨åº”ç”¨äºä½ çš„åº”ç”¨ç¨‹åºã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://cdn.909111.xyz/upload/20231206/69956bc04e2445f189b053fe8b8daac9.jpg">
<meta property="article:published_time" content="2023-11-09T02:50:23.333Z">
<meta property="article:modified_time" content="2023-11-09T02:50:23.333Z">
<meta property="article:author" content="Miaow.Y.HuğŸ¥">
<meta property="article:tag" content="Spring Boot">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://cdn.909111.xyz/upload/20231206/69956bc04e2445f189b053fe8b8daac9.jpg"><link rel="shortcut icon" href="/"><link rel="canonical" href="https://www.blog.909111.xyz/posts/f95521c8"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç®€"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.js',
      css: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '05Spring Boot çš„å®é™…å¼€å‘ä¸­ç”Ÿäº§å°±ç»ªåŠŸèƒ½',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-11-09 10:50:23'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><style id="themeColor"></style><style id="rightSide"></style><style id="transPercent"></style><style id="blurNum"></style><style id="settingStyle"></style><span id="fps"></span><style id="defineBg"></style><style id="menu_shadow"></style><link rel="stylesheet" href="/css/universe.css"><link rel="stylesheet" href="https://cdn1.tianli0.top/npm/element-ui@2.15.6/packages/theme-chalk/lib/index.css"><link rel="stylesheet" href="/css/aplayer.css"><script src="https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js"></script><svg aria-hidden="true" style="position:absolute; overflow:hidden; width:0; height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Miaow.Y.Huçš„åšå®¢ğŸ¥" type="application/atom+xml">
</head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tuchuang.voooe.cn/images/2023/11/09/myLogo.png" onerror="onerror=null;src='/assets/r1.jpg'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">32</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">17</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-home"></use></svg><span class="menu_word" style="font-size:17px"> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--article"></use></svg><span class="menu_word" style="font-size:17px"> æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang1">                   </use></svg><span class="menu_word" style="font-size:17px"> å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-sekuaibiaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pinweishenghuo"></use></svg><span class="menu_word" style="font-size:17px"> ä¼‘é—²</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-yinle">                   </use></svg><span class="menu_word" style="font-size:17px"> å…«éŸ³ç›’</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/movies/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-dianying1">                   </use></svg><span class="menu_word" style="font-size:17px"> å½±é™¢</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-youxishoubing">                   </use></svg><span class="menu_word" style="font-size:17px"> æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> å…«å®ç®±</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-tubiaozhizuomoban">                   </use></svg><span class="menu_word" style="font-size:17px"> ç”»å»Š</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-nvwumao">                   </use></svg><span class="menu_word" style="font-size:17px"> åŠ¨ç”»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> ç½‘å€å¯¼èˆª</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shejiaoxinxi"></use></svg><span class="menu_word" style="font-size:17px"> ç¤¾äº¤</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/social/fcircle/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pengyouquan">                   </use></svg><span class="menu_word" style="font-size:17px"> æœ‹å‹åœˆ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyan">                   </use></svg><span class="menu_word" style="font-size:17px"> ç•™è¨€æ¿</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-lianjie">                   </use></svg><span class="menu_word" style="font-size:17px"> å‹äººå¸</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-maoliang"></use></svg><span class="menu_word" style="font-size:17px"> ä¸ªäºº</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shujutongji1">                   </use></svg><span class="menu_word" style="font-size:17px"> æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/love/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-love-sign">                   </use></svg><span class="menu_word" style="font-size:17px"> æ‹çˆ±å°å±‹</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Miaow.Y.Huçš„åšå®¢ğŸ¥</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-home"></use></svg><span class="menu_word" style="font-size:17px"> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--article"></use></svg><span class="menu_word" style="font-size:17px"> æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang1">                   </use></svg><span class="menu_word" style="font-size:17px"> å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-sekuaibiaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pinweishenghuo"></use></svg><span class="menu_word" style="font-size:17px"> ä¼‘é—²</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-yinle">                   </use></svg><span class="menu_word" style="font-size:17px"> å…«éŸ³ç›’</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/movies/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-dianying1">                   </use></svg><span class="menu_word" style="font-size:17px"> å½±é™¢</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-youxishoubing">                   </use></svg><span class="menu_word" style="font-size:17px"> æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> å…«å®ç®±</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-tubiaozhizuomoban">                   </use></svg><span class="menu_word" style="font-size:17px"> ç”»å»Š</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-nvwumao">                   </use></svg><span class="menu_word" style="font-size:17px"> åŠ¨ç”»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> ç½‘å€å¯¼èˆª</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shejiaoxinxi"></use></svg><span class="menu_word" style="font-size:17px"> ç¤¾äº¤</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/social/fcircle/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pengyouquan">                   </use></svg><span class="menu_word" style="font-size:17px"> æœ‹å‹åœˆ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyan">                   </use></svg><span class="menu_word" style="font-size:17px"> ç•™è¨€æ¿</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-lianjie">                   </use></svg><span class="menu_word" style="font-size:17px"> å‹äººå¸</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-maoliang"></use></svg><span class="menu_word" style="font-size:17px"> ä¸ªäºº</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shujutongji1">                   </use></svg><span class="menu_word" style="font-size:17px"> æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/love/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-love-sign">                   </use></svg><span class="menu_word" style="font-size:17px"> æ‹çˆ±å°å±‹</span></a></li></ul></div></div><center id="name-container"><a id="page-name" href="javascript:scrollToTop()">PAGE_NAME</a></center><div id="nav-right"><div id="search-button"><a class="search faa-parent animated-hover" title="æ£€ç´¢ç«™å†…ä»»ä½•ä½ æƒ³è¦çš„ä¿¡æ¯"><svg class="faa-tada icon" style="height:24px;width:24px;fill:currentColor;position:relative;top:6px" aria-hidden="true"><use xlink:href="#icon-valentine_-search-love-find-heart"></use></svg><span> æœç´¢</span></a></div><a class="meihua faa-parent animated-hover" onclick="toggleWinbox()" title="ç¾åŒ–è®¾ç½®-è‡ªå®šä¹‰ä½ çš„é£æ ¼" id="meihua-button"><svg class="faa-tada icon" style="height:26px;width:26px;fill:currentColor;position:relative;top:8px" aria-hidden="true"><use xlink:href="#icon-tupian1"></use></svg></a><a class="sun_moon faa-parent animated-hover" onclick="switchNightMode()" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢" id="nightmode-button"><svg class="faa-tada" style="height:25px;width:25px;fill:currentColor;position:relative;top:7px" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon">       </use></svg></a><div id="toggle-menu"><a><i class="fas fa-bars fa-fw"></i></a></div></div></div></nav><div id="post-info"><h1 class="post-title">05Spring Boot çš„å®é™…å¼€å‘ä¸­ç”Ÿäº§å°±ç»ªåŠŸèƒ½</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><svg class="meta_icon post-meta-icon" style="width:30px;height:30px;position:relative;top:10px"><use xlink:href="#icon-rili"></use></svg><span class="post-meta-label">å‘è¡¨äº </span><time class="post-meta-date-created" datetime="2023-11-09T02:50:23.333Z" title="å‘è¡¨äº 2023-11-09 10:50:23">2023-11-09</time><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-gengxin1"></use></svg><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-11-09T02:50:23.333Z" title="æ›´æ–°äº 2023-11-09 10:50:23">2023-11-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-biaoqian"></use></svg><a class="post-meta-categories" href="/categories/Spring-Boot/">Spring Boot</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:8px"><use xlink:href="#icon-charuword"></use></svg><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">1.3w</span><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:20px;height:20px;position:relative;top:5px"><use xlink:href="#icon-shizhong"></use></svg><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>48åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="05Spring Boot çš„å®é™…å¼€å‘ä¸­ç”Ÿäº§å°±ç»ªåŠŸèƒ½"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:5px"><use xlink:href="#icon-eye"></use></svg><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><a id="production-ready"></a></p>
<h1 id="äº”ã€Spring-Boot-Actuator-ç”Ÿäº§å°±ç»ªåŠŸèƒ½"><a href="#äº”ã€Spring-Boot-Actuator-ç”Ÿäº§å°±ç»ªåŠŸèƒ½" class="headerlink" title="äº”ã€Spring Boot Actuator: ç”Ÿäº§å°±ç»ªåŠŸèƒ½"></a>äº”ã€Spring Boot Actuator: ç”Ÿäº§å°±ç»ªåŠŸèƒ½</h1><p>Spring Boot åŒ…å«è®¸å¤šå…¶ä»–åŠŸèƒ½ï¼Œå¯å¸®åŠ©ä½ åœ¨å°†åº”ç”¨ç¨‹åºæ¨é€åˆ°ç”Ÿäº§ç¯å¢ƒæ—¶ç›‘æ§å’Œç®¡ç†åº”ç”¨ç¨‹åºã€‚ä½ å¯ä»¥é€‰æ‹©ä½¿ç”¨ HTTP ç«¯ç‚¹æˆ– JMX æ¥ç®¡ç†å’Œç›‘æ§åº”ç”¨ç¨‹åºã€‚å®¡è®¡ã€å¥åº·å’ŒæŒ‡æ ‡æ”¶é›†ä¹Ÿå¯ä»¥è‡ªåŠ¨åº”ç”¨äºä½ çš„åº”ç”¨ç¨‹åºã€‚</p>
<p><a id="production-ready-enabling"></a></p>
<h2 id="52ã€å¯ç”¨ç”Ÿäº§å°±ç»ªåŠŸèƒ½"><a href="#52ã€å¯ç”¨ç”Ÿäº§å°±ç»ªåŠŸèƒ½" class="headerlink" title="52ã€å¯ç”¨ç”Ÿäº§å°±ç»ªåŠŸèƒ½"></a>52ã€å¯ç”¨ç”Ÿäº§å°±ç»ªåŠŸèƒ½</h2><p><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator"><code>spring-boot-actuator</code></a> æ¨¡å—æä¾›äº† Spring Boot çš„æ‰€æœ‰ç”Ÿäº§å°±ç»ªåŠŸèƒ½ã€‚å¯ç”¨è¿™äº›åŠŸèƒ½çš„æœ€ç®€å•æ–¹æ³•æ˜¯æ·»åŠ  <code>spring-boot-starter-actuator</code> starter åˆ°ä¾èµ–ä¸­ã€‚</p>
<blockquote>

**Actuator çš„å®šä¹‰**

Actuator æ˜¯åˆ¶é€ æœ¯è¯­ï¼ŒæŒ‡çš„æ˜¯ç”¨äºç§»åŠ¨æˆ–æ§åˆ¶æŸç‰©çš„æœºæ¢°è£…ç½®ã€‚Actuator å¯ä»¥é€šè¿‡ä¸€ä¸ªå°çš„å˜åŒ–äº§ç”Ÿå¤§é‡çš„è¿åŠ¨ã€‚

</blockquote>

<p>è¦å°† actuator æ·»åŠ åˆ°åŸºäº Maven çš„é¡¹ç›®ï¼Œè¯·æ·»åŠ ä»¥ä¸‹ starter ä¾èµ–é¡¹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¯¹äº Gradleï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å£°æ˜ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">	compile(<span class="string">&quot;org.springframework.boot:spring-boot-starter-actuator&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-endpoints"></a></p>
<h2 id="53ã€ç«¯ç‚¹"><a href="#53ã€ç«¯ç‚¹" class="headerlink" title="53ã€ç«¯ç‚¹"></a>53ã€ç«¯ç‚¹</h2><p>é€šè¿‡ Actuator ç«¯ç‚¹ï¼Œä½ å¯ä»¥ç›‘æ§åº”ç”¨ç¨‹åºå¹¶ä¸ä¹‹äº¤äº’ã€‚Spring Boot åŒ…å«è®¸å¤šå†…ç½®ç«¯ç‚¹ï¼Œä¹Ÿå…è®¸ä½ æ·»åŠ è‡ªå·±çš„ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼Œ<code>health</code> ç«¯ç‚¹æä¾›åŸºæœ¬çš„åº”ç”¨ç¨‹åºå¥åº·ä¿¡æ¯ã€‚</p>
<p>å¯ä»¥<a href="#production-ready-endpoints-enabling-endpoints">å¯ç”¨æˆ–ç¦ç”¨</a>æ¯ä¸ªç«¯ç‚¹ã€‚å®ƒå¯æ§åˆ¶å½“å…¶ bean å­˜åœ¨äºåº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­æ˜¯å¦åˆ›å»ºç«¯ç‚¹ã€‚è¦è¿›è¡Œè¿œç¨‹è®¿é—®ï¼Œå¿…é¡»<a href="#production-ready-endpoints-exposing-endpoints">é€šè¿‡ JMX æˆ– HTTP æš´éœ²ç«¯ç‚¹</a>ã€‚å¤§å¤šæ•°åº”ç”¨ç¨‹åºé€‰æ‹© HTTP æ–¹å¼ï¼Œç«¯ç‚¹çš„ ID ä»¥åŠ <code>/actuator</code> çš„å‰ç¼€æ˜ å°„åˆ°ä¸€ä¸ª URLã€‚ä¾‹å¦‚ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>health</code> ç«¯ç‚¹æ˜ å°„åˆ° <code>/actuator/health</code>ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸æŠ€æœ¯æ— å…³çš„ç«¯ç‚¹ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>ID</th>
<th>æè¿°</th>
<th style="text-align:center">é»˜è®¤å¯ç”¨</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>auditevents</code></td>
<td>æš´éœ²å½“å‰åº”ç”¨ç¨‹åºçš„å®¡è®¡äº‹ä»¶ä¿¡æ¯ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>beans</code></td>
<td>æ˜¾ç¤ºåº”ç”¨ç¨‹åºä¸­æ‰€æœ‰ Spring bean çš„å®Œæ•´åˆ—è¡¨ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>caches</code></td>
<td>æš´éœ²å¯ç”¨çš„ç¼“å­˜ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>conditions</code></td>
<td>æ˜¾ç¤ºåœ¨é…ç½®å’Œè‡ªåŠ¨é…ç½®ç±»ä¸Šè¯„ä¼°çš„æ¡ä»¶ä»¥åŠå®ƒä»¬åŒ¹é…æˆ–ä¸åŒ¹é…çš„åŸå› ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>configprops</code></td>
<td>æ˜¾ç¤ºæ‰€æœ‰ <code>@ConfigurationProperties</code> çš„æ ¡å¯¹æ¸…å•ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>env</code></td>
<td>æš´éœ² Spring <code>ConfigurableEnvironment</code> ä¸­çš„å±æ€§ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>flyway</code></td>
<td>æ˜¾ç¤ºå·²åº”ç”¨çš„ Flyway æ•°æ®åº“è¿ç§»ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>health</code></td>
<td>æ˜¾ç¤ºåº”ç”¨ç¨‹åºå¥åº·ä¿¡æ¯</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>httptrace</code></td>
<td>æ˜¾ç¤º HTTP è¿½è¸ªä¿¡æ¯ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œæœ€å 100 ä¸ª HTTP è¯·æ±‚/å“åº”äº¤æ¢ï¼‰ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>info</code></td>
<td>æ˜¾ç¤ºåº”ç”¨ç¨‹åºä¿¡æ¯ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>integrationgraph</code></td>
<td>æ˜¾ç¤º Spring Integration å›¾ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>loggers</code></td>
<td>æ˜¾ç¤ºå’Œä¿®æ”¹åº”ç”¨ç¨‹åºä¸­æ—¥å¿—è®°å½•å™¨çš„é…ç½®ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>liquibase</code></td>
<td>æ˜¾ç¤ºå·²åº”ç”¨çš„ Liquibase æ•°æ®åº“è¿ç§»ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>metrics</code></td>
<td>æ˜¾ç¤ºå½“å‰åº”ç”¨ç¨‹åºçš„æŒ‡æ ‡åº¦é‡ä¿¡æ¯ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>mappings</code></td>
<td>æ˜¾ç¤ºæ‰€æœ‰ <code>@RequestMapping</code> è·¯å¾„çš„æ•´ç†æ¸…å•ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>scheduledtasks</code></td>
<td>æ˜¾ç¤ºåº”ç”¨ç¨‹åºä¸­çš„è°ƒåº¦ä»»åŠ¡ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>sessions</code></td>
<td>å…è®¸ä» Spring Session æ”¯æŒçš„ä¼šè¯å­˜å‚¨ä¸­æ£€ç´¢å’Œåˆ é™¤ç”¨æˆ·ä¼šè¯ã€‚å½“ä½¿ç”¨ Spring Session çš„å“åº”å¼ Web åº”ç”¨ç¨‹åºæ”¯æŒæ—¶ä¸å¯ç”¨ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>shutdown</code></td>
<td>æ­£å¸¸å…³é—­åº”ç”¨ç¨‹åºã€‚</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>threaddump</code></td>
<td>æ‰§è¡Œçº¿ç¨‹ dumpã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
</tbody>
</table>
</div>
<p>å¦‚æœä½ çš„åº”ç”¨ç¨‹åºæ˜¯ Web åº”ç”¨ç¨‹åºï¼ˆSpring MVCã€Spring WebFlux æˆ– Jerseyï¼‰ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä»¥ä¸‹é™„åŠ ç«¯ç‚¹ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>ID</th>
<th>æè¿°</th>
<th style="text-align:center">é»˜è®¤å¯ç”¨</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>heapdump</code></td>
<td>è¿”å›ä¸€ä¸ª <code>hprof</code> å † dump æ–‡ä»¶ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>jolokia</code></td>
<td>é€šè¿‡ HTTP æš´éœ² JMX beanï¼ˆå½“ Jolokia åœ¨ classpath ä¸Šæ—¶ï¼Œä¸é€‚ç”¨äº WebFluxï¼‰ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>logfile</code></td>
<td>è¿”å›æ—¥å¿—æ–‡ä»¶çš„å†…å®¹ï¼ˆå¦‚æœå·²è®¾ç½® <code>logging.file</code> æˆ– <code>logging.path</code> å±æ€§ï¼‰ã€‚æ”¯æŒä½¿ç”¨ HTTP <code>Range</code> å¤´æ¥æ£€ç´¢éƒ¨åˆ†æ—¥å¿—æ–‡ä»¶çš„å†…å®¹ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>prometheus</code></td>
<td>ä»¥å¯ä»¥ç”± Prometheus æœåŠ¡å™¨æŠ“å–çš„æ ¼å¼æš´éœ²æŒ‡æ ‡ã€‚</td>
<td style="text-align:center">æ˜¯</td>
</tr>
</tbody>
</table>
</div>
<p>æƒ³äº†è§£æœ‰å…³ Actuator ç«¯ç‚¹åŠå…¶è¯·æ±‚å’Œå“åº”æ ¼å¼çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…å•ç‹¬çš„ API æ–‡æ¡£ï¼ˆ<a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.1.3.RELEASE/actuator-api//html">HTML</a> æˆ– <a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.1.3.RELEASE/actuator-api//pdf/spring-boot-actuator-web-api.pdf">PDF</a>ï¼‰ã€‚</p>
<p><a id="production-ready-endpoints-enabling-endpoints"></a></p>
<h3 id="53-1ã€å¯ç”¨ç«¯ç‚¹"><a href="#53-1ã€å¯ç”¨ç«¯ç‚¹" class="headerlink" title="53.1ã€å¯ç”¨ç«¯ç‚¹"></a>53.1ã€å¯ç”¨ç«¯ç‚¹</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒActuator å¯ç”¨é™¤ <code>shutdown</code> ä¹‹å¤–çš„æ‰€æœ‰ç«¯ç‚¹ã€‚è¦é…ç½®ç«¯ç‚¹çš„å¯ç”¨ï¼Œè¯·ä½¿ç”¨å…¶ <code>management.endpoint.&lt;id&gt;.enabled</code> å±æ€§ã€‚ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•å¯ç”¨å…³é—­ç«¯ç‚¹ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.endpoint.shutdown.enabled</span>=<span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ å¸Œæœ›ç«¯ç‚¹å¯ç”¨æ˜¯é€‰æ‹©æ€§åŠ å…¥è€Œä¸æ˜¯é€‰æ‹©æ€§é€€å‡ºï¼Œè¯·å°† <code>management.endpoints.enabled-by-default</code> å±æ€§è®¾ç½®ä¸º <code>false</code>ï¼Œå¹¶ä½¿ç”¨å„ä¸ªç«¯ç‚¹çš„ <code>enabled</code> å±æ€§é‡æ–°åŠ å…¥ã€‚ä»¥ä¸‹ç¤ºä¾‹å¯ç”¨ <code>info</code> ç«¯ç‚¹å¹¶ç¦ç”¨æ‰€æœ‰å…¶ä»–ç«¯ç‚¹ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.endpoints.enabled-by-default</span>=<span class="literal">false</span></span><br><span class="line"><span class="attr">management.endpoint.info.enabled</span>=<span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p><strong>æ³¨æ„</strong></p>
<blockquote>
<p>å·²å®Œå…¨ä»åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­åˆ é™¤å·²ç¦ç”¨çš„ç«¯ç‚¹ã€‚å¦‚æœåªæƒ³æ›´æ”¹ç«¯ç‚¹æ‰€æš´éœ²çš„æŠ€æœ¯ï¼Œè¯·æ”¹ç”¨ <a href="#production-ready-endpoints-exposing-endpoints"><code>include</code> å’Œ <code>exclude</code> å±æ€§</a>ã€‚</p>
</blockquote>
<p><a id="production-ready-endpoints-exposing-endpoints"></a></p>
<h3 id="53-2ã€æš´éœ²ç«¯ç‚¹"><a href="#53-2ã€æš´éœ²ç«¯ç‚¹" class="headerlink" title="53.2ã€æš´éœ²ç«¯ç‚¹"></a>53.2ã€æš´éœ²ç«¯ç‚¹</h3><p>ç”±äºç«¯ç‚¹å¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œå› æ­¤åº”ä»”ç»†è€ƒè™‘ä½•æ—¶æš´éœ²å®ƒä»¬ã€‚ä¸‹è¡¨æ˜¾ç¤ºäº†å†…ç½®ç«¯ç‚¹å’Œé»˜è®¤æš´éœ²æƒ…å†µï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>ID</th>
<th>JMX</th>
<th style="text-align:center">Web</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>auditevents</code></td>
<td>æ˜¯</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>beans</code></td>
<td>æ˜¯</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>caches</code></td>
<td>æ˜¯</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>conditions</code></td>
<td>æ˜¯</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>configprops</code></td>
<td>æ˜¯</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>env</code></td>
<td>æ˜¯</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>flyway</code></td>
<td>æ˜¯</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>health</code></td>
<td>æ˜¯</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>heapdump</code></td>
<td>N/A</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>httptrace</code></td>
<td>æ˜¯</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>info</code></td>
<td>æ˜¯</td>
<td style="text-align:center">æ˜¯</td>
</tr>
<tr>
<td><code>integrationgraph</code></td>
<td>æ˜¯</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>jolokia</code></td>
<td>N/A</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>logfile</code></td>
<td>N/A</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>loggers</code></td>
<td>æ˜¯</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>liquibase</code></td>
<td>æ˜¯</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>metrics</code></td>
<td>æ˜¯</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>mappings</code></td>
<td>æ˜¯</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>prometheus</code></td>
<td>N/A</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>scheduledtasks</code></td>
<td>æ˜¯</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>sessions</code></td>
<td>æ˜¯</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>shutdown</code></td>
<td>æ˜¯</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td><code>threaddump</code></td>
<td>æ˜¯</td>
<td style="text-align:center">å¦</td>
</tr>
</tbody>
</table>
</div>
<p>è¦æ›´æ”¹æš´éœ²çš„ç«¯ç‚¹ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹ç‰¹å®šçš„ <code>include</code> å’Œ <code>exclude</code> å±æ€§ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>é»˜è®¤</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>management.endpoints.jmx.exposure.exclude</code></td>
<td></td>
</tr>
<tr>
<td><code>management.endpoints.jmx.exposure.include</code></td>
<td><code>*</code></td>
</tr>
<tr>
<td><code>management.endpoints.web.exposure.exclude</code></td>
<td></td>
</tr>
<tr>
<td><code>management.endpoints.web.exposure.include</code></td>
<td><code>info, health</code></td>
</tr>
</tbody>
</table>
</div>
<p><code>include</code> å±æ€§åˆ—å‡ºäº†æš´éœ²çš„ç«¯ç‚¹çš„ IDã€‚<code>exclude</code> å±æ€§åˆ—å‡ºäº†ä¸åº”æš´éœ²çš„ç«¯ç‚¹çš„ IDã€‚<code>exclude</code> å±æ€§ä¼˜å…ˆäº <code>include</code> å±æ€§ã€‚å¯ä»¥ä½¿ç”¨ç«¯ç‚¹ ID åˆ—è¡¨é…ç½® <code>include</code> å’Œ <code>exclude</code> å±æ€§ã€‚</p>
<p>ä¾‹å¦‚ï¼Œè¦åœæ­¢é€šè¿‡ JMX æš´éœ²æ‰€æœ‰ç«¯ç‚¹å¹¶ä»…æš´éœ² <code>health</code> å’Œ <code>info</code> ç«¯ç‚¹ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å±æ€§ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.endpoints.jmx.exposure.include</span>=health,info</span><br></pre></td></tr></table></figure>
<p><code>*</code> å¯ç”¨äºé€‰æ‹©æ‰€æœ‰ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼Œè¦é€šè¿‡ HTTP æš´éœ²é™¤ <code>env</code> å’Œ <code>beans</code> ä¹‹å¤–çš„æ‰€æœ‰ç«¯ç‚¹ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å±æ€§ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.endpoints.web.exposure.include</span>=*</span><br><span class="line"><span class="attr">management.endpoints.web.exposure.exclude</span>=env,beans</span><br></pre></td></tr></table></figure>
<p><strong>æ³¨æ„</strong></p>
<blockquote>

`*` åœ¨ YAML ä¸­å…·æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œå› æ­¤å¦‚æœè¦åŒ…å«ï¼ˆæˆ–æ’é™¤ï¼‰æ‰€æœ‰ç«¯ç‚¹ï¼Œè¯·åŠ¡å¿…æ·»åŠ å¼•å·ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">exposure:</span></span><br><span class="line">        <span class="attr">include:</span> <span class="string">&quot;*&quot;</span></span><br></pre></td></tr></table></figure>

</blockquote>

<p><strong>æ³¨æ„</strong></p>
<blockquote>
<p>å¦‚æœä½ çš„åº”ç”¨ç¨‹åºæ˜¯å…¬å¼€çš„ï¼Œæˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½ ä¹Ÿ<a href="#production-ready-endpoints-security">ä¿æŠ¤ä½ çš„ç«¯ç‚¹</a>ã€‚</p>
</blockquote>
<p><strong>æç¤º</strong></p>
<blockquote>
<p>å¦‚æœè¦åœ¨æš´éœ²ç«¯ç‚¹æ—¶å®ç°è‡ªå·±çš„ç­–ç•¥ï¼Œå¯ä»¥æ³¨å†Œä¸€ä¸ª <code>EndpointFilter</code> beanã€‚</p>
</blockquote>
<p><a id="production-ready-endpoints-security"></a></p>
<h3 id="53-3ã€ä¿æŠ¤-HTTP-ç«¯ç‚¹"><a href="#53-3ã€ä¿æŠ¤-HTTP-ç«¯ç‚¹" class="headerlink" title="53.3ã€ä¿æŠ¤ HTTP ç«¯ç‚¹"></a>53.3ã€ä¿æŠ¤ HTTP ç«¯ç‚¹</h3><p>ä½ åº”è¯¥åƒä¿æŠ¤æ‰€æœ‰å…¶ä»–æ•æ„Ÿ URL ä¸€æ ·æ³¨æ„ä¿æŠ¤ HTTP ç«¯ç‚¹ã€‚å¦‚æœå­˜åœ¨ Spring Securityï¼Œåˆ™é»˜è®¤ä½¿ç”¨ Spring Security çš„å†…å®¹åå•†ç­–ç•¥æ¥ä¿æŠ¤ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ å¸Œæœ›ä¸º HTTP ç«¯ç‚¹é…ç½®è‡ªå®šä¹‰å®‰å…¨ç­–ç•¥ï¼Œåªå…è®¸å…·æœ‰ç‰¹å®šè§’è‰²èº«ä»½çš„ç”¨æˆ·è®¿é—®å®ƒä»¬ï¼ŒSpring Boot æä¾›äº†æ–¹ä¾¿çš„ <code>RequestMatcher</code> å¯¹è±¡ï¼Œå¯ä»¥ä¸ Spring Security ç»“åˆä½¿ç”¨ã€‚</p>
<p>å…¸å‹çš„ Spring Security é…ç½®å¯èƒ½å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ActuatorSecurity</span> <span class="keyword">extends</span> <span class="title class_">WebSecurityConfigurerAdapter</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		http.requestMatcher(EndpointRequest.toAnyEndpoint()).authorizeRequests()</span><br><span class="line">				.anyRequest().hasRole(<span class="string">&quot;ENDPOINT_ADMIN&quot;</span>)</span><br><span class="line">				.and()</span><br><span class="line">			.httpBasic();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ç¤ºä¾‹ä½¿ç”¨ <code>EndpointRequest.toAnyEndpoint()</code> å°†è¯·æ±‚ä¸æ‰€æœ‰ç«¯ç‚¹è¿›è¡ŒåŒ¹é…ï¼Œç„¶åç¡®ä¿æ‰€æœ‰ç«¯ç‚¹éƒ½å…·æœ‰ <code>ENDPOINT_ADMIN</code> è§’è‰²ã€‚<code>EndpointRequest</code> ä¸Šè¿˜æä¾›äº†å…¶ä»–å‡ ç§åŒ¹é…å™¨æ–¹æ³•ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… API æ–‡æ¡£ï¼ˆ<a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.1.3.RELEASE/actuator-api//html">HTML</a>æˆ– <a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.1.3.RELEASE/actuator-api//pdf/spring-boot-actuator-web-api.pdf">PDF</a>ï¼‰ã€‚</p>
<p>å¦‚æœåº”ç”¨ç¨‹åºéƒ¨ç½²åœ¨æœ‰é˜²ç«å¢™çš„ç¯å¢ƒï¼Œä½ å¯èƒ½å¸Œæœ›æ— éœ€èº«ä»½éªŒè¯å³å¯è®¿é—®æ‰€æœ‰ Actuator ç«¯ç‚¹ã€‚ä½ å¯ä»¥é€šè¿‡æ›´æ”¹ <code>management.endpoints.web.exposure.include</code> å±æ€§æ¥æ‰§è¡Œæ­¤æ“ä½œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><strong>application.properties</strong></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.endpoints.web.exposure.include</span>=*</span><br></pre></td></tr></table></figure>
<p>æ­¤å¤–ï¼Œå¦‚æœå­˜åœ¨ Spring Securityï¼Œåˆ™éœ€è¦æ·»åŠ è‡ªå®šä¹‰å®‰å…¨é…ç½®ï¼Œä»¥å…è®¸å¯¹ç«¯ç‚¹è¿›è¡Œæœªç»èº«ä»½éªŒè¯çš„è®¿é—®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ActuatorSecurity</span> <span class="keyword">extends</span> <span class="title class_">WebSecurityConfigurerAdapter</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		http.requestMatcher(EndpointRequest.toAnyEndpoint()).authorizeRequests()</span><br><span class="line">			.anyRequest().permitAll();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-endpoints-caching"></a></p>
<h3 id="53-4ã€é…ç½®ç«¯ç‚¹"><a href="#53-4ã€é…ç½®ç«¯ç‚¹" class="headerlink" title="53.4ã€é…ç½®ç«¯ç‚¹"></a>53.4ã€é…ç½®ç«¯ç‚¹</h3><p>ç«¯ç‚¹å¯¹ä¸å¸¦å‚æ•°è¯»å–æ“ä½œçš„å“åº”è‡ªåŠ¨ç¼“å­˜ã€‚è¦é…ç½®ç«¯ç‚¹ç¼“å­˜å“åº”çš„æ—¶é—´é•¿åº¦ï¼Œè¯·ä½¿ç”¨å…¶ <code>cache.time-to-live</code> å±æ€§ã€‚ä»¥ä¸‹ç¤ºä¾‹å°†beansç«¯ç‚¹ç¼“å­˜çš„ç”Ÿå­˜æ—¶é—´è®¾ç½®ä¸º10ç§’ï¼š</p>
<p><strong>application.properties</strong></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.endpoint.beans.cache.time-to-live</span>=<span class="number">10</span>s</span><br></pre></td></tr></table></figure>
<p><strong>æ³¨æ„</strong></p>
<blockquote>
<p>å‰ç¼€ <code>management.endpoint.&lt;name&gt;</code> ç”¨äºå”¯ä¸€æ ‡è¯†é…ç½®çš„ç«¯ç‚¹ã€‚</p>
</blockquote>
<p><strong>æ³¨æ„</strong></p>
<blockquote>
<p>åœ¨è¿›è¡Œä¸€ä¸ªèº«ä»½éªŒè¯ HTTP è¯·æ±‚æ—¶ï¼Œ<code>Principal</code> è¢«è§†ä¸ºç«¯ç‚¹çš„è¾“å…¥ï¼Œå› æ­¤ä¸ä¼šç¼“å­˜å“åº”ã€‚</p>
</blockquote>
<p><a id="production-ready-endpoints-hypermedia"></a></p>
<h3 id="53-5ã€Actuator-Web-ç«¯ç‚¹è¶…åª’ä½“"><a href="#53-5ã€Actuator-Web-ç«¯ç‚¹è¶…åª’ä½“" class="headerlink" title="53.5ã€Actuator Web ç«¯ç‚¹è¶…åª’ä½“"></a>53.5ã€Actuator Web ç«¯ç‚¹è¶…åª’ä½“</h3><p>æ·»åŠ  <strong>discovery page</strong>ï¼Œå…¶åŒ…å«æŒ‡å‘æ‰€æœ‰ç«¯ç‚¹çš„é“¾æ¥ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ<strong>discovery page</strong> åœ¨ <code>/actuator</code> ä¸Šå¯è®¿é—®ã€‚</p>
<p>é…ç½®ä¸€ä¸ªè‡ªå®šä¹‰ç®¡ç†ä¸Šä¸‹æ–‡ï¼ˆmanagement contextï¼‰è·¯å¾„æ—¶ï¼Œ<strong>discovery page</strong> ä¼šè‡ªåŠ¨ä» <code>/actuator</code> ç§»åŠ¨åˆ°ç®¡ç†ä¸Šä¸‹æ–‡çš„æ ¹ç›®å½•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç®¡ç†ä¸Šä¸‹æ–‡è·¯å¾„æ˜¯ <code>/management</code>ï¼Œåˆ™å¯ä»¥ä» <code>/management</code> è·å– discovery pageã€‚å½“ç®¡ç†ä¸Šä¸‹æ–‡è·¯å¾„è®¾ç½®ä¸º <code>/</code> æ—¶ï¼Œå°†ç¦ç”¨å‘ç°é¡µé¢ä»¥é˜²æ­¢ä¸å…¶ä»–æ˜ å°„å†²çªã€‚</p>
<p><a id="production-ready-endpoints-cors"></a></p>
<h3 id="53-6ã€è·¨åŸŸæ”¯æŒ"><a href="#53-6ã€è·¨åŸŸæ”¯æŒ" class="headerlink" title="53.6ã€è·¨åŸŸæ”¯æŒ"></a>53.6ã€è·¨åŸŸæ”¯æŒ</h3><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing">è·¨æºèµ„æºå…±äº«</a>ï¼ˆCORSï¼‰æ˜¯ä¸€ä¸ª <a target="_blank" rel="noopener" href="https://www.w3.org/TR/cors/">W3C è§„èŒƒ</a>ï¼Œå…è®¸ä½ ä»¥çµæ´»çš„æ–¹å¼æŒ‡å®šæˆæƒçš„è·¨åŸŸè¯·æ±‚ç±»å‹ã€‚å¦‚æœä½ ä½¿ç”¨ Spring MVC æˆ– Spring WebFluxï¼Œåˆ™å¯ä»¥é…ç½® Actuator çš„ Web ç«¯ç‚¹ä»¥æ”¯æŒæ­¤ç±»æ–¹æ¡ˆã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ CORS æ”¯æŒè¢«ç¦ç”¨ï¼Œä»…åœ¨è®¾ç½®äº† <code>management.endpoints.web.cors.allowed-origins</code> å±æ€§åæ‰å¯ç”¨ CORS æ”¯æŒã€‚ä»¥ä¸‹é…ç½®å…è®¸æ¥è‡ª <code>example.com</code> åŸŸçš„ GET å’Œ POST è°ƒç”¨ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.endpoints.web.cors.allowed-origins</span>=http://example.com</span><br><span class="line"><span class="attr">management.endpoints.web.cors.allowed-methods</span>=GET,POST</span><br></pre></td></tr></table></figure>
<p><strong>æç¤º</strong></p>
<blockquote>
<p>æœ‰å…³é€‰é¡¹çš„å®Œæ•´åˆ—è¡¨ï¼Œè¯·å‚é˜… <a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator-autoconfigure/src/main/java/org/springframework/boot/actuate/autoconfigure/endpoint/web/CorsEndpointProperties.java">CorsEndpointProperties</a>ã€‚</p>
</blockquote>
<p><a id="production-ready-endpoints-custom"></a></p>
<h3 id="53-7ã€å®ç°è‡ªå®šä¹‰ç«¯ç‚¹"><a href="#53-7ã€å®ç°è‡ªå®šä¹‰ç«¯ç‚¹" class="headerlink" title="53.7ã€å®ç°è‡ªå®šä¹‰ç«¯ç‚¹"></a>53.7ã€å®ç°è‡ªå®šä¹‰ç«¯ç‚¹</h3><p>å¦‚æœä½ æ·»åŠ ä¸€ä¸ªä½¿ç”¨äº† <code>@Endpoint</code> æ³¨è§£çš„ <code>@Bean</code>ï¼Œåˆ™ä½¿ç”¨ <code>@ReadOperation</code>ã€<code>@WritOperation</code> æˆ– <code>@DeleteOperation</code> æ³¨è§£çš„æ‰€æœ‰æ–¹æ³•éƒ½å°†é€šè¿‡ JMX è‡ªåŠ¨æš´éœ²ï¼Œå¹¶ä¸”åœ¨ Web åº”ç”¨ç¨‹åºä¸­ä¹Ÿå°†é€šè¿‡ HTTP æš´éœ²ã€‚å¯ä»¥ä½¿ç”¨ Jerseyã€Spring MVC æˆ– Spring WebFlux é€šè¿‡ HTTP æš´éœ²ç«¯ç‚¹ã€‚</p>
<p>ä½ è¿˜å¯ä»¥ä½¿ç”¨ <code>@JmxEndpoint</code> æˆ– <code>@WebEndpoint</code> ç¼–å†™ç‰¹å®šæŠ€æœ¯çš„ç«¯ç‚¹ã€‚è¿™äº›ç«¯ç‚¹ä»…é™äºå„è‡ªçš„æŠ€æœ¯ã€‚ä¾‹å¦‚ï¼Œ<code>@WebEndpoint</code> ä»…é€šè¿‡ HTTP æš´éœ²ï¼Œè€Œä¸æ˜¯ JMXã€‚</p>
<p>ä½ å¯ä»¥ä½¿ç”¨ <code>@EndpointWebExtension</code> å’Œ <code>@EndpointJmxExtension</code> ç¼–å†™ç‰¹å®šæŠ€æœ¯çš„æ‰©å±•ã€‚é€šè¿‡è¿™äº›æ³¨è§£ï¼Œä½ å¯ä»¥æä¾›ç‰¹å®šæŠ€æœ¯çš„æ“ä½œæ¥æ‰©å……ç°æœ‰ç«¯ç‚¹ã€‚</p>
<p>æœ€åï¼Œå¦‚æœä½ éœ€è¦è®¿é—®ç‰¹å®š Web æ¡†æ¶çš„åŠŸèƒ½ï¼Œåˆ™å¯ä»¥å®ç° Servlet æˆ– Spring <code>@Controller</code> å’Œ <code>@RestController</code> ç«¯ç‚¹ï¼Œä½†ä»£ä»·æ˜¯å®ƒä»¬æ— æ³•é€šè¿‡ JMX æˆ–ä½¿ç”¨å…¶ä»– Web æ¡†æ¶ã€‚</p>
<p><a id="production-ready-endpoints-custom-input"></a></p>
<h4 id="53-7-1ã€æ¥æ”¶è¾“å…¥"><a href="#53-7-1ã€æ¥æ”¶è¾“å…¥" class="headerlink" title="53.7.1ã€æ¥æ”¶è¾“å…¥"></a>53.7.1ã€æ¥æ”¶è¾“å…¥</h4><p>ç«¯ç‚¹ä¸Šçš„æ“ä½œé€šè¿‡å‚æ•°æ¥æ”¶è¾“å…¥ã€‚é€šè¿‡ Web æš´éœ²æ—¶ï¼Œè¿™äº›å‚æ•°çš„å€¼å–è‡ª URL çš„æŸ¥è¯¢å‚æ•°å’Œ JSON è¯·æ±‚ä½“ã€‚é€šè¿‡ JMX æš´éœ²æ—¶ï¼Œå‚æ•°å°†æ˜ å°„åˆ° MBean æ“ä½œçš„å‚æ•°ã€‚é»˜è®¤æƒ…å†µä¸‹å‚æ•°æ˜¯å¿…é¡»çš„ã€‚å¯ä»¥ä½¿ç”¨ <code>@org.springframework.lang.Nullable</code> å¯¹å®ƒä»¬è¿›è¡Œæ³¨è§£ï¼Œä½¿å®ƒä»¬æˆä¸ºå¯é€‰é¡¹ã€‚</p>
<p>JSON è¯·æ±‚ä½“ä¸­çš„æ¯ä¸ªæ ¹å±æ€§éƒ½å¯ä»¥æ˜ å°„åˆ°ç«¯ç‚¹çš„å‚æ•°ã€‚è€ƒè™‘ä»¥ä¸‹ JSON è¯·æ±‚ä½“ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">	<span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;test&quot;</span><span class="punctuation">,</span></span><br><span class="line">	<span class="attr">&quot;counter&quot;</span><span class="punctuation">:</span> <span class="number">42</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>è¿™å¯ç”¨äºè°ƒç”¨å¸¦æœ‰ <code>String name</code> å’Œ <code>int counter</code> å‚æ•°çš„å†™æ“ä½œã€‚</p>
<p><strong>æç¤º</strong></p>
<blockquote>
<p>ç”±äºç«¯ç‚¹ä¸æŠ€æœ¯æ— å…³ï¼Œå› æ­¤åªèƒ½åœ¨æ–¹æ³•ç­¾åä¸­æŒ‡å®šç®€å•ç±»å‹ã€‚ç‰¹åˆ«æ˜¯ä¸æ”¯æŒä½¿ç”¨å®šä¹‰ä¸€ä¸ª <code>name</code> å’Œ <code>counter</code> å±æ€§çš„è‡ªå®šä¹‰ç±»å‹å£°æ˜å•ä¸ªå‚æ•°ã€‚</p>
</blockquote>
<p><strong>æ³¨æ„</strong></p>
<blockquote>
<p>è¦å…è®¸å°†è¾“å…¥æ˜ å°„åˆ°æ“ä½œæ–¹æ³•çš„å‚æ•°ï¼Œåº”ä½¿ç”¨ <code>-parameters</code> ç¼–è¯‘å®ç°ç«¯ç‚¹çš„ Java ä»£ç ï¼Œå¹¶ä¸”åº”ä½¿ç”¨ <code>-java-parameters</code> ç¼–è¯‘å®ç°ç«¯ç‚¹çš„ Kotlin ä»£ç ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Spring Boot çš„ Gradle æ’ä»¶ï¼Œæˆ–è€…æ˜¯ Maven å’Œ spring-boot-starter-parentï¼Œåˆ™å®ƒä»¬ä¼šè‡ªåŠ¨æ‰§è¡Œæ­¤æ“ä½œã€‚</p>
</blockquote>
<p><a id="production-ready-endpoints-custom-input-conversion"></a></p>
<h5 id="è¾“å…¥ç±»å‹è½¬æ¢"><a href="#è¾“å…¥ç±»å‹è½¬æ¢" class="headerlink" title="è¾“å…¥ç±»å‹è½¬æ¢"></a>è¾“å…¥ç±»å‹è½¬æ¢</h5><p>å¦‚æœ‰å¿…è¦ï¼Œä¼ é€’ç»™ç«¯ç‚¹æ“ä½œæ–¹æ³•çš„å‚æ•°å°†è‡ªåŠ¨è½¬æ¢ä¸ºæ‰€éœ€ç±»å‹ã€‚åœ¨è°ƒç”¨æ“ä½œæ–¹æ³•ä¹‹å‰ï¼Œä½¿ç”¨ <code>ApplicationConversionService</code> å®ä¾‹å°†é€šè¿‡ JMX æˆ– HTTP è¯·æ±‚æ¥æ”¶çš„è¾“å…¥è½¬æ¢ä¸ºæ‰€éœ€ç±»å‹ã€‚</p>
<p><a id="production-ready-endpoints-custom-web"></a></p>
<h4 id="53-7-2ã€è‡ªå®šä¹‰-Web-ç«¯ç‚¹"><a href="#53-7-2ã€è‡ªå®šä¹‰-Web-ç«¯ç‚¹" class="headerlink" title="53.7.2ã€è‡ªå®šä¹‰ Web ç«¯ç‚¹"></a>53.7.2ã€è‡ªå®šä¹‰ Web ç«¯ç‚¹</h4><p><code>@Endpoint</code>ã€<code>@WebEndpoint</code> æˆ– <code>@EndpointWebExtension</code> ä¸Šçš„æ“ä½œå°†ä½¿ç”¨ Jerseyã€Spring MVC æˆ– Spring WebFlux é€šè¿‡ HTTP è‡ªåŠ¨æš´éœ²ã€‚</p>
<p><a id="production-ready-endpoints-custom-web-predicate"></a></p>
<h5 id="Web-ç«¯ç‚¹è¯·æ±‚è°“è¯"><a href="#Web-ç«¯ç‚¹è¯·æ±‚è°“è¯" class="headerlink" title="Web ç«¯ç‚¹è¯·æ±‚è°“è¯"></a>Web ç«¯ç‚¹è¯·æ±‚è°“è¯</h5><p>ä¸º Web æš´éœ²çš„ç«¯ç‚¹ä¸Šçš„æ¯ä¸ªæ“ä½œè‡ªåŠ¨ç”Ÿæˆè¯·æ±‚è°“è¯ã€‚</p>
<p><a id="production-ready-endpoints-custom-web-predicate-path"></a></p>
<h5 id="è·¯å¾„"><a href="#è·¯å¾„" class="headerlink" title="è·¯å¾„"></a>è·¯å¾„</h5><p>è°“è¯çš„è·¯å¾„ç”±ç«¯ç‚¹çš„ ID å’Œ Web æš´éœ²çš„ç«¯ç‚¹çš„åŸºç¡€è·¯å¾„ç¡®å®šã€‚é»˜è®¤åŸºç¡€è·¯å¾„æ˜¯ <code>/actuator</code>ã€‚ä¾‹å¦‚ï¼Œæœ‰ ID ä¸º <code>sessions</code> çš„ç«¯ç‚¹å°†ä½¿ç”¨ <code>/actuator/sessions</code> ä½œä¸ºå…¶åœ¨è°“è¯ä¸­çš„è·¯å¾„ã€‚</p>
<p>é€šè¿‡ä½¿ç”¨ <code>@Selector</code> æ³¨è§£æ“ä½œæ–¹æ³•çš„ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°ï¼Œå¯ä»¥è¿›ä¸€æ­¥è‡ªå®šä¹‰è·¯å¾„ã€‚è¿™æ ·çš„å‚æ•°ä½œä¸ºè·¯å¾„å˜é‡æ·»åŠ åˆ°è·¯å¾„è°“è¯ä¸­ã€‚è°ƒç”¨ç«¯ç‚¹æ“ä½œæ—¶ï¼Œå˜é‡çš„å€¼å°†ä¼ é€’ç»™æ“ä½œæ–¹æ³•ã€‚</p>
<p><a id="production-ready-endpoints-custom-web-predicate-http-method"></a></p>
<h5 id="HTTP-æ–¹æ³•"><a href="#HTTP-æ–¹æ³•" class="headerlink" title="HTTP æ–¹æ³•"></a>HTTP æ–¹æ³•</h5><p>è°“è¯çš„ HTTP æ–¹æ³•ç”±æ“ä½œç±»å‹å†³å®šï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>HTTP æ–¹æ³•</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>@ReadOperation</code></td>
<td><code>GET</code></td>
</tr>
<tr>
<td><code>@WriteOperation</code></td>
<td><code>POST</code></td>
</tr>
<tr>
<td><code>@DeleteOperation</code></td>
<td><code>DELETE</code></td>
</tr>
</tbody>
</table>
</div>
<p><a id="production-ready-endpoints-custom-web-predicate-consumes"></a></p>
<h5 id="Consume"><a href="#Consume" class="headerlink" title="Consume"></a>Consume</h5><p>å¯¹äºä½¿ç”¨è¯·æ±‚ä½“çš„ <code>@WriteOperation</code>ï¼ˆHTTP <code>POST</code>ï¼‰ï¼Œè°“è¯çš„ consume å­å¥æ˜¯ <code>application/vnd.spring-boot.actuator.v2+json, application/json</code>ã€‚å¯¹äºæ‰€æœ‰å…¶ä»–æ“ä½œï¼Œconsume å­å¥ä¸ºç©ºã€‚</p>
<p><a id="production-ready-endpoints-custom-web-predicate-produces"></a></p>
<h5 id="Produce"><a href="#Produce" class="headerlink" title="Produce"></a>Produce</h5><p>è°“è¯çš„ produce å­å¥å¯ä»¥ç”± <code>@DeleteOperation</code>ã€<code>@ReadOperation</code> å’Œ <code>@WriteOperation</code> æ³¨è§£çš„ <code>produce</code> å±æ€§ç¡®å®šã€‚è¯¥å±æ€§æ˜¯å¯é€‰çš„ã€‚å¦‚æœæœªä½¿ç”¨ï¼Œåˆ™è‡ªåŠ¨ç¡®å®š produce å­å¥ã€‚</p>
<p>å¦‚æœæ“ä½œæ–¹æ³•è¿”å› <code>void</code> æˆ– <code>Void</code>ï¼Œåˆ™ produce å­å¥ä¸ºç©ºã€‚å¦‚æœæ“ä½œæ–¹æ³•è¿”å› <code>org.springframework.core.io.Resource</code>ï¼Œåˆ™ produce å­å¥ä¸º <code>application/octet-stream</code>ã€‚å¯¹äºæ‰€æœ‰å…¶ä»–æ“ä½œï¼Œproduce å­å¥æ˜¯ <code>application/vnd.spring-boot.actuator.v2+json, application/json</code>ã€‚</p>
<p><a id="production-ready-endpoints-custom-web-response-status"></a></p>
<h5 id="Web-ç«¯ç‚¹å“åº”çŠ¶æ€"><a href="#Web-ç«¯ç‚¹å“åº”çŠ¶æ€" class="headerlink" title="Web ç«¯ç‚¹å“åº”çŠ¶æ€"></a>Web ç«¯ç‚¹å“åº”çŠ¶æ€</h5><p>ç«¯ç‚¹æ“ä½œçš„é»˜è®¤å“åº”çŠ¶æ€å–å†³äºæ“ä½œç±»å‹ï¼ˆè¯»å–ã€å†™å…¥æˆ–åˆ é™¤ï¼‰ä»¥åŠæ“ä½œè¿”å›çš„å†…å®¹ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚</p>
<p><code>@ReadOperation</code> è¿”å›ä¸€ä¸ªå€¼ï¼Œå“åº”çŠ¶æ€ä¸º 200ï¼ˆOKï¼‰ã€‚å¦‚æœå®ƒæœªè¿”å›å€¼ï¼Œåˆ™å“åº”çŠ¶æ€å°†ä¸º 404ï¼ˆæœªæ‰¾åˆ°ï¼‰ã€‚</p>
<p>å¦‚æœ <code>@WriteOperation</code> æˆ– <code>@DeleteOperation</code> è¿”å›å€¼ï¼Œåˆ™å“åº”çŠ¶æ€å°†ä¸º 200ï¼ˆOKï¼‰ã€‚å¦‚æœå®ƒæ²¡æœ‰è¿”å›å€¼ï¼Œåˆ™å“åº”çŠ¶æ€å°†ä¸º 204ï¼ˆæ— å†…å®¹ï¼‰ã€‚</p>
<p>å¦‚æœåœ¨æ²¡æœ‰å¿…éœ€å‚æ•°çš„æƒ…å†µä¸‹è°ƒç”¨æ“ä½œï¼Œæˆ–è€…ä½¿ç”¨æ— æ³•è½¬æ¢ä¸ºæ‰€éœ€ç±»å‹çš„å‚æ•°ï¼Œåˆ™ä¸ä¼šè°ƒç”¨æ“ä½œæ–¹æ³•ï¼Œå¹¶ä¸”å“åº”çŠ¶æ€å°†ä¸º 400ï¼ˆé”™è¯¯è¯·æ±‚ï¼‰ã€‚</p>
<p><a id="production-ready-endpoints-custom-web-range-requests"></a></p>
<h5 id="Web-ç«¯ç‚¹èŒƒå›´è¯·æ±‚"><a href="#Web-ç«¯ç‚¹èŒƒå›´è¯·æ±‚" class="headerlink" title="Web ç«¯ç‚¹èŒƒå›´è¯·æ±‚"></a>Web ç«¯ç‚¹èŒƒå›´è¯·æ±‚</h5><p>å¯ç”¨ HTTP èŒƒå›´è¯·æ±‚è¯·æ±‚éƒ¨åˆ† HTTP èµ„æºã€‚ä½¿ç”¨ Spring MVC æˆ– Spring Web Flux æ—¶ï¼Œè¿”å› <code>org.springframework.core.io.Resource</code> çš„æ“ä½œä¼šè‡ªåŠ¨æ”¯æŒèŒƒå›´è¯·æ±‚ã€‚</p>
<p><strong>æ³¨æ„</strong></p>
<blockquote>
<p>ä½¿ç”¨ Jersey æ—¶ä¸æ”¯æŒèŒƒå›´è¯·æ±‚ã€‚</p>
</blockquote>
<p><a id="production-ready-endpoints-custom-web-security"></a></p>
<h5 id="Web-ç«¯ç‚¹å®‰å…¨"><a href="#Web-ç«¯ç‚¹å®‰å…¨" class="headerlink" title="Web ç«¯ç‚¹å®‰å…¨"></a>Web ç«¯ç‚¹å®‰å…¨</h5><p>Web ç«¯ç‚¹æˆ–ç‰¹å®š Web çš„ç«¯ç‚¹æ‰©å±•ä¸Šçš„æ“ä½œå¯ä»¥æ¥æ”¶å½“å‰çš„ <code>java.security.Principal</code> æˆ– <code>org.springframework.boot.actuate.endpoint.SecurityContext</code> ä½œä¸ºæ–¹æ³•å‚æ•°ã€‚å‰è€…é€šå¸¸ä¸ <code>@Nullable</code> ç»“åˆä½¿ç”¨ï¼Œä¸ºç»è¿‡èº«ä»½éªŒè¯å’Œæœªç»èº«ä»½éªŒè¯çš„ç”¨æˆ·æä¾›ä¸åŒçš„è¡Œä¸ºã€‚åè€…é€šå¸¸ç”¨äºä½¿ç”¨å…¶ <code>isUserInRole(String)</code> æ–¹æ³•æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚</p>
<p><a id="production-ready-endpoints-custom-servlet"></a></p>
<h4 id="53-7-3ã€Servlet-ç«¯ç‚¹"><a href="#53-7-3ã€Servlet-ç«¯ç‚¹" class="headerlink" title="53.7.3ã€Servlet ç«¯ç‚¹"></a>53.7.3ã€Servlet ç«¯ç‚¹</h4><p>é€šè¿‡å®ç°ä¸€ä¸ªå¸¦æœ‰ <code>@ServletEndpoint</code> æ³¨è§£çš„ç±»ï¼Œ<code>Servlet</code> å¯ä»¥ä½œä¸ºç«¯ç‚¹æš´éœ²ï¼Œè¯¥ç±»ä¹Ÿå®ç°äº† <code>Supplier&lt;EndpointServlet&gt;</code>ã€‚Servlet ç«¯ç‚¹æä¾›äº†ä¸ Servlet å®¹å™¨æ›´æ·±å±‚æ¬¡çš„é›†æˆï¼Œä½†ä»£ä»·æ˜¯å¯ç§»æ¤æ€§ã€‚å®ƒä»¬æ—¨åœ¨ç”¨äºå°†ç°æœ‰ Servlet ä½œä¸ºç«¯ç‚¹æš´éœ²ã€‚å¯¹äºæ–°ç«¯ç‚¹ï¼Œåº”å°½å¯èƒ½é¦–é€‰ <code>@Endpoint</code> å’Œ <code>@WebEndpoint</code> æ³¨è§£ã€‚</p>
<p><a id="production-ready-endpoints-custom-controller"></a></p>
<h4 id="53-7-4ã€æ§åˆ¶å™¨ç«¯ç‚¹"><a href="#53-7-4ã€æ§åˆ¶å™¨ç«¯ç‚¹" class="headerlink" title="53.7.4ã€æ§åˆ¶å™¨ç«¯ç‚¹"></a>53.7.4ã€æ§åˆ¶å™¨ç«¯ç‚¹</h4><p><code>@ControllerEndpoint</code> å’Œ <code>@RestControllerEndpoint</code> å¯ç”¨äºå®ç°ä»…ç”± Spring MVC æˆ– Spring WebFlux æš´éœ²çš„ç«¯ç‚¹ã€‚ä½¿ç”¨ Spring MVC å’Œ Spring WebFlux çš„æ ‡å‡†æ³¨è§£ï¼ˆå¦‚ <code>@RequestMapping</code> å’Œ <code>@GetMapping</code>ï¼‰æ˜ å°„æ–¹æ³•ï¼Œå¹¶å°†ç«¯ç‚¹çš„ ID ç”¨ä½œè·¯å¾„çš„å‰ç¼€ã€‚æ§åˆ¶å™¨ç«¯ç‚¹æä¾›äº†ä¸ Spring çš„ Web æ¡†æ¶æ›´æ·±å±‚æ¬¡çš„é›†æˆï¼Œä½†ä»£ä»·æ˜¯å¯ç§»æ¤æ€§ã€‚åº”å°½å¯èƒ½é¦–é€‰ <code>@Endpoint</code> å’Œ <code>@WebEndpoint</code> æ³¨è§£ã€‚</p>
<p><a id="production-ready-health"></a></p>
<h3 id="53-8ã€å¥åº·ä¿¡æ¯"><a href="#53-8ã€å¥åº·ä¿¡æ¯" class="headerlink" title="53.8ã€å¥åº·ä¿¡æ¯"></a>53.8ã€å¥åº·ä¿¡æ¯</h3><p>ä½ å¯ä»¥ä½¿ç”¨å¥åº·ä¿¡æ¯æ¥æ£€æŸ¥æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºçš„çŠ¶æ€ã€‚ç›‘æ§è½¯ä»¶ç»å¸¸åœ¨ç”Ÿäº§ç³»ç»Ÿå‡ºç°æ•…éšœæ—¶ä½¿ç”¨å®ƒæé†’æŸäººã€‚<code>health</code> ç«¯ç‚¹æš´éœ²çš„ä¿¡æ¯å–å†³äº <code>management.endpoint.health.show-details</code> å±æ€§ï¼Œè¯¥å±æ€§å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å€¼ä¹‹ä¸€è¿›è¡Œé…ç½®ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>åç§°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>never</code></td>
<td>æ°¸è¿œä¸ä¼šæ˜¾ç¤ºç»†èŠ‚ã€‚</td>
</tr>
<tr>
<td><code>when-authorized</code></td>
<td>è¯¦ç»†ä¿¡æ¯ä»…å‘æˆæƒç”¨æˆ·æ˜¾ç¤ºã€‚å¯ä»¥ä½¿ç”¨ <code>management.endpoint.health.roles</code> é…ç½®æˆæƒè§’è‰²ã€‚</td>
</tr>
<tr>
<td><code>always</code></td>
<td>å‘æ‰€æœ‰ç”¨æˆ·æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ã€‚</td>
</tr>
</tbody>
</table>
</div>
<p>é»˜è®¤å€¼ä¸º <code>never</code>ã€‚å½“ç”¨æˆ·å¤„äºä¸€ä¸ªæˆ–å¤šä¸ªç«¯ç‚¹çš„è§’è‰²æ—¶ï¼Œå°†è¢«è§†ä¸ºå·²è·å¾—æˆæƒã€‚å¦‚æœç«¯ç‚¹æ²¡æœ‰é…ç½®è§’è‰²ï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œåˆ™è®¤ä¸ºæ‰€æœ‰ç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·éƒ½å·²è·å¾—æˆæƒã€‚å¯ä»¥ä½¿ç”¨ <code>management.endpoint.health.roles</code> å±æ€§é…ç½®è§’è‰²ã€‚</p>
<p><strong>æ³¨æ„</strong></p>
<blockquote>
<p>å¦‚æœä½ å·²ä¿æŠ¤åº”ç”¨ç¨‹åºå¹¶å¸Œæœ›ä½¿ç”¨ <code>always</code>ï¼Œåˆ™å®‰å…¨é…ç½®å¿…é¡»å…è®¸ç»è¿‡èº«ä»½éªŒè¯å’Œæœªç»èº«ä»½éªŒè¯çš„ç”¨æˆ·å¯¹å¥åº·ç«¯ç‚¹çš„è®¿é—®ã€‚</p>
</blockquote>
<p>å¥åº·ä¿¡æ¯æ˜¯ä» <a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/HealthIndicatorRegistry.java"><code>HealthIndicatorRegistry</code></a> çš„å†…å®¹ä¸­æ”¶é›†çš„ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>ApplicationContext</code> ä¸­å®šä¹‰çš„æ‰€æœ‰ <a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/HealthIndicator.java"><code>HealthIndicator</code></a> å®ä¾‹ï¼‰ã€‚Spring Boot åŒ…å«è®¸å¤šè‡ªåŠ¨é…ç½®çš„ <code>HealthIndicators</code>ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå·±ç¼–å†™ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæœ€ç»ˆç³»ç»ŸçŠ¶æ€ç”± <code>HealthAggregator</code> æ ¹æ®çŠ¶æ€çš„æœ‰åºåˆ—è¡¨å¯¹æ¯ä¸ª <code>HealthIndicator</code> çš„çŠ¶æ€è¿›è¡Œæ’åºã€‚æ’åºåˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªçŠ¶æ€ä½œä¸ºæ•´ä½“å¥åº·çŠ¶æ€ã€‚å¦‚æœæ²¡æœ‰ <code>HealthIndicator</code> è¿”å›ä¸€ä¸ª <code>HealthAggregator</code> å·²çŸ¥çš„çŠ¶æ€ï¼Œåˆ™ä½¿ç”¨ <code>UNKNOWN</code> çŠ¶æ€ã€‚</p>
<p><strong>æç¤º</strong></p>
<blockquote>
<p><code>HealthIndicatorRegistry</code> å¯ç”¨äºåœ¨è¿è¡Œæ—¶æ³¨å†Œå’Œæ³¨é”€å¥åº·æŒ‡ç¤ºå™¨ã€‚</p>
</blockquote>
<p><a id="_auto_configured_healthindicators"></a></p>
<h4 id="53-8-1ã€è‡ªåŠ¨é…ç½®çš„-HealthIndicator"><a href="#53-8-1ã€è‡ªåŠ¨é…ç½®çš„-HealthIndicator" class="headerlink" title="53.8.1ã€è‡ªåŠ¨é…ç½®çš„ HealthIndicator"></a>53.8.1ã€è‡ªåŠ¨é…ç½®çš„ HealthIndicator</h4><p>é€‚å½“æ—¶ï¼ŒSpring Boot ä¼šè‡ªåŠ¨é…ç½®ä»¥ä¸‹ <code>HealthIndicator</code>ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>åç§°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/cassandra/CassandraHealthIndicator.java"><code>CassandraHealthIndicator</code></a></td>
<td>æ£€æŸ¥ Cassandra æ•°æ®åº“æ˜¯å¦å·²å¯åŠ¨ã€‚</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/couchbase/CouchbaseHealthIndicator.java"><code>CouchbaseHealthIndicator</code></a></td>
<td>æ£€æŸ¥ Couchbase é›†ç¾¤æ˜¯å¦å·²å¯åŠ¨ã€‚</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/system/DiskSpaceHealthIndicator.java"><code>DiskSpaceHealthIndicator</code></a></td>
<td>æ£€æŸ¥æ˜¯å¦ç£ç›˜ç©ºé—´ä¸è¶³ã€‚</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/jdbc/DataSourceHealthIndicator.java"><code>DataSourceHealthIndicator</code></a></td>
<td>æ£€æŸ¥æ˜¯å¦å¯ä»¥è·å¾—ä¸ <code>DataSource</code> çš„è¿æ¥ã€‚</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/elasticsearch/ElasticsearchHealthIndicator.java"><code>ElasticsearchHealthIndicator</code></a></td>
<td>æ£€æŸ¥ Elasticsearch é›†ç¾¤æ˜¯å¦å·²å¯åŠ¨ã€‚</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/influx/InfluxDbHealthIndicator.java"><code>InfluxDbHealthIndicator</code></a></td>
<td>æ£€æŸ¥ InfluxDB æœåŠ¡å™¨æ˜¯å¦å·²å¯åŠ¨ã€‚</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/jms/JmsHealthIndicator.java"><code>JmsHealthIndicator</code></a></td>
<td>æ£€æŸ¥ JMS broker æ˜¯å¦å·²å¯åŠ¨ã€‚</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/mail/MailHealthIndicator.java"><code>MailHealthIndicator</code></a></td>
<td>æ£€æŸ¥é‚®ä»¶æœåŠ¡å™¨æ˜¯å¦å·²å¯åŠ¨ã€‚</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/mongo/MongoHealthIndicator.java"><code>MongoHealthIndicator</code></a></td>
<td>æ£€æŸ¥ Mongo æ•°æ®åº“æ˜¯å¦å·²å¯åŠ¨ã€‚</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/neo4j/Neo4jHealthIndicator.java"><code>Neo4jHealthIndicator</code></a></td>
<td>æ£€æŸ¥ Neo4j æœåŠ¡å™¨æ˜¯å¦å·²å¯åŠ¨ã€‚</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/amqp/RabbitHealthIndicator.java"><code>RabbitHealthIndicator</code></a></td>
<td>æ£€æŸ¥ Rabbit æœåŠ¡å™¨æ˜¯å¦å·²å¯åŠ¨ã€‚</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/redis/RedisHealthIndicator.java"><code>RedisHealthIndicator</code></a></td>
<td>æ£€æŸ¥ Redis æœåŠ¡å™¨æ˜¯å¦å·²å¯åŠ¨ã€‚</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/solr/SolrHealthIndicator.java"><code>SolrHealthIndicator</code></a></td>
<td>æ£€æŸ¥ Solr æœåŠ¡å™¨æ˜¯å¦å·²å¯åŠ¨ã€‚</td>
</tr>
</tbody>
</table>
</div>
<p><strong>æç¤º</strong></p>
<blockquote>
<p>ä½ å¯ä»¥é€šè¿‡è®¾ç½® <code>management.health.defaults.enabled</code> å±æ€§æ¥ç¦ç”¨å®ƒä»¬ã€‚</p>
</blockquote>
<p><a id="_writing_custom_healthindicators"></a></p>
<h4 id="53-8-2ã€ç¼–å†™è‡ªå®šä¹‰-HealthIndicator"><a href="#53-8-2ã€ç¼–å†™è‡ªå®šä¹‰-HealthIndicator" class="headerlink" title="53.8.2ã€ç¼–å†™è‡ªå®šä¹‰ HealthIndicator"></a>53.8.2ã€ç¼–å†™è‡ªå®šä¹‰ HealthIndicator</h4><p>è¦æä¾›è‡ªå®šä¹‰å¥åº·ä¿¡æ¯ï¼Œå¯ä»¥æ³¨å†Œå®ç° <a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/HealthIndicator.java"><code>HealthIndicator</code></a> æ¥å£çš„ Spring beanã€‚ä½ éœ€è¦æä¾› <code>health()</code> æ–¹æ³•çš„å®ç°å¹¶è¿”å›ä¸€ä¸ª <code>Health</code> å“åº”ã€‚<code>Health</code> å“åº”åº”åŒ…æ‹¬ä¸€ä¸ªçŠ¶æ€ï¼Œå¹¶ä¸”å¯ä»¥é€‰æ‹©åŒ…æ‹¬è¦æ˜¾ç¤ºçš„å…¶ä»–è¯¦ç»†ä¿¡æ¯ã€‚ä»¥ä¸‹ä»£ç å±•ç¤ºäº†ä¸€ä¸ª HealthIndicator å®ç°ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.actuate.health.Health;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.actuate.health.HealthIndicator;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyHealthIndicator</span> <span class="keyword">implements</span> <span class="title class_">HealthIndicator</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> Health <span class="title function_">health</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">errorCode</span> <span class="operator">=</span> check(); <span class="comment">// æ‰§è¡ŒæŸäº›ç‰¹å®šçš„å¥åº·æ£€æŸ¥</span></span><br><span class="line">		<span class="keyword">if</span> (errorCode != <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> Health.down().withDetail(<span class="string">&quot;Error Code&quot;</span>, errorCode).build();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> Health.up().build();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æ³¨æ„</strong></p>
<blockquote>
<p>ç»™å®š <code>HealthIndicator</code> çš„æ ‡è¯†ç¬¦æ˜¯æ²¡æœ‰ <code>HealthIndicator</code> åç¼€çš„ bean çš„åç§°ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚åœ¨å‰é¢çš„ç¤ºä¾‹ä¸­ï¼Œå¥åº·ä¿¡æ¯åœ¨åä¸º <code>my</code> çš„æ¡ç›®ä¸­å¯ç”¨ã€‚</p>
</blockquote>
<p>é™¤äº† Spring Boot çš„é¢„å®šä¹‰ <a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/Status.java"><code>Status</code></a> ç±»å‹ä¹‹å¤–ï¼Œ<code>Health</code> è¿˜å¯ä»¥è¿”å›ä¸€ä¸ªè¡¨ç¤ºæ–°ç³»ç»ŸçŠ¶æ€çš„è‡ªå®šä¹‰ <code>Status</code>ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿˜éœ€è¦æä¾› <a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/HealthAggregator.java"><code>HealthAggregator</code></a> æ¥å£çš„è‡ªå®šä¹‰å®ç°ï¼Œæˆ–è€…å¿…é¡»ä½¿ç”¨ <code>management.health.status.order</code> é…ç½®å±æ€§é…ç½®é»˜è®¤å®ç°ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‡è®¾åœ¨ä½ çš„ä¸€ä¸ª <code>HealthIndicator</code> å®ç°ä¸­ä½¿ç”¨äº†ä»£ç ä¸º <code>FATAL</code> çš„æ–° <code>Status</code>ã€‚éœ€è¦é…ç½®ä¸¥é‡æ€§é¡ºåºï¼Œè¯·å°†ä»¥ä¸‹å±æ€§æ·»åŠ åˆ°åº”ç”¨ç¨‹åºå±æ€§ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.health.status.order</span>=FATAL, DOWN, OUT_OF_SERVICE, UNKNOWN, UP</span><br></pre></td></tr></table></figure>
<p>å“åº”ä¸­çš„ HTTP çŠ¶æ€ç åæ˜ äº†æ•´ä½“è¿è¡ŒçŠ¶å†µï¼ˆä¾‹å¦‚ï¼Œ<code>UP</code> æ˜ å°„åˆ° 200ï¼Œè€Œ <code>OUT_OF_SERVICE</code> å’Œ <code>DOWN</code> æ˜ å°„åˆ° 503ï¼‰ã€‚å¦‚æœé€šè¿‡ HTTP è®¿é—®å¥åº·ç«¯ç‚¹ï¼Œåˆ™å¯èƒ½è¿˜éœ€è¦æ³¨å†Œè‡ªå®šä¹‰çŠ¶æ€æ˜ å°„ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹å±æ€§å°† <code>FATAL</code> æ˜ å°„åˆ° 503ï¼ˆæœåŠ¡ä¸å¯ç”¨ï¼‰ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.health.status.http-mapping.FATAL</span>=<span class="number">503</span></span><br></pre></td></tr></table></figure>
<p><strong>æç¤º</strong></p>
<blockquote>
<p>å¦‚æœéœ€è¦æ§åˆ¶æ›´å¤šï¼Œå¯ä»¥å®šä¹‰è‡ªå·±çš„ <code>HealthStatusHttpMapper</code> beanã€‚</p>
</blockquote>
<p>ä¸‹è¡¨å±•ç¤ºäº†å†…ç½®çŠ¶æ€çš„é»˜è®¤çŠ¶æ€æ˜ å°„ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>çŠ¶æ€</th>
<th>æ˜ å°„</th>
</tr>
</thead>
<tbody>
<tr>
<td>DOWN</td>
<td>SERVICE_UNAVAILABLE (503)</td>
</tr>
<tr>
<td>OUT_OF_SERVICE</td>
<td>SERVICE_UNAVAILABLE (503)</td>
</tr>
<tr>
<td>UP</td>
<td>é»˜è®¤æ²¡æœ‰æ˜ å°„ï¼Œå› æ­¤çŠ¶æ€ç ä¸º 200</td>
</tr>
<tr>
<td>UNKNOWN</td>
<td>é»˜è®¤æ²¡æœ‰æ˜ å°„ï¼Œå› æ­¤çŠ¶æ€ç ä¸º 200</td>
</tr>
</tbody>
</table>
</div>
<p><a id="reactive-health-indicators"></a></p>
<h4 id="53-8-3ã€å“åº”å¼å¥åº·æŒ‡ç¤ºå™¨"><a href="#53-8-3ã€å“åº”å¼å¥åº·æŒ‡ç¤ºå™¨" class="headerlink" title="53.8.3ã€å“åº”å¼å¥åº·æŒ‡ç¤ºå™¨"></a>53.8.3ã€å“åº”å¼å¥åº·æŒ‡ç¤ºå™¨</h4><p>å¯¹äºå“åº”å¼åº”ç”¨ç¨‹åºï¼Œä¾‹å¦‚ä½¿ç”¨ Spring WebFlux çš„åº”ç”¨ç¨‹åºï¼Œ<code>ReactiveHealthIndicator</code> æä¾›äº†ä¸€ä¸ªéé˜»å¡çš„æ¥å£æ¥è·å–åº”ç”¨ç¨‹åºå¥åº·ä¿¡æ¯ã€‚ä¸ä¼ ç»Ÿçš„ <code>HealthIndicator</code> ç±»ä¼¼ï¼Œå¥åº·ä¿¡æ¯ä» <a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/ReactiveHealthIndicatorRegistry.java"><code>ReactiveHealthIndicatorRegistry</code></a> çš„å†…å®¹ä¸­æ”¶é›†ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>ApplicationContext</code> ä¸­å®šä¹‰çš„æ‰€æœ‰ <a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/HealthIndicator.java"><code>HealthIndicator</code></a> å’Œ <a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/ReactiveHealthIndicator.java"><code>ReactiveHealthIndicator</code></a> å®ä¾‹ï¼‰ã€‚ä¸æ£€æŸ¥å“åº”å¼ API çš„å¸¸è§„ <code>HealthIndicator</code>åœ¨å¼¹æ€§è°ƒåº¦ç¨‹åºä¸Šæ‰§è¡Œã€‚</p>
<p><strong>æç¤º</strong></p>
<blockquote>
<p>åœ¨å“åº”å¼åº”ç”¨ç¨‹åºä¸­ï¼Œ<code>ReactiveHealthIndicatorRegistry</code> å¯ç”¨äºåœ¨è¿è¡Œæ—¶æ³¨å†Œå’Œå–æ¶ˆæ³¨å†Œå¥åº·æŒ‡ç¤ºå™¨ã€‚</p>
</blockquote>
<p>è¦ä»å“åº”å¼ API æä¾›è‡ªå®šä¹‰å¥åº·ä¿¡æ¯ï¼Œå¯ä»¥æ³¨å†Œå®ç° <a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/ReactiveHealthIndicator.java"><code>ReactiveHealthIndicator</code></a> æ¥å£çš„ Spring beanã€‚ä»¥ä¸‹ä»£ç å±•ç¤ºäº† <code>ReactiveHealthIndicator</code> å®ç°çš„ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyReactiveHealthIndicator</span> <span class="keyword">implements</span> <span class="title class_">ReactiveHealthIndicator</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> Mono&lt;Health&gt; <span class="title function_">health</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> doHealthCheck() <span class="comment">// æ‰§è¡Œä¸€äº›ç‰¹å®šçš„å¥åº·æ£€æŸ¥å¹¶è¿”å›ä¸€ä¸ª Mono&lt;Health&gt;</span></span><br><span class="line">			.onErrorResume(ex -&gt; Mono.just(<span class="keyword">new</span> <span class="title class_">Health</span>.Builder().down(ex).build())));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æç¤º</strong></p>
<blockquote>
<p>è¦è‡ªåŠ¨å¤„ç†é”™è¯¯ï¼Œè¯·è€ƒè™‘ä» <code>AbstractReactiveHealthIndicator</code> è¿›è¡Œæ‰©å±•ã€‚</p>
</blockquote>
<p><a id="_auto_configured_reactivehealthindicators"></a></p>
<h4 id="53-8-4ã€è‡ªåŠ¨é…ç½®çš„-ReactiveHealthIndicator"><a href="#53-8-4ã€è‡ªåŠ¨é…ç½®çš„-ReactiveHealthIndicator" class="headerlink" title="53.8.4ã€è‡ªåŠ¨é…ç½®çš„ ReactiveHealthIndicator"></a>53.8.4ã€è‡ªåŠ¨é…ç½®çš„ ReactiveHealthIndicator</h4><p>é€‚å½“æ—¶ï¼ŒSpring Boot ä¼šè‡ªåŠ¨é…ç½®ä»¥ä¸‹ <code>ReactiveHealthIndicator</code>ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>åç§°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/cassandra/CassandraReactiveHealthIndicator.java"><code>CassandraReactiveHealthIndicator</code></a></td>
<td>æ£€æŸ¥ Cassandra æ•°æ®åº“æ˜¯å¦å·²å¯åŠ¨ã€‚</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/couchbase/CouchbaseReactiveHealthIndicator.java"><code>CouchbaseReactiveHealthIndicator</code></a></td>
<td>æ£€æŸ¥ Couchbase é›†ç¾¤æ˜¯å¦å·²å¯åŠ¨ã€‚</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/mongo/MongoReactiveHealthIndicator.java"><code>MongoReactiveHealthIndicator</code></a></td>
<td>æ£€æŸ¥ Mongo æ•°æ®åº“æ˜¯å¦å·²å¯åŠ¨ã€‚</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/redis/RedisReactiveHealthIndicator.java"><code>RedisReactiveHealthIndicator</code></a></td>
<td>æ£€æŸ¥ Redis æœåŠ¡å™¨æ˜¯å¦å·²å¯åŠ¨ã€‚</td>
</tr>
</tbody>
</table>
</div>
<p><strong>æç¤º</strong></p>
<blockquote>
<p>å¿…è¦æ—¶ï¼Œå“åº”å¼æŒ‡ç¤ºå™¨å–ä»£å¸¸è§„æŒ‡ç¤ºå™¨ã€‚æ­¤å¤–ï¼Œä»»ä½•æœªæ˜ç¡®å¤„ç†çš„ <code>HealthIndicator</code> éƒ½ä¼šè‡ªåŠ¨åŒ…è£…ã€‚</p>
</blockquote>
<p><a id="production-ready-application-info"></a></p>
<h3 id="53-9ã€åº”ç”¨ç¨‹åºä¿¡æ¯"><a href="#53-9ã€åº”ç”¨ç¨‹åºä¿¡æ¯" class="headerlink" title="53.9ã€åº”ç”¨ç¨‹åºä¿¡æ¯"></a>53.9ã€åº”ç”¨ç¨‹åºä¿¡æ¯</h3><p>åº”ç”¨ç¨‹åºä¿¡æ¯æš´éœ²ä» <code>ApplicationContext</code> ä¸­å®šä¹‰çš„æ‰€æœ‰ <a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/InfoContributor.java"><code>InfoContributor</code></a> bean æ”¶é›†çš„å„ç§ä¿¡æ¯ã€‚Spring Boot åŒ…å«è®¸å¤šè‡ªåŠ¨é…ç½®çš„ <code>InfoContributor</code> beanï¼Œä½ å¯ä»¥ç¼–å†™è‡ªå·±çš„ beanã€‚</p>
<p><a id="production-ready-application-info"></a></p>
<h4 id="53-9-1ã€è‡ªåŠ¨é…ç½®çš„-InfoContributor"><a href="#53-9-1ã€è‡ªåŠ¨é…ç½®çš„-InfoContributor" class="headerlink" title="53.9.1ã€è‡ªåŠ¨é…ç½®çš„ InfoContributor"></a>53.9.1ã€è‡ªåŠ¨é…ç½®çš„ InfoContributor</h4><p>é€‚å½“æ—¶ï¼ŒSpring Boot ä¼šè‡ªåŠ¨é…ç½®ä»¥ä¸‹ <code>InfoContributor</code> beanï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>åç§°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/EnvironmentInfoContributor.java"><code>EnvironmentInfoContributor</code></a></td>
<td>åœ¨ <code>info</code> key ä¸‹æ˜¾ç¤º <code>Environment</code> ä¸­çš„æ‰€æœ‰ keyã€‚</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/GitInfoContributor.java"><code>GitInfoContributor</code></a></td>
<td>å¦‚æœ <code>git.properties</code> å¯ç”¨åˆ™æš´éœ² git ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/BuildInfoContributor.java"><code>BuildInfoContributor</code></a></td>
<td>å¦‚æœ <code>META-INF/build-info.properties</code> å¯ç”¨åˆ™æš´éœ²æ„å»ºä¿¡æ¯ã€‚</td>
</tr>
</tbody>
</table>
</div>
<p><strong>æç¤º</strong></p>
<blockquote>
<p>å¯ä»¥é€šè¿‡è®¾ç½® <code>management.info.defaults.enabled</code> å±æ€§æ¥ç¦ç”¨å®ƒä»¬ã€‚</p>
</blockquote>
<p><a id="production-ready-application-info-env"></a></p>
<h4 id="53-9-2ã€è‡ªå®šä¹‰åº”ç”¨ç¨‹åºä¿¡æ¯"><a href="#53-9-2ã€è‡ªå®šä¹‰åº”ç”¨ç¨‹åºä¿¡æ¯" class="headerlink" title="53.9.2ã€è‡ªå®šä¹‰åº”ç”¨ç¨‹åºä¿¡æ¯"></a>53.9.2ã€è‡ªå®šä¹‰åº”ç”¨ç¨‹åºä¿¡æ¯</h4><p>ä½ å¯ä»¥é€šè¿‡è®¾ç½® <code>info.*</code> å­—ç¬¦ä¸²å±æ€§æ¥è‡ªå®šä¹‰ <code>info</code>ç«¯ç‚¹æš´éœ²çš„æ•°æ®ã€‚<code>info</code> key ä¸‹çš„æ‰€æœ‰ <code>Environment</code> å±æ€§éƒ½ä¼šè‡ªåŠ¨æš´éœ²ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å°†ä»¥ä¸‹è®¾ç½®æ·»åŠ åˆ° <code>application.properties</code> æ–‡ä»¶ä¸­ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">info.app.encoding</span>=UTF-<span class="number">8</span></span><br><span class="line"><span class="attr">info.app.java.source</span>=<span class="number">1.8</span></span><br><span class="line"><span class="attr">info.app.java.target</span>=<span class="number">1.8</span></span><br></pre></td></tr></table></figure>
<p><strong>æç¤º</strong></p>
<blockquote>

ä½ å¯ä»¥åœ¨[æ„å»ºæ—¶æ‰©å±• info å±æ€§](how-to.md#howto-automatic-expansion)ï¼Œè€Œä¸æ˜¯å¯¹è¿™äº›å€¼è¿›è¡Œç¡¬ç¼–ç ã€‚
å‡è®¾ä½ ä½¿ç”¨ Mavenï¼Œä½ å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼é‡å†™å‰é¢çš„ç¤ºä¾‹ï¼š

<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">info.app.encoding</span>=@project.build.sourceEncoding@</span><br><span class="line"><span class="attr">info.app.java.source</span>=@java.version@</span><br><span class="line"><span class="attr">info.app.java.target</span>=@java.version@</span><br></pre></td></tr></table></figure>

</blockquote>

<p><a id="production-ready-application-info-git"></a></p>
<h4 id="53-9-3ã€Git-æäº¤ä¿¡æ¯"><a href="#53-9-3ã€Git-æäº¤ä¿¡æ¯" class="headerlink" title="53.9.3ã€Git æäº¤ä¿¡æ¯"></a>53.9.3ã€Git æäº¤ä¿¡æ¯</h4><p><code>info</code> ç«¯ç‚¹çš„å¦ä¸€ä¸ªæœ‰ç”¨åŠŸèƒ½æ˜¯å®ƒèƒ½å¤Ÿåœ¨æ„å»ºé¡¹ç›®æ—¶å‘å¸ƒ git æºç ä»“åº“ç›¸å…³çš„çŠ¶æ€çš„ä¿¡æ¯ã€‚å¦‚æœ <code>GitProperties</code> bean å¯ç”¨ï¼Œåˆ™æš´éœ² <code>git.branch</code>ã€<code>git.commit.id</code> å’Œ <code>git.commit.time</code> å±æ€§ã€‚</p>
<p><strong>æç¤º</strong></p>
<blockquote>
<p>å¦‚æœ <code>git.properties</code> æ–‡ä»¶åœ¨ classpath çš„æ ¹ç›®å½•ä¸­å¯ç”¨ï¼Œåˆ™ä¼šè‡ªåŠ¨é…ç½® <code>GitProperties</code> beanã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="how-to.md#howto-git-info"><strong>ç”Ÿæˆ git ä¿¡æ¯</strong></a>ã€‚</p>
</blockquote>
<p>å¦‚æœè¦æ˜¾ç¤ºå®Œæ•´çš„ git ä¿¡æ¯ï¼ˆå³ <code>git.properties</code> çš„å®Œæ•´å†…å®¹ï¼‰ï¼Œè¯·ä½¿ç”¨ <code>management.info.git.mode</code> å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.info.git.mode</span>=full</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-application-info-build"></a></p>
<h4 id="53-9-4ã€æ„å»ºä¿¡æ¯"><a href="#53-9-4ã€æ„å»ºä¿¡æ¯" class="headerlink" title="53.9.4ã€æ„å»ºä¿¡æ¯"></a>53.9.4ã€æ„å»ºä¿¡æ¯</h4><p>å¦‚æœ <code>BuildProperties</code> bean å¯ç”¨ï¼Œåˆ™ <code>info</code> ç«¯ç‚¹è¿˜å¯ä»¥å‘å¸ƒæ„å»ºç›¸å…³çš„ä¿¡æ¯ã€‚å¦‚æœ classpath ä¸­æœ‰ <code>META-INF/build-info.properties</code> æ–‡ä»¶ï¼Œåˆ™ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚</p>
<p><strong>æç¤º</strong></p>
<blockquote>
<p>Maven å’Œ Gradle æ’ä»¶éƒ½å¯ä»¥ç”Ÿæˆè¯¥æ–‡ä»¶ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="how-to.md#howto-build-info"><strong>ç”Ÿæˆæ„å»ºä¿¡æ¯</strong></a>ã€‚</p>
</blockquote>
<p><a id="production-ready-application-info-build"></a></p>
<h4 id="53-9-5ã€ç¼–å†™è‡ªå®šä¹‰-InfoContributor"><a href="#53-9-5ã€ç¼–å†™è‡ªå®šä¹‰-InfoContributor" class="headerlink" title="53.9.5ã€ç¼–å†™è‡ªå®šä¹‰ InfoContributor"></a>53.9.5ã€ç¼–å†™è‡ªå®šä¹‰ InfoContributor</h4><p>è¦æä¾›è‡ªå®šä¹‰åº”ç”¨ç¨‹åºä¿¡æ¯ï¼Œå¯ä»¥æ³¨å†Œå®ç° <a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/InfoContributor.java"><code>InfoContributor</code></a> æ¥å£çš„ Spring beanã€‚</p>
<p>ä»¥ä¸‹ç¤ºä¾‹æä¾›äº†å…·æœ‰å•ä¸ªå€¼çš„ <code>example</code> æ¡ç›®ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.actuate.info.Info;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.actuate.info.InfoContributor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExampleInfoContributor</span> <span class="keyword">implements</span> <span class="title class_">InfoContributor</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contribute</span><span class="params">(Info.Builder builder)</span> &#123;</span><br><span class="line">		builder.withDetail(<span class="string">&quot;example&quot;</span>,</span><br><span class="line">				Collections.singletonMap(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè®¿é—® <code>info</code> ç«¯ç‚¹ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°åŒ…å«ä»¥ä¸‹é™„åŠ æ¡ç›®çš„å“åº”ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">	<span class="attr">&quot;example&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">		<span class="attr">&quot;key&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;value&quot;</span></span><br><span class="line">	<span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p><a id="production-ready-monitoring"></a></p>
<h2 id="54ã€é€šè¿‡-HTTP-ç›‘æ§å’Œç®¡ç†"><a href="#54ã€é€šè¿‡-HTTP-ç›‘æ§å’Œç®¡ç†" class="headerlink" title="54ã€é€šè¿‡ HTTP ç›‘æ§å’Œç®¡ç†"></a>54ã€é€šè¿‡ HTTP ç›‘æ§å’Œç®¡ç†</h2><p>å¦‚æœä½ æ­£åœ¨å¼€å‘ Web åº”ç”¨ç¨‹åºï¼ŒSpring Boot Actuator ä¼šè‡ªåŠ¨é…ç½®æ‰€æœ‰å·²å¯ç”¨çš„ç«¯ç‚¹ä»¥é€šè¿‡ HTTP æš´éœ²ã€‚é»˜è®¤çº¦å®šæ˜¯ä½¿ç”¨å‰ç¼€ä¸º <code>/actuator</code> çš„ç«¯ç‚¹çš„ <code>id</code> ä½œä¸º URL è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œ<code>health</code> ä»¥ <code>/actuator/health</code> æš´éœ²ã€‚æç¤ºï¼šSpring MVCã€Spring WebFlux å’Œ Jersey æœ¬èº«æ”¯æŒ Actuatorã€‚</p>
<p><a id="production-ready-customizing-management-server-context-path"></a></p>
<h3 id="54-1ã€è‡ªå®šä¹‰-Management-ç«¯ç‚¹è·¯å¾„"><a href="#54-1ã€è‡ªå®šä¹‰-Management-ç«¯ç‚¹è·¯å¾„" class="headerlink" title="54.1ã€è‡ªå®šä¹‰ Management ç«¯ç‚¹è·¯å¾„"></a>54.1ã€è‡ªå®šä¹‰ Management ç«¯ç‚¹è·¯å¾„</h3><p>æœ‰æ—¶ï¼Œè‡ªå®šä¹‰ management ç«¯ç‚¹çš„å‰ç¼€å¾ˆæœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œä½ çš„åº”ç”¨ç¨‹åºå¯èƒ½å·²å°† <code>/actuator</code> ç”¨äºå…¶ä»–ç›®çš„ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>management.endpoints.web.base-path</code> å±æ€§æ›´æ”¹ management ç«¯ç‚¹çš„å‰ç¼€ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.endpoints.web.base-path</span>=/manage</span><br></pre></td></tr></table></figure>
<p>å‰é¢çš„ <code>application.properties</code> ç¤ºä¾‹å°†ç«¯ç‚¹ä» <code>/actuator/&#123;id&#125;</code> æ›´æ”¹ä¸º <code>/manage/&#123;id&#125;</code>ï¼ˆä¾‹å¦‚ï¼Œ<code>/manage/info</code>ï¼‰ã€‚</p>
<p><strong>æ³¨æ„</strong></p>
<blockquote>
<p>é™¤éå·²å°† management ç«¯å£é…ç½®ä¸º<a href="production-ready-customizing-management-server-port">ä½¿ç”¨å…¶ä»– HTTP ç«¯å£æš´éœ²ç«¯ç‚¹</a>ï¼Œå¦åˆ™ <code>management.endpoints.web.base-path</code> ä¸ <code>server.servlet.context-path</code> ç›¸å…³è”ã€‚å¦‚æœé…ç½®äº† <code>management.server.port</code>ï¼Œåˆ™ <code>management.endpoints.web.base-path</code> ä¸ <code>management.server.servlet.context-path</code> ç›¸å…³è”ã€‚</p>
</blockquote>
<p>å¦‚æœè¦å°†ç«¯ç‚¹æ˜ å°„åˆ°å…¶ä»–è·¯å¾„ï¼Œå¯ä»¥ä½¿ç”¨ <code>management.endpoints.web.path-mapping</code> å±æ€§ã€‚</p>
<p>ä»¥ä¸‹ç¤ºä¾‹å°† <code>/actuator/health</code> é‡æ–°æ˜ å°„åˆ° <code>/healthcheck</code>ï¼š</p>
<p><strong>application.properties</strong></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.endpoints.web.base-path</span>=/</span><br><span class="line"><span class="attr">management.endpoints.web.path-mapping.health</span>=healthcheck</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-customizing-management-server-port"></a></p>
<h3 id="54-2ã€è‡ªå®šä¹‰-Management-æœåŠ¡å™¨ç«¯å£"><a href="#54-2ã€è‡ªå®šä¹‰-Management-æœåŠ¡å™¨ç«¯å£" class="headerlink" title="54.2ã€è‡ªå®šä¹‰ Management æœåŠ¡å™¨ç«¯å£"></a>54.2ã€è‡ªå®šä¹‰ Management æœåŠ¡å™¨ç«¯å£</h3><p>ä½¿ç”¨é»˜è®¤ HTTP ç«¯å£æš´éœ² management ç«¯ç‚¹æ˜¯åŸºäºäº‘éƒ¨ç½²çš„æ˜æ™ºé€‰æ‹©ã€‚ä½†æ˜¯ï¼Œå¦‚æœåº”ç”¨ç¨‹åºæ˜¯åœ¨è‡ªå·±çš„æ•°æ®ä¸­å¿ƒå†…è¿è¡Œï¼Œä½ å¯èƒ½æ›´å–œæ¬¢ä½¿ç”¨å…¶ä»– HTTP ç«¯å£æš´éœ²ç«¯ç‚¹ã€‚</p>
<p>ä½ å¯ä»¥è®¾ç½® <code>management.server.port</code> å±æ€§ä»¥æ›´æ”¹ HTTP ç«¯å£ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.server.port</span>=<span class="number">8081</span></span><br></pre></td></tr></table></figure>
<p><a id="production-ready-management-specific-ssl"></a></p>
<h3 id="54-3ã€é…ç½®-Management-çš„-SSL"><a href="#54-3ã€é…ç½®-Management-çš„-SSL" class="headerlink" title="54.3ã€é…ç½® Management çš„ SSL"></a>54.3ã€é…ç½® Management çš„ SSL</h3><p>å½“é…ç½®ä¸ºä½¿ç”¨è‡ªå®šä¹‰ç«¯å£æ—¶ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å„ç§ <code>management.server.ssl.*</code> å±æ€§ä¸º management æœåŠ¡å™¨é…ç½®è‡ªå·±çš„ SSLã€‚ä¾‹å¦‚ï¼Œè¿™æ ·åšå¯ä»¥åœ¨ä¸»åº”ç”¨ç¨‹åºä½¿ç”¨ HTTPS æ—¶å¯é€šè¿‡ HTTP ä½¿ç”¨ management æœåŠ¡å™¨ï¼Œå¦‚ä»¥ä¸‹å±æ€§è®¾ç½®æ‰€ç¤ºï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="number">8443</span></span><br><span class="line"><span class="attr">server.ssl.enabled</span>=<span class="literal">true</span></span><br><span class="line"><span class="attr">server.ssl.key-store</span>=classpath:store.jks</span><br><span class="line"><span class="attr">server.ssl.key-password</span>=secret</span><br><span class="line"><span class="attr">management.server.port</span>=<span class="number">8080</span></span><br><span class="line"><span class="attr">management.server.ssl.enabled</span>=<span class="literal">false</span></span><br></pre></td></tr></table></figure>
<p>æˆ–è€…ï¼Œä¸»æœåŠ¡å™¨å’Œ management æœåŠ¡å™¨éƒ½å¯ä»¥ä½¿ç”¨ SSLï¼Œä½†ä»–ä»¬çš„ key store ä¸åŒï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="number">8443</span></span><br><span class="line"><span class="attr">server.ssl.enabled</span>=<span class="literal">true</span></span><br><span class="line"><span class="attr">server.ssl.key-store</span>=classpath:main.jks</span><br><span class="line"><span class="attr">server.ssl.key-password</span>=secret</span><br><span class="line"><span class="attr">management.server.port</span>=<span class="number">8080</span></span><br><span class="line"><span class="attr">management.server.ssl.enabled</span>=<span class="literal">true</span></span><br><span class="line"><span class="attr">management.server.ssl.key-store</span>=classpath:management.jks</span><br><span class="line"><span class="attr">management.server.ssl.key-password</span>=secret</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-customizing-management-server-address"></a></p>
<h3 id="54-4ã€é…ç½®-Management-æœåŠ¡å™¨åœ°å€"><a href="#54-4ã€é…ç½®-Management-æœåŠ¡å™¨åœ°å€" class="headerlink" title="54.4ã€é…ç½® Management æœåŠ¡å™¨åœ°å€"></a>54.4ã€é…ç½® Management æœåŠ¡å™¨åœ°å€</h3><p>ä½ å¯ä»¥é€šè¿‡è®¾ç½® <code>management.server.address</code> å±æ€§æ¥è‡ªå®šä¹‰ management ç«¯ç‚¹å¯ç”¨çš„åœ°å€ã€‚å¦‚æœä½ åªæƒ³åœ¨å†…éƒ¨æˆ–æ“ä½œçš„ç½‘ç»œä¸Šç›‘å¬æˆ–ä»…ç›‘å¬æ¥è‡ª <code>localhost</code> çš„è¿æ¥ï¼Œé‚£ä¹ˆè¿™æ ·åšä¼šéå¸¸æœ‰ç”¨ã€‚</p>
<p><strong>æ³¨æ„</strong></p>
<blockquote>
<p>ä»…å½“ç«¯å£ä¸ä¸»æœåŠ¡å™¨ç«¯å£ä¸åŒæ—¶ï¼Œæ‰èƒ½ç›‘å¬ä¸åŒçš„åœ°å€ã€‚</p>
</blockquote>
<p>ä»¥ä¸‹ <code>application.properties</code> ç¤ºä¾‹ä¸å…è®¸è¿œç¨‹è¿æ¥ managementï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.server.port</span>=<span class="number">8081</span></span><br><span class="line"><span class="attr">management.server.address</span>=<span class="number">127.0</span>.<span class="number">0.1</span></span><br></pre></td></tr></table></figure>
<p><a id="production-ready-disabling-http-endpoints"></a></p>
<h3 id="54-5ã€ç¦ç”¨-HTTP-ç«¯ç‚¹"><a href="#54-5ã€ç¦ç”¨-HTTP-ç«¯ç‚¹" class="headerlink" title="54.5ã€ç¦ç”¨ HTTP ç«¯ç‚¹"></a>54.5ã€ç¦ç”¨ HTTP ç«¯ç‚¹</h3><p>å¦‚æœä½ ä¸å¸Œæœ›é€šè¿‡ HTTP æš´éœ²ç«¯ç‚¹ï¼Œåˆ™å¯ä»¥å°† management ç«¯å£è®¾ç½®ä¸º <code>-1</code>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.server.port</span>=-<span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>è¿™å¯ä»¥ä½¿ç”¨ <code>management.endpoints.web.exposure.exclude</code> å±æ€§æ¥å®ç°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.endpoints.web.exposure.exclude</span>=*</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-jmx"></a></p>
<h2 id="55ã€é€šè¿‡-JMX-ç›‘æ§å’Œç®¡ç†"><a href="#55ã€é€šè¿‡-JMX-ç›‘æ§å’Œç®¡ç†" class="headerlink" title="55ã€é€šè¿‡ JMX ç›‘æ§å’Œç®¡ç†"></a>55ã€é€šè¿‡ JMX ç›‘æ§å’Œç®¡ç†</h2><p>Java ç®¡ç†æ‰©å±•ï¼ˆJava Management Extensionsï¼ŒJMXï¼‰æä¾›äº†ä¸€ç§ç›‘æ§å’Œç®¡ç†åº”ç”¨ç¨‹åºçš„æ ‡å‡†æœºåˆ¶ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring Boot å°† management ç«¯ç‚¹æš´éœ²ä¸º <code>org.springframework.boot</code> åŸŸä¸‹çš„ JMX MBeanã€‚</p>
<p><a id="production-ready-custom-mbean-names"></a></p>
<h3 id="55-1ã€è‡ªå®šä¹‰-MBean-åç§°"><a href="#55-1ã€è‡ªå®šä¹‰-MBean-åç§°" class="headerlink" title="55.1ã€è‡ªå®šä¹‰ MBean åç§°"></a>55.1ã€è‡ªå®šä¹‰ MBean åç§°</h3><p>MBean çš„åç§°é€šå¸¸æ˜¯ä»ç«¯ç‚¹çš„ <code>id</code> ç”Ÿæˆçš„ã€‚ä¾‹å¦‚ï¼Œ<code>health</code> ç«¯ç‚¹å…¬å¼€ä¸º <code>org.springframework.boot:type=Endpoint,name=Health</code>ã€‚</p>
<p>å¦‚æœä½ çš„åº”ç”¨ç¨‹åºåŒ…å«å¤šä¸ª Spring <code>ApplicationContext</code>ï¼Œå¯èƒ½ä¼šå‘ç”Ÿåç§°å†²çªã€‚è¦è§£å†³æ­¤é—®é¢˜ï¼Œå¯ä»¥å°† <code>spring.jmx.unique-names</code> å±æ€§è®¾ç½®ä¸º <code>true</code>ï¼Œä»¥ä¿è¯ MBean åç§°å§‹ç»ˆå”¯ä¸€ã€‚</p>
<p>ä½ è¿˜å¯ä»¥è‡ªå®šä¹‰æš´éœ²ç«¯ç‚¹çš„ JMX åŸŸã€‚ä»¥ä¸‹è®¾ç½®å±•ç¤ºäº†åœ¨ <code>application.properties</code> ä¸­æ‰§è¡Œæ­¤æ“ä½œçš„ç¤ºä¾‹ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.jmx.unique-names</span>=<span class="literal">true</span></span><br><span class="line"><span class="attr">management.endpoints.jmx.domain</span>=com.example.myapp</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-disable-jmx-endpoints"></a></p>
<h3 id="55-2ã€ç¦ç”¨-JMX-ç«¯ç‚¹"><a href="#55-2ã€ç¦ç”¨-JMX-ç«¯ç‚¹" class="headerlink" title="55.2ã€ç¦ç”¨ JMX ç«¯ç‚¹"></a>55.2ã€ç¦ç”¨ JMX ç«¯ç‚¹</h3><p>å¦‚æœä½ ä¸æƒ³é€šè¿‡ JMX æš´éœ²ç«¯ç‚¹ï¼Œå¯ä»¥å°† <code>management.endpoints.jmx.exposure.exclude</code> å±æ€§è®¾ç½®ä¸º <code>*</code>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.endpoints.jmx.exposure.exclude</span>=*</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-jolokia"></a></p>
<h3 id="55-3ã€é€šè¿‡-HTTP-ä½¿ç”¨-Jolokia-è®¿é—®-JMX"><a href="#55-3ã€é€šè¿‡-HTTP-ä½¿ç”¨-Jolokia-è®¿é—®-JMX" class="headerlink" title="55.3ã€é€šè¿‡ HTTP ä½¿ç”¨ Jolokia è®¿é—® JMX"></a>55.3ã€é€šè¿‡ HTTP ä½¿ç”¨ Jolokia è®¿é—® JMX</h3><p>Jolokia æ˜¯ä¸€ä¸ª JMX-HTTP æ¡¥ï¼Œå®ƒæä¾›äº†ä¸€ç§è®¿é—® JMX bean çš„æ–°æ–¹å¼ã€‚è¦ä½¿ç”¨ Jolokiaï¼Œè¯·å¼•å…¥ä¾èµ–ï¼š<code>org.jolokia:jolokia-core</code>ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ Mavenï¼Œä½ å°†æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.jolokia<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jolokia-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä¹‹åå¯ä»¥é€šè¿‡å°† <code>jolokia</code> æˆ– <code>*</code> æ·»åŠ åˆ° <code>management.endpoints.web.exposure.include</code> å±æ€§æ¥æš´éœ² Jolokia ç«¯ç‚¹ã€‚æœ€åï¼Œä½ å¯ä»¥åœ¨ management HTTP æœåŠ¡å™¨ä¸Šä½¿ç”¨ <code>/actuator/jolokia</code> è®¿é—®å®ƒã€‚</p>
<p><a id="production-ready-customizing-jolokia"></a></p>
<h4 id="55-3-1ã€è‡ªå®šä¹‰-Jolokia"><a href="#55-3-1ã€è‡ªå®šä¹‰-Jolokia" class="headerlink" title="55.3.1ã€è‡ªå®šä¹‰ Jolokia"></a>55.3.1ã€è‡ªå®šä¹‰ Jolokia</h4><p>Jolokia æœ‰è®¸å¤šè®¾ç½®ï¼Œä½ å¯ä»¥é€šè¿‡è®¾ç½® servlet å‚æ•°æ¥ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼è¿›è¡Œé…ç½®ã€‚ä½¿ç”¨ Spring Boot æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>application.properties</code> æ–‡ä»¶é…ç½®ã€‚è¯·åœ¨å‚æ•°å‰åŠ ä¸Š <code>management.endpoint.jolokia.config</code>ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.endpoint.jolokia.config.debug</span>=<span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p><a id="production-ready-disabling-jolokia"></a></p>
<h4 id="55-3-2ã€ç¦ç”¨-Jolokia"><a href="#55-3-2ã€ç¦ç”¨-Jolokia" class="headerlink" title="55.3.2ã€ç¦ç”¨ Jolokia"></a>55.3.2ã€ç¦ç”¨ Jolokia</h4><p>å¦‚æœä½ ä½¿ç”¨ Jolokia ä½†ä¸å¸Œæœ› Spring Boot é…ç½®å®ƒï¼Œè¯·å°† <code>management.endpoint.jolokia.enabled</code> å±æ€§è®¾ç½®ä¸º <code>false</code>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.endpoint.jolokia.enabled</span>=<span class="literal">false</span></span><br></pre></td></tr></table></figure>
<p><a id="production-ready-loggers"></a></p>
<h2 id="56ã€æ—¥å¿—è®°å½•å™¨"><a href="#56ã€æ—¥å¿—è®°å½•å™¨" class="headerlink" title="56ã€æ—¥å¿—è®°å½•å™¨"></a>56ã€æ—¥å¿—è®°å½•å™¨</h2><p>Spring Boot Actuator æœ‰å¯åœ¨è¿è¡Œæ—¶æŸ¥çœ‹å’Œé…ç½®åº”ç”¨ç¨‹åºæ—¥å¿—çº§åˆ«çš„åŠŸèƒ½ã€‚ä½ å¯ä»¥æŸ¥çœ‹å…¨éƒ¨æˆ–å•ä¸ªæ—¥å¿—è®°å½•å™¨çš„é…ç½®ï¼Œè¯¥é…ç½®ç”±æ˜¾å¼é…ç½®çš„æ—¥å¿—è®°å½•çº§åˆ«ä»¥åŠæ—¥å¿—è®°å½•æ¡†æ¶ä¸ºå…¶æä¾›çš„æœ‰æ•ˆæ—¥å¿—è®°å½•çº§åˆ«ç»„æˆã€‚è¿™äº›çº§åˆ«å¯ä»¥æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼š</p>
<ul>
<li><code>TRACE</code></li>
<li><code>DEBUG</code></li>
<li><code>INFO</code></li>
<li><code>WARN</code></li>
<li><code>ERROR</code></li>
<li><code>FATAL</code></li>
<li><code>OFF</code></li>
<li><code>null</code></li>
</ul>
<p><code>null</code> è¡¨ç¤ºæ²¡æœ‰æ˜¾å¼é…ç½®ã€‚</p>
<p><a id="production-ready-logger-configuration"></a></p>
<h3 id="56-1ã€é…ç½®ä¸€ä¸ªæ—¥å¿—è®°å½•å™¨"><a href="#56-1ã€é…ç½®ä¸€ä¸ªæ—¥å¿—è®°å½•å™¨" class="headerlink" title="56.1ã€é…ç½®ä¸€ä¸ªæ—¥å¿—è®°å½•å™¨"></a>56.1ã€é…ç½®ä¸€ä¸ªæ—¥å¿—è®°å½•å™¨</h3><p>è¦é…ç½®æ—¥å¿—è®°å½•å™¨ï¼Œè¯·å°†éƒ¨åˆ†å®ä½“ <code>POST</code> åˆ°èµ„æºçš„ URIï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">	<span class="attr">&quot;configuredLevel&quot;</span><span class="punctuation">:</span> <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p><strong>æç¤º</strong></p>
<blockquote>
<p>è¦<strong>é‡ç½®</strong>æ—¥å¿—è®°å½•å™¨çš„ç‰¹å®šçº§åˆ«ï¼ˆå¹¶ä½¿ç”¨é»˜è®¤é…ç½®ä»£æ›¿ï¼‰ï¼Œå¯ä»¥å°† <code>null</code> å€¼ä½œä¸º <code>configuredLevel</code> ä¼ é€’ã€‚</p>
</blockquote>
<p><a id="production-ready-metrics"></a></p>
<h2 id="57ã€æŒ‡æ ‡"><a href="#57ã€æŒ‡æ ‡" class="headerlink" title="57ã€æŒ‡æ ‡"></a>57ã€æŒ‡æ ‡</h2><p>Spring Boot Actuator ä¸º <a target="_blank" rel="noopener" href="https://micrometer.io/">Micrometer</a> æä¾›äº†ä¾èµ–ç®¡ç†å’Œè‡ªåŠ¨é…ç½®ï¼ŒMicrometer æ˜¯ä¸€ä¸ªæ”¯æŒä¼—å¤šç›‘æ§ç³»ç»Ÿçš„åº”ç”¨ç¨‹åºæŒ‡æ ‡é—¨é¢ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><a href="#production-ready-metrics-export-appoptics">AppOptics</a></li>
<li><a href="#production-ready-metrics-export-atlas">Atlas</a></li>
<li><a href="#production-ready-metrics-export-datadog">Datadog</a></li>
<li><a href="#production-ready-metrics-export-dynatrace">Dynatrace</a></li>
<li><a href="#production-ready-metrics-export-elastic">Elastic</a></li>
<li><a href="#production-ready-metrics-export-ganglia">Ganglia</a></li>
<li><a href="#production-ready-metrics-export-graphite">Graphite</a></li>
<li><a href="#production-ready-metrics-export-humio">Humio</a></li>
<li><a href="#production-ready-metrics-export-influx">Influx</a></li>
<li><a href="#production-ready-metrics-export-jmx">JMX</a></li>
<li><a href="#production-ready-metrics-export-kairos">KairosDB</a></li>
<li><a href="#production-ready-metrics-export-newrelic">New Relic</a></li>
<li><a href="#production-ready-metrics-export-prometheus">Prometheus</a></li>
<li><a href="#production-ready-metrics-export-signalfx">SignalFx</a></li>
<li><a href="#production-ready-metrics-export-simple">Simple (in-memory)</a></li>
<li><a href="#production-ready-metrics-export-statsd">StatsD</a></li>
<li><a href="#production-ready-metrics-export-wavefront">Wavefront</a></li>
</ul>
<p><strong>æç¤º</strong></p>
<p>è¦äº†è§£æœ‰å…³ Micrometer åŠŸèƒ½çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…å…¶<a target="_blank" rel="noopener" href="https://micrometer.io/docs">å‚è€ƒæ–‡æ¡£</a>ï¼Œç‰¹åˆ«æ˜¯<a target="_blank" rel="noopener" href="https://micrometer.io/docs/concepts">æ¦‚å¿µéƒ¨åˆ†</a>ã€‚</p>
<p><a id="production-ready-metrics-getting-started"></a></p>
<h3 id="57-1ã€å…¥é—¨"><a href="#57-1ã€å…¥é—¨" class="headerlink" title="57.1ã€å…¥é—¨"></a>57.1ã€å…¥é—¨</h3><p>Spring Boot è‡ªåŠ¨é…ç½®äº†ä¸€ä¸ªç»„åˆçš„ <code>MeterRegistry</code>ï¼Œå¹¶ä¸º classpath ä¸­æ¯ä¸ªå—æ”¯æŒçš„å®ç°å‘è¯¥ç»„åˆæ³¨å†Œä¸€ä¸ªæ³¨å†Œè¡¨ã€‚åœ¨è¿è¡Œæ—¶ï¼Œåªéœ€è¦ classpath ä¸­æœ‰ <code>micrometer-registry-&#123;system&#125;</code> ä¾èµ–å³å¯è®© Spring Boot é…ç½®è¯¥æ³¨å†Œè¡¨ã€‚</p>
<p>å¤§éƒ¨åˆ†æ³¨å†Œè¡¨éƒ½æœ‰å…±åŒç‚¹ ä¾‹å¦‚ï¼Œå³ä½¿ Micrometer æ³¨å†Œå®ç°ä½äº classpath ä¸Šï¼Œä½ ä¹Ÿå¯ä»¥ç¦ç”¨ç‰¹å®šçš„æ³¨å†Œè¡¨ã€‚ä¾‹å¦‚ï¼Œè¦ç¦ç”¨ Datadogï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.datadog.enabled</span>=<span class="literal">false</span></span><br></pre></td></tr></table></figure>
<p>Spring Boot è¿˜ä¼šå°†æ‰€æœ‰è‡ªåŠ¨é…ç½®çš„æ³¨å†Œè¡¨æ·»åŠ åˆ° <code>Metrics</code> ç±»çš„å…¨å±€é™æ€å¤åˆæ³¨å†Œè¡¨ä¸­ï¼Œé™¤éä½ æ˜ç¡®ç¦æ­¢ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.use-global-registry</span>=<span class="literal">false</span></span><br></pre></td></tr></table></figure>
<p>åœ¨æ³¨å†Œè¡¨ä¸­æ³¨å†Œä»»ä½•æŒ‡æ ‡ä¹‹å‰ï¼Œä½ å¯ä»¥æ³¨å†Œä»»æ„æ•°é‡çš„ <code>MeterRegistryCustomizer</code> bean ä»¥è¿›ä¸€æ­¥é…ç½®æ³¨å†Œè¡¨ï¼Œä¾‹å¦‚é€šç”¨æ ‡ç­¾ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line">MeterRegistryCustomizer&lt;MeterRegistry&gt; <span class="title function_">metricsCommonTags</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> registry -&gt; registry.config().commonTags(<span class="string">&quot;region&quot;</span>, <span class="string">&quot;us-east-1&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥é€šè¿‡æŒ‡å®šæ³›å‹ç±»å‹ï¼Œè‡ªå®šä¹‰æ³¨å†Œè¡¨å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line">MeterRegistryCustomizer&lt;GraphiteMeterRegistry&gt; <span class="title function_">graphiteMetricsNamingConvention</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> registry -&gt; registry.config().namingConvention(MY_CUSTOM_CONVENTION);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨è¯¥è®¾ç½®ï¼Œä½ å¯ä»¥åœ¨ç»„ä»¶ä¸­æ³¨å…¥ <code>MeterRegistry</code> å¹¶æ³¨å†ŒæŒ‡æ ‡ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SampleBean</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> Counter counter;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">SampleBean</span><span class="params">(MeterRegistry registry)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.counter = registry.counter(<span class="string">&quot;received.messages&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleMessage</span><span class="params">(String message)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.counter.increment();</span><br><span class="line">		<span class="comment">// å¤„ç†æ¶ˆæ¯å®ç°</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Spring Boot è¿˜<a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.1.4.RELEASE/reference/htmlsingle/#production-ready-metrics-meter">é…ç½®å†…ç½®çš„æµ‹é‡å·¥å…·</a>ï¼ˆå³ <code>MeterBinder</code> å®ç°ï¼‰ï¼Œä½ å¯ä»¥é€šè¿‡é…ç½®æˆ–ä¸“ç”¨æ³¨è§£æ ‡è®°æ¥æ§åˆ¶ã€‚</p>
<p><a id="production-ready-metrics-export"></a></p>
<h3 id="57-2ã€æ”¯æŒçš„ç›‘æ§ç³»ç»Ÿ"><a href="#57-2ã€æ”¯æŒçš„ç›‘æ§ç³»ç»Ÿ" class="headerlink" title="57.2ã€æ”¯æŒçš„ç›‘æ§ç³»ç»Ÿ"></a>57.2ã€æ”¯æŒçš„ç›‘æ§ç³»ç»Ÿ</h3><p><a id="production-ready-metrics-export-appoptics"></a></p>
<h4 id="57-2-1ã€AppOptics"><a href="#57-2-1ã€AppOptics" class="headerlink" title="57.2.1ã€AppOptics"></a>57.2.1ã€AppOptics</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒAppOptics æ³¨å†Œè¡¨ä¼šå®šæœŸå°†æŒ‡æ ‡æ¨é€åˆ° <a target="_blank" rel="noopener" href="https://api.appoptics.com/v1/measurements">api.appoptics.com/v1/measurements</a>ã€‚è¦å°†æŒ‡æ ‡å¯¼å‡ºåˆ° SaaS <a target="_blank" rel="noopener" href="https://micrometer.io/docs/registry/appoptics">AppOptics</a>ï¼Œä½ å¿…é¡»æä¾› API ä»¤ç‰Œï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.appoptics.api-token</span>=YOUR_TOKEN</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-metrics-export-atlas"></a></p>
<h4 id="57-2-2ã€Atlas"><a href="#57-2-2ã€Atlas" class="headerlink" title="57.2.2ã€Atlas"></a>57.2.2ã€Atlas</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåº¦é‡æ ‡å‡†å°†å¯¼å‡ºåˆ°æœ¬åœ°çš„ <a target="_blank" rel="noopener" href="https://micrometer.io/docs/registry/atlas">Atlas</a>ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼æŒ‡å®š <a target="_blank" rel="noopener" href="https://github.com/Netflix/atlas">Atlas æœåŠ¡å™¨</a>çš„ä½ç½®ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.atlas.uri</span>=https://atlas.example.com:<span class="number">7101</span>/api/v1/publish</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-metrics-export-datadog"></a></p>
<h4 id="57-2-3ã€Datadog"><a href="#57-2-3ã€Datadog" class="headerlink" title="57.2.3ã€Datadog"></a>57.2.3ã€Datadog</h4><p>Datadog æ³¨å†Œè¡¨ä¼šå®šæœŸå°†æŒ‡æ ‡æ¨é€åˆ° <a target="_blank" rel="noopener" href="https://www.datadoghq.com/">datadoghq</a>ã€‚è¦å°†æŒ‡æ ‡å¯¼å‡ºåˆ° <a target="_blank" rel="noopener" href="https://micrometer.io/docs/registry/datadog">Datadog</a>ï¼Œä½ å¿…é¡»æä¾› API å¯†é’¥ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.datadog.api-key</span>=YOUR_KEY</span><br></pre></td></tr></table></figure>
<p>ä½ è¿˜å¯ä»¥æ›´æ”¹åº¦é‡æ ‡å‡†å‘é€åˆ° Datadog çš„é—´éš”æ—¶é—´ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.datadog.step</span>=<span class="number">30</span>s</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-metrics-export-dynatrace"></a></p>
<h4 id="57-2-4ã€Dynatrace"><a href="#57-2-4ã€Dynatrace" class="headerlink" title="57.2.4ã€Dynatrace"></a>57.2.4ã€Dynatrace</h4><p>Dynatrace æ³¨å†Œè¡¨å®šæœŸå°†æŒ‡æ ‡æ¨é€åˆ°é…ç½®çš„ URIã€‚è¦å°†æŒ‡æ ‡å¯¼å‡ºåˆ° <a target="_blank" rel="noopener" href="https://micrometer.io/docs/registry/dynatrace">Dynatrace</a>ï¼Œå¿…é¡»æä¾› API ä»¤ç‰Œã€è®¾å¤‡ ID å’Œ URIï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.dynatrace.api-token</span>=YOUR_TOKEN</span><br><span class="line"><span class="attr">management.metrics.export.dynatrace.device-id</span>=YOUR_DEVICE_ID</span><br><span class="line"><span class="attr">management.metrics.export.dynatrace.uri</span>=YOUR_URI</span><br></pre></td></tr></table></figure>
<p>ä½ è¿˜å¯ä»¥æ›´æ”¹åº¦é‡æ ‡å‡†å‘é€åˆ° Dynatrace çš„é—´éš”æ—¶é—´ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.dynatrace.step</span>=<span class="number">30</span>s</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-metrics-export-elastic"></a></p>
<h4 id="57-2-5ã€Elastic"><a href="#57-2-5ã€Elastic" class="headerlink" title="57.2.5ã€Elastic"></a>57.2.5ã€Elastic</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåº¦é‡å°†å¯¼å‡ºåˆ°æœ¬åœ°çš„ <a target="_blank" rel="noopener" href="https://micrometer.io/docs/registry/elastic">Elastic</a>ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å±æ€§æä¾› Elastic æœåŠ¡å™¨çš„ä½ç½®ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.elastic.host</span>=https://elastic.example.com:<span class="number">8086</span></span><br></pre></td></tr></table></figure>
<p><a id="production-ready-metrics-export-ganglia"></a></p>
<h4 id="57-2-6ã€Ganglia"><a href="#57-2-6ã€Ganglia" class="headerlink" title="57.2.6ã€Ganglia"></a>57.2.6ã€Ganglia</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåº¦é‡å°†å¯¼å‡ºåˆ°æœ¬åœ°çš„ <a target="_blank" rel="noopener" href="https://micrometer.io/docs/registry/ganglia">Ganglia</a>ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼æä¾› <a target="_blank" rel="noopener" href="http://ganglia.sourceforge.net/">Ganglia æœåŠ¡å™¨</a>ä¸»æœºå’Œç«¯å£ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.ganglia.host</span>=ganglia.example.com</span><br><span class="line"><span class="attr">management.metrics.export.ganglia.port</span>=<span class="number">9649</span></span><br></pre></td></tr></table></figure>
<p><a id="production-ready-metrics-export-graphite"></a></p>
<h4 id="57-2-7ã€Graphite"><a href="#57-2-7ã€Graphite" class="headerlink" title="57.2.7ã€Graphite"></a>57.2.7ã€Graphite</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåº¦é‡å°†å¯¼å‡ºåˆ°æœ¬åœ°çš„ <a target="_blank" rel="noopener" href="https://micrometer.io/docs/registry/graphite">Graphite</a>ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼æä¾› <a target="_blank" rel="noopener" href="https://graphiteapp.org/">Graphite æœåŠ¡å™¨</a>ä¸»æœºå’Œç«¯å£ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.graphite.host</span>=graphite.example.com</span><br><span class="line"><span class="attr">management.metrics.export.graphite.port</span>=<span class="number">9004</span></span><br></pre></td></tr></table></figure>
<p>Micrometer æä¾›äº†ä¸€ä¸ªé»˜è®¤çš„ <code>HierarchicalNameMapper</code>ï¼Œå®ƒç®¡ç†ç»´åº¦è®¡æ•°å™¨ id å¦‚ä½•<a target="_blank" rel="noopener" href="https://micrometer.io/docs/registry/graphite#_hierarchical_name_mapping">æ˜ å°„åˆ°å¹³é¢åˆ†å±‚åç§°</a>ã€‚</p>
<p><strong>æç¤º</strong></p>
<blockquote>
<p>è¦æ§åˆ¶æ­¤è¡Œä¸ºï¼Œè¯·å®šä¹‰ <code>GraphiteMeterRegistry</code> å¹¶æä¾›è‡ªå·±çš„ <code>HierarchicalNameMapper</code>ã€‚é™¤éä½ è‡ªå·±å®šä¹‰ï¼Œå¦åˆ™ä½¿ç”¨è‡ªåŠ¨é…ç½®çš„ <code>GraphiteConfig</code> å’Œ <code>Clock</code> beanï¼š</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> GraphiteMeterRegistry <span class="title function_">graphiteMeterRegistry</span><span class="params">(GraphiteConfig config, Clock clock)</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">GraphiteMeterRegistry</span>(config, clock, MY_HIERARCHICAL_MAPPER);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-metrics-export-humio"></a></p>
<h4 id="57-2-8ã€Humio"><a href="#57-2-8ã€Humio" class="headerlink" title="57.2.8ã€Humio"></a>57.2.8ã€Humio</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHumio æ³¨å†Œè¡¨ä¼šå®šæœŸå°†æŒ‡æ ‡æ¨é€åˆ° <a target="_blank" rel="noopener" href="https://cloud.humio.com/">cloud.humio.com</a>ã€‚è¦å°†æŒ‡æ ‡å¯¼å‡ºåˆ° SaaS <a target="_blank" rel="noopener" href="https://micrometer.io/docs/registry/humio">Humio</a>ï¼Œä½ å¿…é¡»æä¾› API ä»¤ç‰Œï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.humio.api-token</span>=YOUR_TOKEN</span><br></pre></td></tr></table></figure>
<p>ä½ è¿˜åº”é…ç½®ä¸€ä¸ªæˆ–å¤šä¸ªæ ‡è®°ï¼Œä»¥æ ‡è¯†è¦æ¨é€æŒ‡æ ‡çš„æ•°æ®æºï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.humio.tags.alpha</span>=a</span><br><span class="line"><span class="attr">management.metrics.export.humio.tags.bravo</span>=b</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-metrics-export-influx"></a></p>
<h4 id="57-2-9ã€Influx"><a href="#57-2-9ã€Influx" class="headerlink" title="57.2.9ã€Influx"></a>57.2.9ã€Influx</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåº¦é‡å°†å¯¼å‡ºåˆ°æœ¬åœ°çš„ <a target="_blank" rel="noopener" href="https://micrometer.io/docs/registry/influx">Influx</a>ã€‚è¦æŒ‡å®š <a target="_blank" rel="noopener" href="https://www.influxdata.com/">Influx æœåŠ¡å™¨</a>çš„ä½ç½®ï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.influx.uri</span>=https://influx.example.com:<span class="number">8086</span></span><br></pre></td></tr></table></figure>
<p><a id="production-ready-metrics-export-jmx"></a></p>
<h4 id="57-2-10ã€JMX"><a href="#57-2-10ã€JMX" class="headerlink" title="57.2.10ã€JMX"></a>57.2.10ã€JMX</h4><p>Micrometer æä¾›äº†ä¸ <a target="_blank" rel="noopener" href="https://micrometer.io/docs/registry/jmx">JMX</a> çš„åˆ†å±‚æ˜ å°„ï¼Œä¸»è¦ä¸ºäº†æ–¹ä¾¿åœ¨æœ¬åœ°æŸ¥çœ‹æŒ‡æ ‡ä¸”å¯ç§»æ¤ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œåº¦é‡å°†å¯¼å‡ºåˆ° <code>metrics</code> JMX åŸŸã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼æä¾›è¦ä½¿ç”¨çš„åŸŸï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.jmx.domain</span>=com.example.app.metrics</span><br></pre></td></tr></table></figure>
<p>Micrometer æä¾›äº†ä¸€ä¸ªé»˜è®¤çš„ <code>HierarchicalNameMapper</code>ï¼Œå®ƒç®¡ç†ç»´åº¦è®¡æ•°å™¨ id å¦‚ä½•<a target="_blank" rel="noopener" href="https://micrometer.io/docs/registry/jmx#_hierarchical_name_mapping">æ˜ å°„åˆ°å¹³é¢åˆ†å±‚åç§°</a>ã€‚</p>
<p><strong>æç¤º</strong></p>
<blockquote>
<p>è¦æ§åˆ¶æ­¤è¡Œä¸ºï¼Œè¯·å®šä¹‰ <code>JmxMeterRegistry</code> å¹¶æä¾›è‡ªå·±çš„ <code>HierarchicalNameMapper</code>ã€‚é™¤éä½ è‡ªå·±å®šä¹‰ï¼Œå¦åˆ™ä½¿ç”¨è‡ªåŠ¨é…ç½®çš„ <code>JmxConfig</code> å’Œ <code>Clock</code> beanï¼š</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> JmxMeterRegistry <span class="title function_">jmxMeterRegistry</span><span class="params">(JmxConfig config, Clock clock)</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">JmxMeterRegistry</span>(config, clock, MY_HIERARCHICAL_MAPPER);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-metrics-export-kairos"></a></p>
<h4 id="57-2-11ã€KairosDB"><a href="#57-2-11ã€KairosDB" class="headerlink" title="57.2.11ã€KairosDB"></a>57.2.11ã€KairosDB</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåº¦é‡å°†å¯¼å‡ºåˆ°æœ¬åœ°çš„ <a target="_blank" rel="noopener" href="https://micrometer.io/docs/registry/kairos">KairosDB</a>ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼æä¾› <a target="_blank" rel="noopener" href="https://kairosdb.github.io/">KairosDB æœåŠ¡å™¨</a>çš„ä½ç½®ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.kairos.uri</span>=https://kairosdb.example.com:<span class="number">8080</span>/api/v1/datapoints</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-metrics-export-newrelic"></a></p>
<h4 id="57-2-12ã€New-Relic"><a href="#57-2-12ã€New-Relic" class="headerlink" title="57.2.12ã€New Relic"></a>57.2.12ã€New Relic</h4><p>New Relic æ³¨å†Œè¡¨å®šæœŸå°†æŒ‡æ ‡æ¨é€åˆ° <a target="_blank" rel="noopener" href="https://micrometer.io/docs/registry/new-relic">New Relic</a>ã€‚è¦å°†æŒ‡æ ‡å¯¼å‡ºåˆ° <a target="_blank" rel="noopener" href="https://newrelic.com/">New Relic</a>ï¼Œä½ å¿…é¡»æä¾› API å¯†é’¥å’Œå¸æˆ· IDï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.newrelic.api-key</span>=YOUR_KEY</span><br><span class="line"><span class="attr">management.metrics.export.newrelic.account-id</span>=YOUR_ACCOUNT_ID</span><br></pre></td></tr></table></figure>
<p>ä½ è¿˜å¯ä»¥æ›´æ”¹å°†åº¦é‡å‘é€åˆ° New Relic çš„é—´éš”æ—¶é—´ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.newrelic.step</span>=<span class="number">30</span>s</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-metrics-export-prometheus"></a></p>
<h4 id="57-2-13ã€Prometheus"><a href="#57-2-13ã€Prometheus" class="headerlink" title="57.2.13ã€Prometheus"></a>57.2.13ã€Prometheus</h4><p><a target="_blank" rel="noopener" href="https://micrometer.io/docs/registry/prometheus">Prometheus</a> å¸Œæœ›æŠ“å–æˆ–è½®è¯¢å„ä¸ªåº”ç”¨å®ä¾‹ä»¥è·å–æŒ‡æ ‡æ•°æ®ã€‚Spring Boot åœ¨ <code>/actuator/prometheus</code> ä¸Šæä¾› actuator ç«¯ç‚¹ï¼Œä»¥é€‚å½“çš„æ ¼å¼å‘ˆç° <a target="_blank" rel="noopener" href="https://prometheus.io/">Prometheus scrape </a>ã€‚</p>
<p><strong>æç¤º</strong></p>
<blockquote>
<p>é»˜è®¤æƒ…å†µä¸‹ç«¯ç‚¹ä¸å¯ç”¨ï¼Œå¿…é¡»æš´éœ²ï¼Œè¯·å‚é˜…<a href="#production-ready-endpoints-exposing-endpoints">æš´éœ²ç«¯ç‚¹</a>ä»¥è·å–æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚</p>
</blockquote>
<p>ä»¥ä¸‹æ˜¯è¦æ·»åŠ åˆ° <code>prometheus.yml</code> çš„ç¤ºä¾‹ <code>scrape_config</code>ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">scrape_configs:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;spring&#x27;</span></span><br><span class="line">	<span class="attr">metrics_path:</span> <span class="string">&#x27;/actuator/prometheus&#x27;</span></span><br><span class="line">	<span class="attr">static_configs:</span></span><br><span class="line">	  <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;HOST:PORT&#x27;</span>]</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-metrics-export-signalfx"></a></p>
<h4 id="57-2-14ã€SignalFx"><a href="#57-2-14ã€SignalFx" class="headerlink" title="57.2.14ã€SignalFx"></a>57.2.14ã€SignalFx</h4><p>SignalFx æ³¨å†Œè¡¨å®šæœŸå°†æŒ‡æ ‡æ¨é€åˆ° <a target="_blank" rel="noopener" href="https://micrometer.io/docs/registry/signalfx">SignalFx</a>ã€‚è¦å°†æŒ‡æ ‡å¯¼å‡ºåˆ° <a target="_blank" rel="noopener" href="https://signalfx.com/">SignalFx</a>ï¼Œä½ å¿…é¡»æä¾›è®¿é—®ä»¤ç‰Œï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.signalfx.access-token</span>=YOUR_ACCESS_TOKEN</span><br></pre></td></tr></table></figure>
<p>ä½ è¿˜å¯ä»¥æ›´æ”¹å°†æŒ‡æ ‡å‘é€åˆ° SignalFx çš„é—´éš”æ—¶é—´ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.signalfx.step</span>=<span class="number">30</span>s</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-metrics-export-simple"></a></p>
<h4 id="57-2-15ã€Simple"><a href="#57-2-15ã€Simple" class="headerlink" title="57.2.15ã€Simple"></a>57.2.15ã€Simple</h4><p>Micrometer é™„å¸¦ä¸€ä¸ªç®€å•çš„å†…å­˜åç«¯ï¼Œå¦‚æœæ²¡æœ‰é…ç½®å…¶ä»–æ³¨å†Œè¡¨ï¼Œå®ƒå°†è‡ªåŠ¨ç”¨ä½œåå¤‡ã€‚è¿™ä½¿ä½ å¯ä»¥æŸ¥çœ‹<a href="#production-ready-metrics-endpoint">æŒ‡æ ‡ç«¯ç‚¹</a>ä¸­æ”¶é›†çš„æŒ‡æ ‡ä¿¡æ¯ã€‚</p>
<p>åªè¦ä½ ä½¿ç”¨äº†ä»»ä½•å…¶ä»–å¯ç”¨çš„åç«¯ï¼Œå†…å­˜åç«¯å°±ä¼šè‡ªåŠ¨ç¦ç”¨ã€‚ä½ ä¹Ÿå¯ä»¥æ˜¾å¼ç¦ç”¨å®ƒï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.simple.enabled</span>=<span class="literal">false</span></span><br></pre></td></tr></table></figure>
<p><a id="production-ready-metrics-export-statsd"></a></p>
<h4 id="57-2-16ã€StatsD"><a href="#57-2-16ã€StatsD" class="headerlink" title="57.2.16ã€StatsD"></a>57.2.16ã€StatsD</h4><p>StatsD æ³¨å†Œè¡¨å°† UDP ä¸Šçš„æŒ‡æ ‡æ¨é€åˆ° <a target="_blank" rel="noopener" href="https://micrometer.io/docs/registry/statsd">StatsD</a> ä»£ç†ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œåº¦é‡å°†å¯¼å‡ºåˆ°æœ¬åœ°çš„ StatsD ä»£ç†ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼æä¾› StatsD ä»£ç†ä¸»æœºå’Œç«¯å£ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.statsd.host</span>=statsd.example.com</span><br><span class="line"><span class="attr">management.metrics.export.statsd.port</span>=<span class="number">9125</span></span><br></pre></td></tr></table></figure>
<p>ä½ è¿˜å¯ä»¥æ›´æ”¹è¦ä½¿ç”¨çš„ StatsD çº¿è·¯åè®®ï¼ˆé»˜è®¤ä¸º Datadogï¼‰ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.statsd.flavor</span>=etsy</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-metrics-export-wavefront"></a></p>
<h4 id="57-2-17ã€Wavefront"><a href="#57-2-17ã€Wavefront" class="headerlink" title="57.2.17ã€Wavefront"></a>57.2.17ã€Wavefront</h4><p>Wavefront æ³¨å†Œè¡¨å®šæœŸå°†æŒ‡æ ‡æ¨é€åˆ° <a target="_blank" rel="noopener" href="https://micrometer.io/docs/registry/wavefront">Wavefront</a>ã€‚å¦‚æœè¦å°†æŒ‡æ ‡ç›´æ¥å¯¼å‡ºåˆ° <a target="_blank" rel="noopener" href="https://www.wavefront.com/">Wavefront</a>ï¼Œåˆ™ä½ å¿…é¡»æä¾› API ä»¤ç‰Œï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.wavefront.api-token</span>=YOUR_API_TOKEN</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…ï¼Œä½ å¯ä»¥åœ¨ç¯å¢ƒä¸­ä½¿ç”¨ Wavefront sidecar æˆ–å†…éƒ¨ä»£ç†è®¾ç½®ï¼Œå°†æŒ‡æ ‡æ•°æ®è½¬å‘åˆ° Wavefront API ä¸»æœºï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.wavefront.uri</span>=proxy://localhost:<span class="number">2878</span></span><br></pre></td></tr></table></figure>
<p><strong>æç¤º</strong></p>
<blockquote>
<p>å¦‚æœå°†åº¦é‡å‘å¸ƒåˆ° Wavefront ä»£ç†ï¼ˆå¦‚<a target="_blank" rel="noopener" href="https://docs.wavefront.com/proxies_installing.html">æ–‡æ¡£</a>ä¸­æ‰€è¿°ï¼‰ï¼Œåˆ™ä¸»æœºå¿…é¡»é‡‡ç”¨ <code>proxy://HOST:PORT</code> æ ¼å¼ã€‚</p>
</blockquote>
<p>ä½ è¿˜å¯ä»¥æ›´æ”¹å°†æŒ‡æ ‡å‘é€åˆ° Wavefront çš„é—´éš”æ—¶é—´ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.export.wavefront.step</span>=<span class="number">30</span>s</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-metrics-meter"></a></p>
<h3 id="57-3ã€æ”¯æŒçš„æŒ‡æ ‡"><a href="#57-3ã€æ”¯æŒçš„æŒ‡æ ‡" class="headerlink" title="57.3ã€æ”¯æŒçš„æŒ‡æ ‡"></a>57.3ã€æ”¯æŒçš„æŒ‡æ ‡</h3><p>Spring Boot åœ¨é€‚å½“çš„ç¯å¢ƒæ³¨å†Œä»¥ä¸‹æ ¸å¿ƒæŒ‡æ ‡ï¼š</p>
<ul>
<li>JVM æŒ‡æ ‡ï¼ŒæŠ¥å‘Šåˆ©ç”¨ç‡ï¼š<ul>
<li>å„ç§å†…å­˜å’Œç¼“å†²æ± </li>
<li>ä¸åƒåœ¾å›æ”¶æœ‰å…³çš„ç»Ÿè®¡</li>
<li>çº¿ç¨‹åˆ©ç”¨ç‡</li>
<li>åŠ è½½/å¸è½½ class çš„æ•°é‡</li>
</ul>
</li>
<li>CPU æŒ‡æ ‡</li>
<li>æ–‡ä»¶æè¿°ç¬¦æŒ‡æ ‡</li>
<li>Kafka æ¶ˆè´¹è€…æŒ‡æ ‡</li>
<li>Log4j2 æŒ‡æ ‡ï¼šè®°å½•æ¯ä¸ªçº§åˆ«è®°å½•åˆ° Log4j2 çš„äº‹ä»¶æ•°</li>
<li>Logback æŒ‡æ ‡ï¼šè®°å½•æ¯ä¸ªçº§åˆ«è®°å½•åˆ° Logback çš„äº‹ä»¶æ•°</li>
<li>æ­£å¸¸è¿è¡Œæ—¶é—´æŒ‡æ ‡ï¼šæŠ¥å‘Šæ­£å¸¸è¿è¡Œæ—¶é—´å’Œè¡¨ç¤ºåº”ç”¨ç¨‹åºç»å¯¹å¯åŠ¨æ—¶é—´çš„å›ºå®šè®¡é‡å€¼</li>
<li>Tomcat æŒ‡æ ‡</li>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-integration/docs/current/reference/html/system-management-chapter.html#micrometer-integration">Spring Integration</a> æŒ‡æ ‡</li>
</ul>
<p><a id="production-ready-metrics-spring-mvc"></a></p>
<h4 id="57-3-1ã€Spring-MVC-æŒ‡æ ‡"><a href="#57-3-1ã€Spring-MVC-æŒ‡æ ‡" class="headerlink" title="57.3.1ã€Spring MVC æŒ‡æ ‡"></a>57.3.1ã€Spring MVC æŒ‡æ ‡</h4><p>è‡ªåŠ¨é…ç½®å¯ç”¨ Spring MVC å¤„ç†çš„è¯·æ±‚çš„æŒ‡æ ‡è®°å½•ã€‚å½“ <code>management.metrics.web.server.auto-time-requests</code> ä¸º <code>true</code> æ—¶ï¼Œå°†å¯¹æ‰€æœ‰è¯·æ±‚è¿›è¡Œæ­¤æ£€æµ‹ã€‚æˆ–è€…ï¼Œå½“è®¾ç½®ä¸º <code>false</code> æ—¶ï¼Œä½ å¯ä»¥é€šè¿‡å°† <code>@Timed</code> æ·»åŠ åˆ°è¯·æ±‚å¤„ç†æ–¹æ³•æ¥å¯ç”¨æ£€æµ‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Timed</span> <span class="comment">// &lt;1&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyController</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@GetMapping(&quot;/api/people&quot;)</span></span><br><span class="line">	<span class="meta">@Timed(extraTags = &#123; &quot;region&quot;, &quot;us-east-1&quot; &#125;)</span> <span class="comment">// &lt;2&gt;</span></span><br><span class="line">	<span class="meta">@Timed(value = &quot;all.people&quot;, longTask = true)</span> <span class="comment">// &lt;3&gt;</span></span><br><span class="line">	<span class="keyword">public</span> List&lt;Person&gt; <span class="title function_">listPeople</span><span class="params">()</span> &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>ä¸€ä¸ªæ§åˆ¶å™¨ç±»ï¼Œä¸ºæ§åˆ¶å™¨ä¸­çš„æ¯ä¸ªè¯·æ±‚å¤„ç†ç¨‹åºå¯ç”¨è®¡æ—¶ã€‚</li>
<li>å¯ç”¨å•ä¸ªç«¯ç‚¹ã€‚å¦‚æœä½ åœ¨ç±»ä¸Šä½¿ç”¨äº†å®ƒï¼Œå°±ä¸éœ€è¦åœ¨æ–¹æ³•ä¸Šå†æ¬¡å£°æ˜ï¼Œä½†å¯ä»¥ç”¨å®ƒæ¥è¿›ä¸€æ­¥è‡ªå®šä¹‰è¯¥ç‰¹å®šç«¯ç‚¹çš„è®¡æ—¶å™¨ã€‚</li>
<li>ä½¿ç”¨ <code>longTask = true</code> çš„æ–¹æ³•ä¸ºè¯¥æ–¹æ³•å¯ç”¨é•¿ä»»åŠ¡è®¡æ—¶å™¨ã€‚é•¿ä»»åŠ¡è®¡æ—¶å™¨éœ€è¦å•ç‹¬çš„æŒ‡æ ‡åç§°ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨çŸ­ä»»åŠ¡è®¡æ—¶å™¨è¿›è¡Œå †å ã€‚</li>
</ol>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨åç§°ä¸º <code>http.server.requests</code> ç”Ÿæˆåº¦é‡æŒ‡æ ‡ã€‚å¯ä»¥é€šè¿‡è®¾ç½® <code>management.metrics.web.server.requests-metric-name</code> å±æ€§æ¥è‡ªå®šä¹‰åç§°ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring MVC ç›¸å…³æŒ‡æ ‡ä½¿ç”¨äº†ä»¥ä¸‹æ ‡ç­¾æ ‡è®°ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>æ ‡ç­¾</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>exception</code></td>
<td>å¤„ç†è¯·æ±‚æ—¶æŠ›å‡ºçš„å¼‚å¸¸çš„ç®€å•ç±»åã€‚</td>
</tr>
<tr>
<td><code>method</code></td>
<td>è¯·æ±‚çš„æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼Œ<code>GET</code> æˆ– <code>POST</code>ï¼‰</td>
</tr>
<tr>
<td><code>outcome</code></td>
<td>æ ¹æ®å“åº”çŠ¶æ€ç ç”Ÿæˆç»“æœã€‚1xx æ˜¯ <code>INFORMATIONAL</code>ï¼Œ2xx æ˜¯ <code>SUCCESS</code>ï¼Œ3xx æ˜¯ <code>REDIRECTION</code>ï¼Œ4xx æ˜¯ <code>CLIENT_ERROR</code>ï¼Œ5xx æ˜¯ <code>SERVER_ERROR</code></td>
</tr>
<tr>
<td><code>status</code></td>
<td>å“åº”çš„ HTTP çŠ¶æ€ç ï¼ˆä¾‹å¦‚ï¼Œ<code>200</code> æˆ– <code>500</code>ï¼‰</td>
</tr>
<tr>
<td><code>uri</code></td>
<td>å¦‚æœå¯èƒ½ï¼Œåœ¨å˜é‡æ›¿æ¢ä¹‹å‰è¯·æ±‚ URI æ¨¡æ¿ï¼ˆä¾‹å¦‚ï¼Œ<code>/api/person/&#123;id&#125;</code>ï¼‰</td>
</tr>
</tbody>
</table>
</div>
<p>è¦è‡ªå®šä¹‰æ ‡ç­¾ï¼Œè¯·æä¾›ä¸€ä¸ªå®ç°äº† <code>WebMvcTagsProvider</code> çš„ <code>@Bean</code>ã€‚</p>
<p><a id="production-ready-metrics-web-flux"></a></p>
<h4 id="57-3-2ã€Spring-WebFlux-æŒ‡æ ‡"><a href="#57-3-2ã€Spring-WebFlux-æŒ‡æ ‡" class="headerlink" title="57.3.2ã€Spring WebFlux æŒ‡æ ‡"></a>57.3.2ã€Spring WebFlux æŒ‡æ ‡</h4><p>è‡ªåŠ¨é…ç½®å¯ç”¨äº† WebFlux æ§åˆ¶å™¨å’Œå‡½æ•°å¼å¤„ç†ç¨‹åºå¤„ç†çš„æ‰€æœ‰è¯·æ±‚çš„æŒ‡æ ‡è®°å½•åŠŸèƒ½ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨åä¸º <code>http.server.requests</code> ç”Ÿæˆåº¦é‡æŒ‡æ ‡ã€‚ä½ å¯ä»¥é€šè¿‡è®¾ç½® <code>management.metrics.web.server.requests-metric-name</code> å±æ€§æ¥è‡ªå®šä¹‰åç§°ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸ WebFlux ç›¸å…³çš„æŒ‡æ ‡ä½¿ç”¨ä»¥ä¸‹æ ‡ç­¾æ ‡è®°ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>æ ‡ç­¾</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>exception</code></td>
<td>å¤„ç†è¯·æ±‚æ—¶æŠ›å‡ºçš„å¼‚å¸¸çš„ç®€å•ç±»åã€‚</td>
</tr>
<tr>
<td><code>method</code></td>
<td>è¯·æ±‚æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼Œ<code>GET</code>æˆ– <code>POST</code>ï¼‰</td>
</tr>
<tr>
<td><code>outcome</code></td>
<td>æ ¹æ®å“åº”çŠ¶æ€ç ç”Ÿæˆè¯·æ±‚ç»“æœã€‚1xx æ˜¯ <code>INFORMATIONAL</code>ï¼Œ2xx æ˜¯ <code>SUCCESS</code>ï¼Œ3xx æ˜¯ <code>REDIRECTION</code>ï¼Œ4xx æ˜¯ <code>CLIENT_ERROR</code>ï¼Œ5xx æ˜¯ <code>SERVER_ERROR</code></td>
</tr>
<tr>
<td><code>status</code></td>
<td>å“åº”çš„ HTTP çŠ¶æ€ç ï¼ˆä¾‹å¦‚ï¼Œ<code>200</code> æˆ– <code>500</code>ï¼‰</td>
</tr>
<tr>
<td><code>uri</code></td>
<td>å¦‚æœå¯èƒ½ï¼Œåœ¨å˜é‡æ›¿æ¢ä¹‹å‰è¯·æ±‚ URI æ¨¡æ¿ï¼ˆä¾‹å¦‚ï¼Œ<code>/api/person/&#123;id&#125;</code>ï¼‰</td>
</tr>
</tbody>
</table>
</div>
<p>è¦è‡ªå®šä¹‰æ ‡ç­¾ï¼Œè¯·æä¾›ä¸€ä¸ªå®ç°äº† <code>WebFluxTagsProvider</code> çš„ <code>@Bean</code>ã€‚</p>
<p><a id="production-ready-metrics-jersey-server"></a></p>
<h4 id="57-3-3ã€Jersey-Server-æŒ‡æ ‡"><a href="#57-3-3ã€Jersey-Server-æŒ‡æ ‡" class="headerlink" title="57.3.3ã€Jersey Server æŒ‡æ ‡"></a>57.3.3ã€Jersey Server æŒ‡æ ‡</h4><p>è‡ªåŠ¨é…ç½®å¯ç”¨äº†ç”± Jersey JAX-RS å®ç°å¤„ç†çš„è¯·æ±‚çš„æŒ‡æ ‡è®°å½•åŠŸèƒ½ã€‚å½“ <code>management.metrics.web.server.auto-time-requests</code> ä¸º <code>true</code> æ—¶ï¼Œå°†å¯¹æ‰€æœ‰è¯·æ±‚è¿›è¡Œè¯¥é¡¹æ£€æµ‹ã€‚å½“è®¾ç½®ä¸º <code>false</code> æ—¶ï¼Œä½ å¯ä»¥é€šè¿‡å°† <code>@Timed</code> æ·»åŠ åˆ°è¯·æ±‚å¤„ç†æ–¹æ³•ä¸Šæ¥å¯ç”¨æ£€æµ‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Path(&quot;/api/people&quot;)</span></span><br><span class="line"><span class="meta">@Timed</span> <span class="comment">// &lt;1&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Endpoint</span> &#123;</span><br><span class="line">	<span class="meta">@GET</span></span><br><span class="line">	<span class="meta">@Timed(extraTags = &#123; &quot;region&quot;, &quot;us-east-1&quot; &#125;)</span> <span class="comment">// &lt;2&gt;</span></span><br><span class="line">	<span class="meta">@Timed(value = &quot;all.people&quot;, longTask = true)</span> <span class="comment">// &lt;3&gt;</span></span><br><span class="line">	<span class="keyword">public</span> List&lt;Person&gt; <span class="title function_">listPeople</span><span class="params">()</span> &#123; ... &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>åœ¨èµ„æºç±»ä¸Šï¼Œä¸ºèµ„æºä¸­çš„æ¯ä¸ªè¯·æ±‚å¤„ç†ç¨‹åºå¯ç”¨è®¡æ—¶ã€‚</li>
<li>åœ¨æ–¹æ³•ä¸Šåˆ™å¯ç”¨å•ä¸ªç«¯ç‚¹ã€‚å¦‚æœä½ åœ¨ç±»ä¸Šä½¿ç”¨äº†å®ƒï¼Œåˆ™ä¸éœ€åœ¨æ–¹æ³•ä¸Šå†æ¬¡å£°æ˜ï¼Œä½†å¯ä»¥ç”¨å®ƒæ¥è¿›ä¸€æ­¥è‡ªå®šä¹‰è¯¥ç‰¹å®šç«¯ç‚¹çš„è®¡æ—¶å™¨ã€‚</li>
<li>åœ¨æœ‰ <code>longTask = true</code> çš„æ–¹æ³•ä¸Šï¼Œä¸ºè¯¥æ–¹æ³•å¯ç”¨é•¿ä»»åŠ¡è®¡æ—¶å™¨ã€‚é•¿ä»»åŠ¡è®¡æ—¶å™¨éœ€è¦å•ç‹¬çš„åº¦é‡åç§°ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨çŸ­ä»»åŠ¡è®¡æ—¶å™¨è¿›è¡Œå †å ã€‚</li>
</ol>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨åä¸º <code>http.server.requests</code> ç”Ÿæˆåº¦é‡æŒ‡æ ‡ã€‚å¯ä»¥é€šè¿‡è®¾ç½® <code>management.metrics.web.server.requests-metric-name</code> å±æ€§æ¥è‡ªå®šä¹‰åç§°ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒJersey æœåŠ¡å™¨æŒ‡æ ‡ä½¿ç”¨ä»¥ä¸‹æ ‡ç­¾æ ‡è®°ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>æ ‡ç­¾</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>exception</code></td>
<td>å¤„ç†è¯·æ±‚æ—¶æŠ›å‡ºçš„å¼‚å¸¸çš„ç®€å•ç±»åã€‚</td>
</tr>
<tr>
<td><code>method</code></td>
<td>è¯·æ±‚çš„æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼Œ<code>GET</code> æˆ– <code>POST</code>ï¼‰</td>
</tr>
<tr>
<td><code>outcome</code></td>
<td>æ ¹æ®å“åº”çŠ¶æ€ç ç”Ÿæˆçš„è¯·æ±‚ç»“æœã€‚1xx æ˜¯ <code>INFORMATIONAL</code>ï¼Œ2xx æ˜¯ <code>SUCCESS</code>ï¼Œ3xx æ˜¯ <code>REDIRECTION</code>ï¼Œ4xx æ˜¯ <code>CLIENT_ERROR</code>ï¼Œ5xx æ˜¯ <code>SERVER_ERROR</code></td>
</tr>
<tr>
<td><code>status</code></td>
<td>å“åº”çš„ HTTP çŠ¶æ€ç ï¼ˆä¾‹å¦‚ï¼Œ<code>200</code>æˆ– <code>500</code>ï¼‰</td>
</tr>
<tr>
<td><code>uri</code></td>
<td>å¦‚æœå¯èƒ½ï¼Œåœ¨å˜é‡æ›¿æ¢ä¹‹å‰è¯·æ±‚ URI æ¨¡æ¿ï¼ˆä¾‹å¦‚ï¼Œ<code>/api/person/&#123;id&#125;</code>ï¼‰</td>
</tr>
</tbody>
</table>
</div>
<p>è¦è‡ªå®šä¹‰æ ‡ç­¾ï¼Œè¯·æä¾›ä¸€ä¸ªå®ç°äº† <code>JerseyTagsProvider</code> çš„ <code>@Bean</code>ã€‚</p>
<p><a id="production-ready-metrics-http-clients"></a></p>
<h4 id="57-3-4ã€HTTP-Client-æŒ‡æ ‡"><a href="#57-3-4ã€HTTP-Client-æŒ‡æ ‡" class="headerlink" title="57.3.4ã€HTTP Client æŒ‡æ ‡"></a>57.3.4ã€HTTP Client æŒ‡æ ‡</h4><p>Spring Boot Actuator ç®¡ç† RestTemplate å’Œ WebClient çš„æŒ‡æ ‡è®°å½•ã€‚ä¸ºæ­¤ï¼Œä½ å¿…é¡»æ³¨å…¥ä¸€ä¸ªè‡ªåŠ¨é…ç½®çš„ builder å¹¶ä½¿ç”¨å®ƒæ¥åˆ›å»ºå®ä¾‹ï¼š</p>
<ul>
<li><code>RestTemplateBuilder</code> ç”¨äº <code>RestTemplate</code></li>
<li><code>WebClient.Builder</code> ç”¨äº <code>WebClient</code></li>
</ul>
<p>ä¹Ÿå¯ä»¥æ‰‹åŠ¨æŒ‡å®šè´Ÿè´£æ­¤æŒ‡æ ‡è®°å½•çš„è‡ªå®šä¹‰ç¨‹åºï¼Œå³ <code>MetricsRestTemplateCustomizer</code> å’Œ <code>MetricsWebClientCustomizer</code>ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨åä¸º <code>http.client.requests</code> ç”Ÿæˆåº¦é‡æŒ‡æ ‡ã€‚å¯ä»¥é€šè¿‡è®¾ç½® <code>management.metrics.web.client.requests-metric-name</code> å±æ€§æ¥è‡ªå®šä¹‰åç§°ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå·²æŒ‡æ ‡è®°å½•å®¢æˆ·ç«¯ç”Ÿæˆçš„åº¦é‡æŒ‡æ ‡ä½¿ç”¨ä»¥ä¸‹æ ‡ç­¾æ ‡è®°ï¼š</p>
<ul>
<li><code>method</code>ï¼Œè¯·æ±‚çš„æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼Œ<code>GET</code>æˆ– <code>POST</code>ï¼‰ã€‚</li>
<li><code>uri</code>ï¼Œå˜é‡æ›¿æ¢ä¹‹å‰çš„è¯·æ±‚ URI æ¨¡æ¿ï¼ˆå¦‚æœå¯èƒ½ï¼‰ï¼ˆä¾‹å¦‚ï¼Œ<code>/api/person/&#123;id&#125;</code>ï¼‰ã€‚</li>
<li><code>status</code>ï¼Œå“åº”çš„ HTTP çŠ¶æ€ç ï¼ˆä¾‹å¦‚ï¼Œ<code>200</code> æˆ– <code>500</code>ï¼‰ã€‚</li>
<li><code>clientName</code>ï¼ŒURI çš„ä¸»æœºéƒ¨åˆ† ã€‚</li>
</ul>
<p>è¦æ ¹æ®ä½ é€‰æ‹©çš„å®¢æˆ·ç«¯è‡ªå®šä¹‰æ ‡ç­¾ï¼Œä½ å¯ä»¥æä¾›ä¸€ä¸ªå®ç°äº† <code>RestTemplateExchangeTagsProvider</code> æˆ– <code>WebClientExchangeTagsProvider</code> çš„ <code>@Bean</code>ã€‚<code>RestTemplateExchangeTags</code> å’Œ <code>WebClientExchangeTags</code> ä¸­æœ‰ä¾¿æ·çš„é™æ€å‡½æ•°ã€‚</p>
<p><a id="production-ready-metrics-cache"></a></p>
<h4 id="57-3-5ã€Cache-æŒ‡æ ‡"><a href="#57-3-5ã€Cache-æŒ‡æ ‡" class="headerlink" title="57.3.5ã€Cache æŒ‡æ ‡"></a>57.3.5ã€Cache æŒ‡æ ‡</h4><p>åœ¨å¯åŠ¨æ—¶ï¼Œè‡ªåŠ¨é…ç½®å¯åŠ¨æ‰€æœ‰å¯ç”¨ <code>Cache</code> çš„æŒ‡æ ‡è®°å½•åŠŸèƒ½ï¼ŒæŒ‡æ ‡ä»¥ <code>cache</code> ä¸ºå‰ç¼€ã€‚ç¼“å­˜æŒ‡æ ‡è®°å½•é’ˆå¯¹ä¸€ç»„åŸºæœ¬æŒ‡æ ‡è¿›è¡Œäº†æ ‡å‡†åŒ–ã€‚æ­¤å¤–ï¼Œè¿˜æä¾›äº†ç¼“å­˜ç‰¹å®šçš„æŒ‡æ ‡ã€‚</p>
<p>æ”¯æŒä»¥ä¸‹ç¼“å­˜åº“ï¼š</p>
<ul>
<li>Caffeine</li>
<li>EhCache 2</li>
<li>Hazelcast</li>
<li>æ‰€æœ‰å…¼å®¹ JCacheï¼ˆJSR-107ï¼‰çš„å®ç°</li>
</ul>
<p>åº¦é‡æŒ‡æ ‡ç”±ç¼“å­˜çš„åç§°å’Œä» bean åç§°æ´¾ç”Ÿçš„ <code>CacheManager</code> çš„åç§°æ ‡è®°ã€‚</p>
<p><strong>æ³¨æ„</strong></p>
<blockquote>
<p>åªæœ‰å¯åŠ¨æ—¶å¯ç”¨çš„ç¼“å­˜æ‰ä¼šç»‘å®šåˆ°æ³¨å†Œè¡¨ã€‚å¯¹äºåœ¨å¯åŠ¨é˜¶æ®µä¹‹åå³æ—¶æˆ–ä»¥ç¼–ç¨‹æ–¹å¼åˆ›å»ºçš„ç¼“å­˜ï¼Œéœ€è¦æ˜¾å¼æ³¨å†Œã€‚å¯ç”¨ <code>CacheMetricsRegistrar</code> bean ç®€åŒ–è¯¥è¿‡ç¨‹ã€‚</p>
</blockquote>
<p><a id="production-ready-metrics-jdbc"></a></p>
<h4 id="57-3-6ã€æ•°æ®æºæŒ‡æ ‡"><a href="#57-3-6ã€æ•°æ®æºæŒ‡æ ‡" class="headerlink" title="57.3.6ã€æ•°æ®æºæŒ‡æ ‡"></a>57.3.6ã€æ•°æ®æºæŒ‡æ ‡</h4><p>è‡ªåŠ¨é…ç½®å¯ç”¨å¯¹æ‰€æœ‰å¯ç”¨ <code>DataSource</code> å¯¹è±¡è¿›è¡ŒæŒ‡æ ‡è®°å½•åŠŸèƒ½ï¼ŒæŒ‡æ ‡çš„åç§°ä¸º <code>jdbc</code>ã€‚æ•°æ®æºæŒ‡æ ‡è®°å½•ä¼šç”Ÿæˆè¡¨ç¤ºæ± ä¸­å½“å‰æ´»åŠ¨ã€å¤§å…è®¸å’Œæœ€å°å…è®¸è¿æ¥çš„è®¡é‡å™¨ï¼ˆgaugeï¼‰ã€‚è¿™äº›è®¡é‡å™¨éƒ½æœ‰ä¸€ä¸ªä»¥ <code>jdbc</code> ä¸ºå‰ç¼€çš„åç§°ã€‚</p>
<p>åº¦é‡æŒ‡æ ‡ä¹Ÿç”±åŸºäº bean åç§°è®¡ç®—çš„ <code>DataSource</code> çš„åç§°æ ‡è®°ã€‚</p>
<p><strong>æç¤º</strong></p>
<blockquote>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring Boot ä¸ºæ‰€æœ‰æ”¯æŒçš„æ•°æ®æºæä¾›äº†å…ƒæ•°æ®ã€‚å¦‚æœå¼€ç®±å³ç”¨ä¸æ”¯æŒä½ å–œæ¬¢çš„æ•°æ®æºï¼Œåˆ™å¯ä»¥æ·»åŠ å…¶ä»– <code>DataSourcePoolMetadataProvider</code> beanã€‚æœ‰å…³ç¤ºä¾‹ï¼Œè¯·å‚é˜… <code>DataSourcePoolMetadataProvidersConfiguration</code>ã€‚</p>
</blockquote>
<p>æ­¤å¤–ï¼ŒHikari ç‰¹å®šçš„æŒ‡æ ‡ç”¨ <code>hikaricp</code> å‰ç¼€æš´éœ²ã€‚æ¯ä¸ªåº¦é‡æŒ‡æ ‡éƒ½ç”±æ± åç§°æ ‡è®°ï¼ˆå¯ä»¥ä½¿ç”¨ <code>spring.datasource.name</code> æ§åˆ¶ï¼‰ã€‚</p>
<p><a id="production-ready-metrics-hibernate"></a></p>
<h4 id="57-3-7ã€Hibernate-æŒ‡æ ‡"><a href="#57-3-7ã€Hibernate-æŒ‡æ ‡" class="headerlink" title="57.3.7ã€Hibernate æŒ‡æ ‡"></a>57.3.7ã€Hibernate æŒ‡æ ‡</h4><p>è‡ªåŠ¨é…ç½®å¯ç”¨æ‰€æœ‰å¯ç”¨ Hibernate <code>EntityManagerFactory</code> å®ä¾‹çš„æŒ‡æ ‡è®°å½•åŠŸèƒ½ï¼Œè¿™äº›å®ä¾‹ä½¿ç”¨åä¸º <code>hibernate</code> çš„åº¦é‡æŒ‡æ ‡ç»Ÿè®¡ä¿¡æ¯ã€‚</p>
<p>åº¦é‡æŒ‡æ ‡ä¹Ÿç”±ä» bean åç§°æ´¾ç”Ÿçš„ <code>EntityManagerFactory</code> çš„åç§°æ ‡è®°ã€‚</p>
<p>è¦å¯ç”¨ä¿¡æ¯ç»Ÿè®¡ï¼Œå¿…é¡»å°†æ ‡å‡† JPA å±æ€§ <code>hibernate.generate_statistics</code> è®¾ç½®ä¸º <code>true</code>ã€‚ä½ å¯ä»¥åœ¨è‡ªåŠ¨é…ç½®çš„ <code>EntityManagerFactory</code> ä¸Šå¯ç”¨å®ƒï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.jpa.properties.hibernate.generate_statistics</span>=<span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p><a id="production-ready-metrics-rabbitmq"></a></p>
<h4 id="57-3-8ã€RabbitMQ-æŒ‡æ ‡"><a href="#57-3-8ã€RabbitMQ-æŒ‡æ ‡" class="headerlink" title="57.3.8ã€RabbitMQ æŒ‡æ ‡"></a>57.3.8ã€RabbitMQ æŒ‡æ ‡</h4><p>è‡ªåŠ¨é…ç½®å°†ä½¿ç”¨åä¸º <code>rabbitmq</code> çš„åº¦é‡æŒ‡æ ‡å¯ç”¨å¯¹æ‰€æœ‰å¯ç”¨ RabbitMQ è¿æ¥å·¥å‚è¿›è¡ŒæŒ‡æ ‡è®°å½•ã€‚</p>
<p><a id="production-ready-metrics-custom"></a></p>
<h3 id="57-4ã€æ³¨å†Œè‡ªå®šä¹‰æŒ‡æ ‡"><a href="#57-4ã€æ³¨å†Œè‡ªå®šä¹‰æŒ‡æ ‡" class="headerlink" title="57.4ã€æ³¨å†Œè‡ªå®šä¹‰æŒ‡æ ‡"></a>57.4ã€æ³¨å†Œè‡ªå®šä¹‰æŒ‡æ ‡</h3><p>è¦æ³¨å†Œè‡ªå®šä¹‰æŒ‡æ ‡ï¼Œè¯·å°† <code>MeterRegistry</code> æ³¨å…¥ä½ çš„ç»„ä»¶ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Dictionary</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> List&lt;String&gt; words = <span class="keyword">new</span> <span class="title class_">CopyOnWriteArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">	Dictionary(MeterRegistry registry) &#123;</span><br><span class="line">		registry.gaugeCollectionSize(<span class="string">&quot;dictionary.size&quot;</span>, Tags.empty(), <span class="built_in">this</span>.words);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// â€¦</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ å‘ç°è·¨ç»„ä»¶æˆ–åº”ç”¨ç¨‹åºé‡å¤è®°å½•ä¸€å¥—åº¦é‡æŒ‡æ ‡ï¼Œåˆ™å¯ä»¥å°†æ­¤å¥—ä»¶å°è£…åœ¨ <code>MeterBinder</code> å®ç°ä¸­ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰ <code>MeterBinder</code> bean çš„æŒ‡æ ‡éƒ½å°†è‡ªåŠ¨ç»‘å®šåˆ° Spring ç®¡ç†çš„ <code>MeterRegistry</code>ã€‚</p>
<p><a id="production-ready-metrics-per-meter-properties"></a></p>
<h3 id="57-5ã€è‡ªå®šä¹‰å•ç‹¬æŒ‡æ ‡"><a href="#57-5ã€è‡ªå®šä¹‰å•ç‹¬æŒ‡æ ‡" class="headerlink" title="57.5ã€è‡ªå®šä¹‰å•ç‹¬æŒ‡æ ‡"></a>57.5ã€è‡ªå®šä¹‰å•ç‹¬æŒ‡æ ‡</h3><p>å¦‚æœéœ€è¦å°†è‡ªå®šä¹‰ç‰¹å®šçš„ <code>Meter</code> å®ä¾‹ï¼Œå¯ä»¥ä½¿ç”¨ <code>io.micrometer.core.instrument.config.MeterFilter</code> æ¥å£ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰ <code>MeterFilter</code> bean éƒ½å°†è‡ªåŠ¨åº”ç”¨äº <code>MeterRegistry.Config</code>ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœè¦å°† <code>mytag.region</code> æ ‡è®°é‡å‘½åä¸º <code>mytag.area</code> ä»¥è·å–ä»¥ <code>com.example</code> å¼€å¤´çš„æ‰€æœ‰ meter IDï¼Œåˆ™å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> MeterFilter <span class="title function_">renameRegionTagMeterFilter</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> MeterFilter.renameTag(<span class="string">&quot;com.example&quot;</span>, <span class="string">&quot;mytag.region&quot;</span>, <span class="string">&quot;mytag.area&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-metrics-common-tags"></a></p>
<h4 id="57-5-1ã€è‡ªå®šä¹‰æ ‡ç­¾"><a href="#57-5-1ã€è‡ªå®šä¹‰æ ‡ç­¾" class="headerlink" title="57.5.1ã€è‡ªå®šä¹‰æ ‡ç­¾"></a>57.5.1ã€è‡ªå®šä¹‰æ ‡ç­¾</h4><p>é€šç”¨æ ‡ç­¾é€šå¸¸ç”¨äºæ“ä½œç¯å¢ƒä¸­çš„ç»´åº¦ä¸‹é’»ï¼Œä¾‹å¦‚ä¸»æœºã€å®ä¾‹ã€åŒºåŸŸã€å †æ ˆç­‰ã€‚é€šç”¨æ ‡ç­¾åº”ç”¨äºæ‰€æœ‰ meterï¼Œå¹¶ä¸”å¯ä»¥æŒ‰ç…§ä»¥ä¸‹ç¤ºä¾‹è¿›è¡Œé…ç½®ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.tags.region</span>=us-east-<span class="number">1</span></span><br><span class="line"><span class="attr">management.metrics.tags.stack</span>=prod</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ç¤ºä¾‹å°† <code>region</code> å’Œ <code>stack</code> æ ‡ç­¾æ·»åŠ åˆ°æ‰€æœ‰ meter ä¸­ï¼Œå…¶å€¼åˆ†åˆ«ä¸º <code>us-east-1</code> å’Œ <code>prod</code>ã€‚</p>
<p><strong>æ³¨æ„</strong></p>
<blockquote>
<p>å¦‚æœä½ ä½¿ç”¨ Graphiteï¼Œé‚£ä¹ˆæ ‡ç­¾çš„é¡ºåºå¾ˆé‡è¦ã€‚ç”±äºä½¿ç”¨æ­¤æ–¹æ³•æ— æ³•ä¿è¯é€šç”¨æ ‡ç­¾çš„é¡ºåºï¼Œå› æ­¤å»ºè®® Graphite ç”¨æˆ·å®šä¹‰è‡ªå®šä¹‰ <code>MeterFilter</code>ã€‚</p>
</blockquote>
<p><a id="_per_meter_properties"></a></p>
<h4 id="57-5-2ã€Per-meter-å±æ€§"><a href="#57-5-2ã€Per-meter-å±æ€§" class="headerlink" title="57.5.2ã€Per-meter å±æ€§"></a>57.5.2ã€Per-meter å±æ€§</h4><p>é™¤äº† <code>MeterFilter</code> bean ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ properties åœ¨ per-meter åŸºç¡€ä¸Šè‡ªå®šä¹‰ã€‚Per-meter å®šä¹‰é€‚ç”¨äºä»¥ç»™å®šåç§°å¼€å¤´çš„æ‰€æœ‰ meter IDã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹å°†ç¦ç”¨ä»»ä½•ä»¥ <code>example.remote</code> å¼€å¤´çš„ ID çš„ meterï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.metrics.enable.example.remote</span>=<span class="literal">false</span></span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸‹å±æ€§å…è®¸ per-meter è‡ªå®šä¹‰ï¼š</p>
<p><strong>è¡¨ 57.1ã€Per-meter è‡ªå®šä¹‰</strong></p>
<p>| å±æ€§ | æè¿° |<br>| <code>management.metrics.enable</code> | æ˜¯å¦æ‹’ç» meter å‘å¸ƒä»»ä½•æŒ‡æ ‡ã€‚ |<br>| <code>management.metrics.distribution.percentiles-histogram</code> | æ˜¯å¦å‘å¸ƒä¸€ä¸ªé€‚ç”¨äºè®¡ç®—å¯èšåˆï¼ˆè·¨ç»´åº¦ï¼‰çš„ç™¾åˆ†æ¯”è¿‘ä¼¼æŸ±çŠ¶å›¾ã€‚ |<br>| <code>management.metrics.distribution.minimum-expected-value</code>ï¼Œ<br/> <code>management.metrics.distribution.maximum-expected-value</code>| é€šè¿‡é™åˆ¶é¢„æœŸå€¼çš„èŒƒå›´æ¥å‘å¸ƒè¾ƒå°‘çš„æŸ±çŠ¶å›¾æ¡¶ã€‚ |<br>| <code>management.metrics.distribution.percentiles</code> | å‘å¸ƒåœ¨ä½ è‡ªå·±çš„åº”ç”¨ç¨‹åºä¸­è®¡ç®—çš„ç™¾åˆ†æ¯”æ•°å€¼ |<br>| <code>management.metrics.distribution.sla</code> | å‘ä¸€ä¸ªä½¿ç”¨ SLA å®šä¹‰çš„å­˜å‚¨æ¡¶å‘å¸ƒç´¯ç§¯æŸ±çŠ¶å›¾ã€‚ |</p>
<p>æœ‰å…³ <code>percentiles-histogram</code>ã€<code>percentiles</code> å’Œ <code>sla</code> æ¦‚å¿µçš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ã€Œ<a target="_blank" rel="noopener" href="https://micrometer.io/docs/concepts#_histograms_and_percentiles">æŸ±çŠ¶å›¾ä¸ç™¾åˆ†ä½æ•°</a>ã€éƒ¨åˆ†çš„æ–‡æ¡£ã€‚</p>
<p><a id="production-ready-metrics-endpoint"></a></p>
<h3 id="57-6ã€æŒ‡æ ‡ç«¯ç‚¹"><a href="#57-6ã€æŒ‡æ ‡ç«¯ç‚¹" class="headerlink" title="57.6ã€æŒ‡æ ‡ç«¯ç‚¹"></a>57.6ã€æŒ‡æ ‡ç«¯ç‚¹</h3><p>Spring Boot æä¾›äº†ä¸€ä¸ª <code>metrics</code> ç«¯ç‚¹ï¼Œå¯ä»¥åœ¨è¯Šæ–­ä¸­ç”¨äºæ£€æŸ¥åº”ç”¨ç¨‹åºæ”¶é›†çš„åº¦é‡æŒ‡æ ‡ã€‚é»˜è®¤æƒ…å†µä¸‹ç«¯ç‚¹ä¸å¯ç”¨ï¼Œå¿…é¡»æ‰‹åŠ¨æš´éœ²ï¼Œè¯·å‚é˜…<a href="#production-ready-endpoints-exposing-endpoints">æš´éœ²ç«¯ç‚¹</a>ä»¥è·å–æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚</p>
<p>è®¿é—® <code>/actuator/metrics</code> ä¼šæ˜¾ç¤ºå¯ç”¨çš„ meter åç§°åˆ—è¡¨ã€‚ä½ å¯ä»¥æŸ¥çœ‹æŸä¸€ä¸ª meter çš„ä¿¡æ¯ï¼Œæ–¹æ³•æ˜¯å°†å…¶åç§°ä½œä¸ºé€‰æ‹©å™¨ï¼Œä¾‹å¦‚ï¼Œ<code>/actuator/metrics/jvm.memory.max</code>ã€‚</p>
<p><strong>æç¤º</strong></p>
<blockquote>
<p>ä½ åœ¨æ­¤å¤„ä½¿ç”¨çš„åç§°åº”ä¸ä»£ç ä¸­ä½¿ç”¨çš„åç§°ç›¸åŒ¹é…ï¼Œè€Œä¸æ˜¯åœ¨å‘½åçº¦å®šè§„èŒƒåŒ–åçš„åç§° â€”â€” ä¸ºäº†å‘é€åˆ°ç›‘æ§ç³»ç»Ÿã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœ <code>jvm.memory.max</code> ç”±äº Prometheus å‘½åçº¦å®šè€Œæ˜¾ç¤ºä¸º <code>jvm_memory_max</code>ï¼Œåˆ™åœ¨å®¡æŸ¥åº¦é‡æŒ‡æ ‡ç«¯ç‚¹ä¸­çš„ meter æ—¶ï¼Œåº”ä»ä½¿ç”¨ <code>jvm.memory.max</code> ä½œä¸ºé€‰æ‹©å™¨ã€‚</p>
</blockquote>
<p>ä½ è¿˜å¯ä»¥åœ¨ URL çš„æœ«å°¾æ·»åŠ ä»»æ„æ•°é‡çš„ <code>tag=KEY:VALUE</code> æŸ¥è¯¢å‚æ•°ï¼Œä»¥ä¾¿å¤šç»´åº¦å‘ä¸‹é’»å– meterï¼Œä¾‹å¦‚ <code>/actuator/metrics/jvm.memory.max?tag=area:nonheap</code>ã€‚</p>
<p><strong>æç¤º</strong></p>
<p>æŠ¥å‘Šçš„æµ‹é‡å€¼æ˜¯ä¸ meter åç§°å’Œå·²åº”ç”¨çš„ä»»ä½•æ ‡ç­¾åŒ¹é…çš„æ‰€æœ‰ meter çš„ç»Ÿè®¡æ•°æ®çš„æ€»å’Œã€‚å› æ­¤ï¼Œåœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œè¿”å›çš„ Value ç»Ÿè®¡ä¿¡æ¯æ˜¯å †çš„ Code Cacheï¼ŒCompressed Class Space å’Œ Metaspace åŒºåŸŸçš„æœ€å¤§å†…å­˜å ç”¨é‡çš„æ€»å’Œã€‚å¦‚æœä½ åªæƒ³æŸ¥çœ‹ Metaspace çš„æœ€å¤§å¤§å°ï¼Œå¯ä»¥æ·»åŠ ä¸€ä¸ªé¢å¤–çš„ <code>tag=id:Metaspace</code>ï¼Œå³ <code>/actuator/metrics/jvm.memory.max?tag=area:nonheap&amp;tag=id:Metaspace</code>ã€‚</p>
<p><a id="production-ready-auditing"></a></p>
<h2 id="58ã€å®¡è®¡"><a href="#58ã€å®¡è®¡" class="headerlink" title="58ã€å®¡è®¡"></a>58ã€å®¡è®¡</h2><p>ä¸€æ—¦ Spring Security ç”Ÿæ•ˆï¼ŒSpring Boot Actuator å°±æ‹¥æœ‰ä¸€ä¸ªçµæ´»çš„å®¡è®¡æ¡†æ¶ï¼Œå®ƒå¯ä»¥å‘å¸ƒäº‹ä»¶ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>authentication success</code>ã€<code>failure</code> å’Œ <code>access denied</code> ä¾‹å¤–ï¼‰ã€‚æ­¤åŠŸèƒ½å¯¹äº‹ä»¶æŠ¥å‘Šå’ŒåŸºäºèº«ä»½éªŒè¯å¤±è´¥å®ç°ä¸€ä¸ªé”å®šç­–ç•¥éå¸¸æœ‰ç”¨ã€‚è¦è‡ªå®šä¹‰å‘å¸ƒçš„å®‰å…¨äº‹ä»¶ï¼Œä½ å¯ä»¥æä¾›è‡ªå·±çš„ <code>AbstractAuthenticationAuditListener</code> å’Œ <code>AbstractAuthorizationAuditListener</code> å®ç°ã€‚</p>
<p>ä½ è¿˜å¯ä»¥å°†å®¡è®¡æœåŠ¡ç”¨äºè‡ªå·±çš„ä¸šåŠ¡äº‹ä»¶ã€‚ä¸ºæ­¤ï¼Œè¯·å°†ç°æœ‰çš„ <code>AuditEventRepository</code> æ³¨å…¥è‡ªå·±çš„ç»„ä»¶å¹¶ç›´æ¥ä½¿ç”¨å®ƒæˆ–ä½¿ç”¨ Spring <code>ApplicationEventPublisher</code>ï¼ˆé€šè¿‡å®ç° <code>ApplicationEventPublisherAware</code>ï¼‰å‘å¸ƒ <code>AuditApplicationEvent</code>ã€‚</p>
<p><a id="production-ready-http-tracing"></a></p>
<h2 id="59ã€HTTP-è¿½è¸ª"><a href="#59ã€HTTP-è¿½è¸ª" class="headerlink" title="59ã€HTTP è¿½è¸ª"></a>59ã€HTTP è¿½è¸ª</h2><p>æ‰€æœ‰ HTTP è¯·æ±‚å°†è‡ªåŠ¨å¯ç”¨è¿½è¸ªåŠŸèƒ½ã€‚ä½ å¯ä»¥é€šè¿‡æŸ¥çœ‹ <code>httptrace</code> ç«¯ç‚¹æ¥è·å–æœ€è¿‘ç›¸å…³çš„ 100 ä¸ªè¯·æ±‚å“åº”ä¿¡æ¯ã€‚</p>
<p><a id="production-ready-http-tracing-custom"></a></p>
<h3 id="59-1ã€è‡ªå®šä¹‰-HTTP-è¿½è¸ª"><a href="#59-1ã€è‡ªå®šä¹‰-HTTP-è¿½è¸ª" class="headerlink" title="59.1ã€è‡ªå®šä¹‰ HTTP è¿½è¸ª"></a>59.1ã€è‡ªå®šä¹‰ HTTP è¿½è¸ª</h3><p>è¦è‡ªå®šä¹‰æ¯ä¸ªè¿½è¸ªä¿¡æ¯ä¸­åŒ…å«çš„é¡¹ï¼Œè¯·ä½¿ç”¨ <code>management.trace.http.include</code> å±æ€§é…ç½®ã€‚å¯¹äºé«˜çº§è‡ªå®šä¹‰ï¼Œè¯·è€ƒè™‘æ³¨å†Œè‡ªå·±çš„ <code>HttpExchangeTracer</code> å®ç°ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨ä¸€ä¸ª <code>InMemoryHttpTraceRepository</code> å­˜å‚¨æœ€æ–°çš„ 100 ä¸ªè¯·æ±‚å“åº”ä¿¡æ¯ã€‚å¦‚æœéœ€è¦æ‰©å±•å®¹é‡ï¼Œå¯å®šä¹‰è‡ªå·±çš„ <code>InMemoryHttpTraceRepository</code> bean å®ä¾‹ã€‚ä½ è¿˜å¯ä»¥åˆ›å»ºè‡ªå·±çš„ <code>HttpTraceRepository</code> å®ç°æ¥æ›¿ä»£é»˜è®¤é…ç½®ã€‚</p>
<p><a id="production-ready-process-monitoring"></a></p>
<h2 id="60ã€è¿›ç¨‹ç›‘æ§"><a href="#60ã€è¿›ç¨‹ç›‘æ§" class="headerlink" title="60ã€è¿›ç¨‹ç›‘æ§"></a>60ã€è¿›ç¨‹ç›‘æ§</h2><p>åœ¨ <code>spring-boot</code> æ¨¡å—ä¸­ï¼Œä½ å¯ä»¥æ‰¾åˆ°ä¸¤ä¸ªç±»æ¥åˆ›å»ºæ–‡ä»¶ï¼Œä»–ä»¬é€šå¸¸ç”¨äºè¿›ç¨‹ç›‘æ§ï¼š</p>
<ul>
<li><code>ApplicationPidFileWriter</code> åˆ›å»ºä¸€ä¸ªåŒ…å«åº”ç”¨ç¨‹åº PID çš„æ–‡ä»¶ï¼ˆé»˜è®¤åœ¨åº”ç”¨ç¨‹åºç›®å½•ä¸­ï¼Œæ–‡ä»¶åä¸º <code>application.pid</code>ï¼‰ã€‚</li>
<li><code>WebServerPortFileWriter</code> åˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ï¼Œå…¶åŒ…å«æ­£åœ¨è¿è¡Œçš„ Web æœåŠ¡å™¨çš„ç«¯å£ï¼ˆé»˜è®¤åœ¨åº”ç”¨ç¨‹åºç›®å½•ä¸­ï¼Œæ–‡ä»¶åä¸º <code>application.port</code>ï¼‰ã€‚</li>
</ul>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™äº› writer æœªæ¿€æ´»ï¼Œä½†ä½ å¯ä»¥å¯ç”¨ï¼š</p>
<ul>
<li><a href="#production-ready-process-monitoring-configuration">æ‰©å±•é…ç½®</a></li>
<li><a href="#production-ready-process-monitoring-programmatically">ç¬¬ 60.2 èŠ‚ã€ç¼–ç¨‹æ–¹å¼</a></li>
</ul>
<p><a id="production-ready-process-monitoring-configuration"></a></p>
<h3 id="60-1ã€æ‰©å±•é…ç½®"><a href="#60-1ã€æ‰©å±•é…ç½®" class="headerlink" title="60.1ã€æ‰©å±•é…ç½®"></a>60.1ã€æ‰©å±•é…ç½®</h3><p>ä½ å¯ä»¥åœ¨ <code>META-INF/spring.factories</code> æ–‡ä»¶ä¸­æ¿€æ´»ç”Ÿæˆå’Œå†™å…¥ PID æ–‡ä»¶çš„ç›‘å¬å™¨ï¼ˆListenerï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">org<span class="selector-class">.springframework</span><span class="selector-class">.context</span>.ApplicationListener=\</span><br><span class="line">org<span class="selector-class">.springframework</span><span class="selector-class">.boot</span><span class="selector-class">.context</span><span class="selector-class">.ApplicationPidFileWriter</span>,\</span><br><span class="line">org<span class="selector-class">.springframework</span><span class="selector-class">.boot</span><span class="selector-class">.web</span><span class="selector-class">.context</span>.WebServerPortFileWriter</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-process-monitoring-configuration"></a></p>
<h3 id="60-2ã€ç¼–ç¨‹æ–¹å¼"><a href="#60-2ã€ç¼–ç¨‹æ–¹å¼" class="headerlink" title="60.2ã€ç¼–ç¨‹æ–¹å¼"></a>60.2ã€ç¼–ç¨‹æ–¹å¼</h3><p>ä½ è¿˜å¯ä»¥é€šè¿‡è°ƒç”¨ <code>SpringApplication.addListeners(...)</code> æ–¹æ³•å¹¶ä¼ é€’ç›¸åº”çš„ <code>Writer</code> å¯¹è±¡æ¥æ¿€æ´»ç›‘å¬å™¨ã€‚æ­¤æ–¹æ³•è¿˜å…è®¸ä½ åœ¨ <code>Writer</code> æ„é€ æ–¹æ³•ä¸­è‡ªå®šä¹‰æ–‡ä»¶åå’Œè·¯å¾„ã€‚</p>
<p><a id="production-ready-cloudfoundry"></a></p>
<h2 id="61ã€Cloud-Foundry-æ”¯æŒ"><a href="#61ã€Cloud-Foundry-æ”¯æŒ" class="headerlink" title="61ã€Cloud Foundry æ”¯æŒ"></a>61ã€Cloud Foundry æ”¯æŒ</h2><p>å½“ä½ éƒ¨ç½²åˆ°ä¸€ä¸ªå…¼å®¹ Cloud Foundry çš„å®ä¾‹æ—¶ï¼ŒSpring Boot çš„ Actuator æ¨¡å—åŒ…å«çš„å…¶ä»–æ”¯æŒå°†è¢«æ¿€æ´»ã€‚<code>/cloudfoundryapplication</code> è·¯å¾„ä¸ºæ‰€æœ‰ <code>@Endpoint</code> bean æä¾›äº†å¦å¤–ä¸€ä¸ªå®‰å…¨è·¯ç”±ã€‚</p>
<p>è¯¥æ‰©å±•æ”¯æŒå…è®¸ä½¿ç”¨ Spring Boot Actuator ä¿¡æ¯æ‰©å…… Cloud Foundry ç®¡ç† UIï¼ˆä¾‹å¦‚å¯ç”¨äºæŸ¥çœ‹å·²éƒ¨ç½²åº”ç”¨çš„ Web åº”ç”¨ï¼‰ã€‚æ¯”å¦‚ï¼Œåº”ç”¨ç¨‹åºçŠ¶æ€é¡µé¢å¯ä»¥åŒ…æ‹¬å®Œæ•´çš„å¥åº·ä¿¡æ¯è€Œä¸æ˜¯å¸¸è§çš„ running æˆ– stop çŠ¶æ€ã€‚</p>
<p><strong>æ³¨æ„</strong></p>
<blockquote>
<p>å¸¸è§„ç”¨æˆ·æ— æ³•ç›´æ¥è®¿é—® <code>/cloudfoundryapplication</code> è·¯å¾„ã€‚ä¸ºäº†èƒ½è®¿é—®ç«¯ç‚¹ï¼Œä½ å¿…é¡»åœ¨è¯·æ±‚æ—¶ä¼ é€’ä¸€ä¸ªæœ‰æ•ˆçš„ UAA ä»¤ç‰Œã€‚</p>
</blockquote>
<p><a id="production-ready-cloudfoundry-disable"></a></p>
<h3 id="61-1ã€ç¦ç”¨-Cloud-Foundry-Actuator-æ‰©å±•æ”¯æŒ"><a href="#61-1ã€ç¦ç”¨-Cloud-Foundry-Actuator-æ‰©å±•æ”¯æŒ" class="headerlink" title="61.1ã€ç¦ç”¨ Cloud Foundry Actuator æ‰©å±•æ”¯æŒ"></a>61.1ã€ç¦ç”¨ Cloud Foundry Actuator æ‰©å±•æ”¯æŒ</h3><p>å¦‚æœè¦å®Œå…¨ç¦ç”¨ <code>/cloudfoundryapplication</code> ç«¯ç‚¹ï¼Œå¯ä»¥å°†ä»¥ä¸‹è®¾ç½®æ·»åŠ åˆ° <code>application.properties</code> æ–‡ä»¶ä¸­ï¼š</p>
<p><strong>application.properties</strong></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.cloudfoundry.enabled</span>=<span class="literal">false</span></span><br></pre></td></tr></table></figure>
<p><a id="production-ready-cloudfoundry-ssl"></a></p>
<h3 id="61-2ã€Cloud-Foundry-è‡ªç­¾åè¯ä¹¦"><a href="#61-2ã€Cloud-Foundry-è‡ªç­¾åè¯ä¹¦" class="headerlink" title="61.2ã€Cloud Foundry è‡ªç­¾åè¯ä¹¦"></a>61.2ã€Cloud Foundry è‡ªç­¾åè¯ä¹¦</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>/cloudfoundryapplication</code> ç«¯ç‚¹çš„å®‰å…¨éªŒè¯ä¼šå¯¹å„ç§ Cloud Foundry æœåŠ¡è¿›è¡Œ SSL è°ƒç”¨ã€‚å¦‚æœä½ çš„ Cloud Foundry UAA æˆ– Cloud Controller æœåŠ¡ä½¿ç”¨è‡ªç­¾åè¯ä¹¦ï¼Œåˆ™éœ€è¦è®¾ç½®ä»¥ä¸‹å±æ€§ï¼š</p>
<p><strong>application.properties</strong></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.cloudfoundry.skip-ssl-validation</span>=<span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p><a id="_custom_context_path"></a></p>
<h3 id="61-3ã€è‡ªå®šä¹‰ä¸Šä¸‹æ–‡è·¯å¾„"><a href="#61-3ã€è‡ªå®šä¹‰ä¸Šä¸‹æ–‡è·¯å¾„" class="headerlink" title="61.3ã€è‡ªå®šä¹‰ä¸Šä¸‹æ–‡è·¯å¾„"></a>61.3ã€è‡ªå®šä¹‰ä¸Šä¸‹æ–‡è·¯å¾„</h3><p>å¦‚æœæœåŠ¡å™¨çš„ context-path å·²é…ç½®ä¸º <code>/</code> ä»¥å¤–çš„å…¶ä»–å†…å®¹ï¼Œåˆ™ Cloud Foundry ç«¯ç‚¹å°†æ— æ³•åœ¨åº”ç”¨ç¨‹åºçš„æ ¹ç›®å½•ä¸­ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ <code>server.servlet.context-path=/app</code>ï¼ŒCloud Foundry ç«¯ç‚¹å°†åœ¨ <code>/app/cloudfoundryapplication/*</code> ä¸Šå¯ç”¨ã€‚</p>
<p>å¦‚æœä½ å¸Œæœ› Cloud Foundry ç«¯ç‚¹å§‹ç»ˆåœ¨ <code>/cloudfoundryapplication/*</code> ä¸Šå¯ç”¨ï¼Œåˆ™æ— è®ºæœåŠ¡å™¨çš„ context-path å¦‚ä½•ï¼Œä½ éƒ½éœ€è¦åœ¨åº”ç”¨ç¨‹åºä¸­æ˜ç¡®é…ç½®å®ƒã€‚é…ç½®å› ä½¿ç”¨çš„ Web æœåŠ¡å™¨è€Œæœ‰æ‰€ä¸åŒã€‚é’ˆå¯¹ Tomcatï¼Œå¯ä»¥æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> TomcatServletWebServerFactory <span class="title function_">servletWebServerFactory</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TomcatServletWebServerFactory</span>() &#123;</span><br><span class="line"></span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">prepareContext</span><span class="params">(Host host,</span></span><br><span class="line"><span class="params">				ServletContextInitializer[] initializers)</span> &#123;</span><br><span class="line">			<span class="built_in">super</span>.prepareContext(host, initializers);</span><br><span class="line">			<span class="type">StandardContext</span> <span class="variable">child</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StandardContext</span>();</span><br><span class="line">			child.addLifecycleListener(<span class="keyword">new</span> <span class="title class_">Tomcat</span>.FixContextListener());</span><br><span class="line">			child.setPath(<span class="string">&quot;/cloudfoundryapplication&quot;</span>);</span><br><span class="line">			<span class="type">ServletContainerInitializer</span> <span class="variable">initializer</span> <span class="operator">=</span> getServletContextInitializer(</span><br><span class="line">					getContextPath());</span><br><span class="line">			child.addServletContainerInitializer(initializer, Collections.emptySet());</span><br><span class="line">			child.setCrossContext(<span class="literal">true</span>);</span><br><span class="line">			host.addChild(child);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> ServletContainerInitializer <span class="title function_">getServletContextInitializer</span><span class="params">(String contextPath)</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> (c, context) -&gt; &#123;</span><br><span class="line">		<span class="type">Servlet</span> <span class="variable">servlet</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GenericServlet</span>() &#123;</span><br><span class="line"></span><br><span class="line">			<span class="meta">@Override</span></span><br><span class="line">			<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(ServletRequest req, ServletResponse res)</span></span><br><span class="line">					<span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">				<span class="type">ServletContext</span> <span class="variable">context</span> <span class="operator">=</span> req.getServletContext()</span><br><span class="line">						.getContext(contextPath);</span><br><span class="line">				context.getRequestDispatcher(<span class="string">&quot;/cloudfoundryapplication&quot;</span>).forward(req,</span><br><span class="line">						res);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;;</span><br><span class="line">		context.addServlet(<span class="string">&quot;cloudfoundry&quot;</span>, servlet).addMapping(<span class="string">&quot;/*&quot;</span>);</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a id="production-ready-whats-next"></a></p>
<h2 id="62ã€ä¸‹ä¸€æ­¥"><a href="#62ã€ä¸‹ä¸€æ­¥" class="headerlink" title="62ã€ä¸‹ä¸€æ­¥"></a>62ã€ä¸‹ä¸€æ­¥</h2><p>å¦‚æœä½ æƒ³äº†è§£æœ¬ç« ä¸­è®¨è®ºçš„ä¸€äº›æ¦‚å¿µï¼Œä½ å¯ä»¥æŸ¥çœ‹ actuator <a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.5.RELEASE/spring-boot-samples">ç¤ºä¾‹åº”ç”¨ç¨‹åº</a>ã€‚æˆ–è®¸ä½ è¿˜æƒ³äº†è§£ <a target="_blank" rel="noopener" href="https://graphite.wikidot.com/">Graphite</a> ç­‰å›¾å½¢å·¥å…·çš„ç›¸å…³çŸ¥è¯†ã€‚</p>
<p>æ­¤å¤–ï¼Œä½ å¯ä»¥ç»§ç»­é˜…è¯»<a href="deployment.md">åº”ç”¨éƒ¨ç½²</a>ç›¸å…³å†…å®¹ï¼Œæˆ–ç»§ç»­é˜…è¯»æœ‰å…³ Spring Boot <a href="build-tool-plugins.md">æ„å»ºå·¥å…·æ’ä»¶</a>çš„ç›¸å…³å†…å®¹ã€‚</p>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>05Spring Boot çš„å®é™…å¼€å‘ä¸­ç”Ÿäº§å°±ç»ªåŠŸèƒ½</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://www.blog.909111.xyz/posts/f95521c8.html">https://www.blog.909111.xyz/posts/f95521c8.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>ä½œè€…</h><div class="post-copyright-cc-info"><h>Miaow.Y.HuğŸ¥</h></div></div><div class="post-copyright-c"><h>å‘å¸ƒäº</h><div class="post-copyright-cc-info"><h>2023-11-09</h></div></div><div class="post-copyright-u"><h>æ›´æ–°äº</h><div class="post-copyright-cc-info"><h>2023-11-09</h></div></div><div class="post-copyright-c"><h>è®¸å¯åè®®</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Spring-Boot/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>Spring Boot</a></div></div><link rel="stylesheet" href="/css/coin.css" media="defer" onload="this.media='all'"/><div class="post-reward"><button class="tip-button reward-button"><span class="tip-button__text">æŠ•å–‚ä½œè€…</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://tuchuang.voooe.cn/images/2023/11/09/mm_facetoface_collect_qrcode_1699496026288.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tuchuang.voooe.cn/images/2023/11/09/mm_facetoface_collect_qrcode_1699496026288.png" alt="å¾®ä¿¡"/></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li><li class="reward-item"><a href="https://tuchuang.voooe.cn/images/2023/11/09/1699496059750.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tuchuang.voooe.cn/images/2023/11/09/1699496059750.jpg" alt="æ”¯ä»˜å®"/></a><div class="post-qr-code-desc">æ”¯ä»˜å®</div></li></ul></div></button></div><audio id="coinAudio" src="https://npm.elemecdn.com/akilar-candyassets@1.0.36/audio/aowu.m4a"></audio><script defer="defer" src="/js/coin.js"></script><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/fed2c244.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://cdn.909111.xyz/upload/20231206/69956bc04e2445f189b053fe8b8daac9.jpg" onerror="onerror=null;src='/assets/r2.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">06pring Boot çš„éƒ¨ç½²</div></div></a></div><div class="next-post pull-right"><a href="/posts/f0bff9f3.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://cdn.909111.xyz/upload/20231206/69956bc04e2445f189b053fe8b8daac9.jpg" onerror="onerror=null;src='/assets/r2.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">04Spring Bootçš„ç‰¹æ€§</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/posts/6995c9a0.html" title="02Spring Bootçš„ç›¸å…³å…¥é—¨"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://cdn.909111.xyz/upload/20231206/69956bc04e2445f189b053fe8b8daac9.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-12-06</div><div class="title">02Spring Bootçš„ç›¸å…³å…¥é—¨</div></div></a></div><div><a href="/posts/5cfa102f.html" title="03Spring Bootçš„æ­£å¼ä½¿ç”¨"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://cdn.909111.xyz/upload/20231206/69956bc04e2445f189b053fe8b8daac9.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-11-09</div><div class="title">03Spring Bootçš„æ­£å¼ä½¿ç”¨</div></div></a></div><div><a href="/posts/5fd014d5.html" title="01Spring Bootç®€ä»‹"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://cdn.909111.xyz/upload/20231206/69956bc04e2445f189b053fe8b8daac9.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-11-09</div><div class="title">01Spring Bootç®€ä»‹</div></div></a></div><div><a href="/posts/fed2c244.html" title="06pring Boot çš„éƒ¨ç½²"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://cdn.909111.xyz/upload/20231206/69956bc04e2445f189b053fe8b8daac9.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-11-09</div><div class="title">06pring Boot çš„éƒ¨ç½²</div></div></a></div><div><a href="/posts/f0bff9f3.html" title="04Spring Bootçš„ç‰¹æ€§"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://cdn.909111.xyz/upload/20231206/69956bc04e2445f189b053fe8b8daac9.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-11-09</div><div class="title">04Spring Bootçš„ç‰¹æ€§</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><svg class="meta_icon" style="width:22px;height:22px;position:relative;top:5px"><use xlink:href="#icon-mulu1"></use></svg><span style="font-weight:bold">ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81Spring-Boot-Actuator-%E7%94%9F%E4%BA%A7%E5%B0%B1%E7%BB%AA%E5%8A%9F%E8%83%BD"><span class="toc-text">äº”ã€Spring Boot Actuator: ç”Ÿäº§å°±ç»ªåŠŸèƒ½</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#52%E3%80%81%E5%90%AF%E7%94%A8%E7%94%9F%E4%BA%A7%E5%B0%B1%E7%BB%AA%E5%8A%9F%E8%83%BD"><span class="toc-text">52ã€å¯ç”¨ç”Ÿäº§å°±ç»ªåŠŸèƒ½</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#53%E3%80%81%E7%AB%AF%E7%82%B9"><span class="toc-text">53ã€ç«¯ç‚¹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#53-1%E3%80%81%E5%90%AF%E7%94%A8%E7%AB%AF%E7%82%B9"><span class="toc-text">53.1ã€å¯ç”¨ç«¯ç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#53-2%E3%80%81%E6%9A%B4%E9%9C%B2%E7%AB%AF%E7%82%B9"><span class="toc-text">53.2ã€æš´éœ²ç«¯ç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#53-3%E3%80%81%E4%BF%9D%E6%8A%A4-HTTP-%E7%AB%AF%E7%82%B9"><span class="toc-text">53.3ã€ä¿æŠ¤ HTTP ç«¯ç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#53-4%E3%80%81%E9%85%8D%E7%BD%AE%E7%AB%AF%E7%82%B9"><span class="toc-text">53.4ã€é…ç½®ç«¯ç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#53-5%E3%80%81Actuator-Web-%E7%AB%AF%E7%82%B9%E8%B6%85%E5%AA%92%E4%BD%93"><span class="toc-text">53.5ã€Actuator Web ç«¯ç‚¹è¶…åª’ä½“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#53-6%E3%80%81%E8%B7%A8%E5%9F%9F%E6%94%AF%E6%8C%81"><span class="toc-text">53.6ã€è·¨åŸŸæ”¯æŒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#53-7%E3%80%81%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E7%AB%AF%E7%82%B9"><span class="toc-text">53.7ã€å®ç°è‡ªå®šä¹‰ç«¯ç‚¹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#53-7-1%E3%80%81%E6%8E%A5%E6%94%B6%E8%BE%93%E5%85%A5"><span class="toc-text">53.7.1ã€æ¥æ”¶è¾“å…¥</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="toc-text">è¾“å…¥ç±»å‹è½¬æ¢</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#53-7-2%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89-Web-%E7%AB%AF%E7%82%B9"><span class="toc-text">53.7.2ã€è‡ªå®šä¹‰ Web ç«¯ç‚¹</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Web-%E7%AB%AF%E7%82%B9%E8%AF%B7%E6%B1%82%E8%B0%93%E8%AF%8D"><span class="toc-text">Web ç«¯ç‚¹è¯·æ±‚è°“è¯</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%B7%AF%E5%BE%84"><span class="toc-text">è·¯å¾„</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#HTTP-%E6%96%B9%E6%B3%95"><span class="toc-text">HTTP æ–¹æ³•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Consume"><span class="toc-text">Consume</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Produce"><span class="toc-text">Produce</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Web-%E7%AB%AF%E7%82%B9%E5%93%8D%E5%BA%94%E7%8A%B6%E6%80%81"><span class="toc-text">Web ç«¯ç‚¹å“åº”çŠ¶æ€</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Web-%E7%AB%AF%E7%82%B9%E8%8C%83%E5%9B%B4%E8%AF%B7%E6%B1%82"><span class="toc-text">Web ç«¯ç‚¹èŒƒå›´è¯·æ±‚</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Web-%E7%AB%AF%E7%82%B9%E5%AE%89%E5%85%A8"><span class="toc-text">Web ç«¯ç‚¹å®‰å…¨</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#53-7-3%E3%80%81Servlet-%E7%AB%AF%E7%82%B9"><span class="toc-text">53.7.3ã€Servlet ç«¯ç‚¹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#53-7-4%E3%80%81%E6%8E%A7%E5%88%B6%E5%99%A8%E7%AB%AF%E7%82%B9"><span class="toc-text">53.7.4ã€æ§åˆ¶å™¨ç«¯ç‚¹</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#53-8%E3%80%81%E5%81%A5%E5%BA%B7%E4%BF%A1%E6%81%AF"><span class="toc-text">53.8ã€å¥åº·ä¿¡æ¯</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#53-8-1%E3%80%81%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E7%9A%84-HealthIndicator"><span class="toc-text">53.8.1ã€è‡ªåŠ¨é…ç½®çš„ HealthIndicator</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#53-8-2%E3%80%81%E7%BC%96%E5%86%99%E8%87%AA%E5%AE%9A%E4%B9%89-HealthIndicator"><span class="toc-text">53.8.2ã€ç¼–å†™è‡ªå®šä¹‰ HealthIndicator</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#53-8-3%E3%80%81%E5%93%8D%E5%BA%94%E5%BC%8F%E5%81%A5%E5%BA%B7%E6%8C%87%E7%A4%BA%E5%99%A8"><span class="toc-text">53.8.3ã€å“åº”å¼å¥åº·æŒ‡ç¤ºå™¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#53-8-4%E3%80%81%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E7%9A%84-ReactiveHealthIndicator"><span class="toc-text">53.8.4ã€è‡ªåŠ¨é…ç½®çš„ ReactiveHealthIndicator</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#53-9%E3%80%81%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E4%BF%A1%E6%81%AF"><span class="toc-text">53.9ã€åº”ç”¨ç¨‹åºä¿¡æ¯</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#53-9-1%E3%80%81%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E7%9A%84-InfoContributor"><span class="toc-text">53.9.1ã€è‡ªåŠ¨é…ç½®çš„ InfoContributor</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#53-9-2%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E4%BF%A1%E6%81%AF"><span class="toc-text">53.9.2ã€è‡ªå®šä¹‰åº”ç”¨ç¨‹åºä¿¡æ¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#53-9-3%E3%80%81Git-%E6%8F%90%E4%BA%A4%E4%BF%A1%E6%81%AF"><span class="toc-text">53.9.3ã€Git æäº¤ä¿¡æ¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#53-9-4%E3%80%81%E6%9E%84%E5%BB%BA%E4%BF%A1%E6%81%AF"><span class="toc-text">53.9.4ã€æ„å»ºä¿¡æ¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#53-9-5%E3%80%81%E7%BC%96%E5%86%99%E8%87%AA%E5%AE%9A%E4%B9%89-InfoContributor"><span class="toc-text">53.9.5ã€ç¼–å†™è‡ªå®šä¹‰ InfoContributor</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#54%E3%80%81%E9%80%9A%E8%BF%87-HTTP-%E7%9B%91%E6%8E%A7%E5%92%8C%E7%AE%A1%E7%90%86"><span class="toc-text">54ã€é€šè¿‡ HTTP ç›‘æ§å’Œç®¡ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#54-1%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89-Management-%E7%AB%AF%E7%82%B9%E8%B7%AF%E5%BE%84"><span class="toc-text">54.1ã€è‡ªå®šä¹‰ Management ç«¯ç‚¹è·¯å¾„</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#54-2%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89-Management-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E5%8F%A3"><span class="toc-text">54.2ã€è‡ªå®šä¹‰ Management æœåŠ¡å™¨ç«¯å£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#54-3%E3%80%81%E9%85%8D%E7%BD%AE-Management-%E7%9A%84-SSL"><span class="toc-text">54.3ã€é…ç½® Management çš„ SSL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#54-4%E3%80%81%E9%85%8D%E7%BD%AE-Management-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9C%B0%E5%9D%80"><span class="toc-text">54.4ã€é…ç½® Management æœåŠ¡å™¨åœ°å€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#54-5%E3%80%81%E7%A6%81%E7%94%A8-HTTP-%E7%AB%AF%E7%82%B9"><span class="toc-text">54.5ã€ç¦ç”¨ HTTP ç«¯ç‚¹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#55%E3%80%81%E9%80%9A%E8%BF%87-JMX-%E7%9B%91%E6%8E%A7%E5%92%8C%E7%AE%A1%E7%90%86"><span class="toc-text">55ã€é€šè¿‡ JMX ç›‘æ§å’Œç®¡ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#55-1%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89-MBean-%E5%90%8D%E7%A7%B0"><span class="toc-text">55.1ã€è‡ªå®šä¹‰ MBean åç§°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#55-2%E3%80%81%E7%A6%81%E7%94%A8-JMX-%E7%AB%AF%E7%82%B9"><span class="toc-text">55.2ã€ç¦ç”¨ JMX ç«¯ç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#55-3%E3%80%81%E9%80%9A%E8%BF%87-HTTP-%E4%BD%BF%E7%94%A8-Jolokia-%E8%AE%BF%E9%97%AE-JMX"><span class="toc-text">55.3ã€é€šè¿‡ HTTP ä½¿ç”¨ Jolokia è®¿é—® JMX</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#55-3-1%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89-Jolokia"><span class="toc-text">55.3.1ã€è‡ªå®šä¹‰ Jolokia</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#55-3-2%E3%80%81%E7%A6%81%E7%94%A8-Jolokia"><span class="toc-text">55.3.2ã€ç¦ç”¨ Jolokia</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#56%E3%80%81%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95%E5%99%A8"><span class="toc-text">56ã€æ—¥å¿—è®°å½•å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#56-1%E3%80%81%E9%85%8D%E7%BD%AE%E4%B8%80%E4%B8%AA%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95%E5%99%A8"><span class="toc-text">56.1ã€é…ç½®ä¸€ä¸ªæ—¥å¿—è®°å½•å™¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#57%E3%80%81%E6%8C%87%E6%A0%87"><span class="toc-text">57ã€æŒ‡æ ‡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#57-1%E3%80%81%E5%85%A5%E9%97%A8"><span class="toc-text">57.1ã€å…¥é—¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#57-2%E3%80%81%E6%94%AF%E6%8C%81%E7%9A%84%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F"><span class="toc-text">57.2ã€æ”¯æŒçš„ç›‘æ§ç³»ç»Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#57-2-1%E3%80%81AppOptics"><span class="toc-text">57.2.1ã€AppOptics</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-2-2%E3%80%81Atlas"><span class="toc-text">57.2.2ã€Atlas</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-2-3%E3%80%81Datadog"><span class="toc-text">57.2.3ã€Datadog</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-2-4%E3%80%81Dynatrace"><span class="toc-text">57.2.4ã€Dynatrace</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-2-5%E3%80%81Elastic"><span class="toc-text">57.2.5ã€Elastic</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-2-6%E3%80%81Ganglia"><span class="toc-text">57.2.6ã€Ganglia</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-2-7%E3%80%81Graphite"><span class="toc-text">57.2.7ã€Graphite</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-2-8%E3%80%81Humio"><span class="toc-text">57.2.8ã€Humio</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-2-9%E3%80%81Influx"><span class="toc-text">57.2.9ã€Influx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-2-10%E3%80%81JMX"><span class="toc-text">57.2.10ã€JMX</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-2-11%E3%80%81KairosDB"><span class="toc-text">57.2.11ã€KairosDB</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-2-12%E3%80%81New-Relic"><span class="toc-text">57.2.12ã€New Relic</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-2-13%E3%80%81Prometheus"><span class="toc-text">57.2.13ã€Prometheus</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-2-14%E3%80%81SignalFx"><span class="toc-text">57.2.14ã€SignalFx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-2-15%E3%80%81Simple"><span class="toc-text">57.2.15ã€Simple</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-2-16%E3%80%81StatsD"><span class="toc-text">57.2.16ã€StatsD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-2-17%E3%80%81Wavefront"><span class="toc-text">57.2.17ã€Wavefront</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#57-3%E3%80%81%E6%94%AF%E6%8C%81%E7%9A%84%E6%8C%87%E6%A0%87"><span class="toc-text">57.3ã€æ”¯æŒçš„æŒ‡æ ‡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#57-3-1%E3%80%81Spring-MVC-%E6%8C%87%E6%A0%87"><span class="toc-text">57.3.1ã€Spring MVC æŒ‡æ ‡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-3-2%E3%80%81Spring-WebFlux-%E6%8C%87%E6%A0%87"><span class="toc-text">57.3.2ã€Spring WebFlux æŒ‡æ ‡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-3-3%E3%80%81Jersey-Server-%E6%8C%87%E6%A0%87"><span class="toc-text">57.3.3ã€Jersey Server æŒ‡æ ‡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-3-4%E3%80%81HTTP-Client-%E6%8C%87%E6%A0%87"><span class="toc-text">57.3.4ã€HTTP Client æŒ‡æ ‡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-3-5%E3%80%81Cache-%E6%8C%87%E6%A0%87"><span class="toc-text">57.3.5ã€Cache æŒ‡æ ‡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-3-6%E3%80%81%E6%95%B0%E6%8D%AE%E6%BA%90%E6%8C%87%E6%A0%87"><span class="toc-text">57.3.6ã€æ•°æ®æºæŒ‡æ ‡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-3-7%E3%80%81Hibernate-%E6%8C%87%E6%A0%87"><span class="toc-text">57.3.7ã€Hibernate æŒ‡æ ‡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-3-8%E3%80%81RabbitMQ-%E6%8C%87%E6%A0%87"><span class="toc-text">57.3.8ã€RabbitMQ æŒ‡æ ‡</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#57-4%E3%80%81%E6%B3%A8%E5%86%8C%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E6%A0%87"><span class="toc-text">57.4ã€æ³¨å†Œè‡ªå®šä¹‰æŒ‡æ ‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#57-5%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8D%95%E7%8B%AC%E6%8C%87%E6%A0%87"><span class="toc-text">57.5ã€è‡ªå®šä¹‰å•ç‹¬æŒ‡æ ‡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#57-5-1%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%87%E7%AD%BE"><span class="toc-text">57.5.1ã€è‡ªå®šä¹‰æ ‡ç­¾</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-5-2%E3%80%81Per-meter-%E5%B1%9E%E6%80%A7"><span class="toc-text">57.5.2ã€Per-meter å±æ€§</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#57-6%E3%80%81%E6%8C%87%E6%A0%87%E7%AB%AF%E7%82%B9"><span class="toc-text">57.6ã€æŒ‡æ ‡ç«¯ç‚¹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#58%E3%80%81%E5%AE%A1%E8%AE%A1"><span class="toc-text">58ã€å®¡è®¡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#59%E3%80%81HTTP-%E8%BF%BD%E8%B8%AA"><span class="toc-text">59ã€HTTP è¿½è¸ª</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#59-1%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89-HTTP-%E8%BF%BD%E8%B8%AA"><span class="toc-text">59.1ã€è‡ªå®šä¹‰ HTTP è¿½è¸ª</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#60%E3%80%81%E8%BF%9B%E7%A8%8B%E7%9B%91%E6%8E%A7"><span class="toc-text">60ã€è¿›ç¨‹ç›‘æ§</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#60-1%E3%80%81%E6%89%A9%E5%B1%95%E9%85%8D%E7%BD%AE"><span class="toc-text">60.1ã€æ‰©å±•é…ç½®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#60-2%E3%80%81%E7%BC%96%E7%A8%8B%E6%96%B9%E5%BC%8F"><span class="toc-text">60.2ã€ç¼–ç¨‹æ–¹å¼</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#61%E3%80%81Cloud-Foundry-%E6%94%AF%E6%8C%81"><span class="toc-text">61ã€Cloud Foundry æ”¯æŒ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#61-1%E3%80%81%E7%A6%81%E7%94%A8-Cloud-Foundry-Actuator-%E6%89%A9%E5%B1%95%E6%94%AF%E6%8C%81"><span class="toc-text">61.1ã€ç¦ç”¨ Cloud Foundry Actuator æ‰©å±•æ”¯æŒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#61-2%E3%80%81Cloud-Foundry-%E8%87%AA%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6"><span class="toc-text">61.2ã€Cloud Foundry è‡ªç­¾åè¯ä¹¦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#61-3%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%8A%E4%B8%8B%E6%96%87%E8%B7%AF%E5%BE%84"><span class="toc-text">61.3ã€è‡ªå®šä¹‰ä¸Šä¸‹æ–‡è·¯å¾„</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#62%E3%80%81%E4%B8%8B%E4%B8%80%E6%AD%A5"><span class="toc-text">62ã€ä¸‹ä¸€æ­¥</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-color: transparent;"><div id="footer-wrap"><div id="ft"><div class="ft-item-1"><div class="t-top"><div class="t-t-l"><p class="ft-t t-l-t">æ ¼è¨€ğŸ§¬</p><div class="bg-ad"><div>å†çœ‹çœ‹é‚£ä¸ªå…‰ç‚¹ï¼Œå®ƒå°±åœ¨è¿™é‡Œï¼Œè¿™æ˜¯å®¶å›­ï¼Œè¿™æ˜¯æˆ‘ä»¬ â€”â€” ä½ æ‰€çˆ±çš„æ¯ä¸€ä¸ªäººï¼Œä½ è®¤è¯†çš„ä¸€ä¸ªäººï¼Œä½ å¬è¯´è¿‡çš„æ¯ä¸€ä¸ªäººï¼Œæ›¾ç»æœ‰è¿‡çš„æ¯ä¸€ä¸ªäººï¼Œéƒ½åœ¨å®ƒä¸Šé¢åº¦è¿‡ä»–ä»¬çš„ä¸€ç”Ÿâœ¨</div><div class="btn-xz-box"><a class="btn-xz" target="_blank" rel="noopener" href="https://stellarium.org/">ç‚¹å‡»å¼€å¯æ˜Ÿè¾°ä¹‹æ—…</a></div></div></div><div class="t-t-r"><p class="ft-t t-l-t">çŒœä½ æƒ³çœ‹ğŸ’¡</p><ul class="ft-links"><li><a href="/box/nav/">ç½‘å€å¯¼èˆª</a></li><li><a href="/social/link/">æˆ‘çš„æœ‹å‹</a><a href="/comments/">ç•™ç‚¹ä»€ä¹ˆ</a></li><li><a href="/personal/about/">å…³äºä½œè€…</a><a href="/archives/">æ–‡ç« å½’æ¡£</a></li><li><a href="/categories/">æ–‡ç« åˆ†ç±»</a><a href="/tags/">æ–‡ç« æ ‡ç­¾</a></li><li><a href="/box/gallery/">æˆ‘çš„ç”»å»Š</a></li></ul></div></div></div><div class="ft-item-2"><p class="ft-t">æ¨èå‹é“¾âŒ›</p><div class="ft-img-group"><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div></div></div></div><div class="copyright"><span><b>&copy;2023</b></span><span><b>&nbsp;&nbsp;By Miaow.Y.HuğŸ¥</b></span></div><div class="footer_custom_text">æˆ‘å¸Œæœ›ä½ èƒ½æ¯ä¸€å¤©éƒ½è¿‡å¾—å¿«ä¹ï¼Œå¹¶ä¸”æ¯ä¸€å¤©éƒ½æœ‰æ”¶è·ï¼ï¼ï¼</div><div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" title="åšå®¢æ¡†æ¶ä¸ºHexo_v6.3.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Frame-Hexo-blue.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" title="ä¸»é¢˜ç‰ˆæœ¬Butterfly_v4.3.1"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Theme-Butterfly-6513df.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" title="æœ¬ç«™é‡‡ç”¨å¤šçº¿éƒ¨ç½²ï¼Œä¸»çº¿è·¯æ‰˜ç®¡äºVercel"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Hosted-Vercel-brightgreen.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://user.51.la/" style="margin-inline:5px" title="æœ¬ç«™æ•°æ®åˆ†æå¾—ç›Šäº51laæŠ€æœ¯æ”¯æŒ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Analytics-51la-3db1eb.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://bitiful.dogecast.com/buckets" style="margin-inline:5px" title="æœ¬ç½‘ç«™ç»Service Workeråˆ†æµè‡³ç¼¤çº·äº‘å¯¹è±¡å­˜å‚¨"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Bucket-ç¼¤çº·äº‘-9c62da.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://www.netdun.net/" style="margin-inline:5px" title="æœ¬ç«™ä½¿ç”¨ç½‘ç›¾æ˜Ÿçƒæä¾›CDNåŠ é€Ÿä¸é˜²æŠ¤"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/CDN-ç½‘ç›¾æ˜Ÿçƒ-fff2cc.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" title="æœ¬ç½‘ç«™æºç ç”±Githubæä¾›å­˜å‚¨ä»“åº“"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Source-Github-d021d6.svg" alt=""/></a></p></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><a class="icon-V hidden" onclick="switchNightMode()" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button><button class="share" type="button" title="å³é”®æ¨¡å¼" onclick="changeMouseMode()"><i class="fas fa-mouse"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog right_side"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button class="share" type="button" title="åˆ†äº«é“¾æ¥" onclick="share()"><i class="fas fa-share-nodes"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i><span id="percent">0<span>%</span></span></button><button id="go-down" type="button" title="ç›´è¾¾åº•éƒ¨" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div class="js-pjax" id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" href="javascript:window.location.reload();"><i class="fa fa-refresh"></i></a><a class="rightMenu-item" href="javascript:rmf.scrollToTop();"><i class="fa fa-arrow-up"></i></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>å¤åˆ¶</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.baidu.com/s?wd=&quot;+window.getSelection().toString());window.location.reload();"><i class="fa fa-search"></i><span>ç™¾åº¦æœç´¢</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());window.location.reload();"><i class="fa fa-link"></i><span>è½¬åˆ°é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste()"><i class="fa fa-copy"></i><span>ç²˜è´´</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-post"><a class="rightMenu-item" href="#post-comment"><i class="fas fa-comment"></i><span>ç©ºé™è¯„è®º</span></a><a class="rightMenu-item" href="javascript:rmf.copyWordsLink()"><i class="fa fa-link"></i><span>å¤åˆ¶æœ¬æ–‡åœ°å€</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-to"><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>æ–°çª—å£æ‰“å¼€</span></a><a class="rightMenu-item" id="menu-too" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>è½¬åˆ°é“¾æ¥</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>å¤åˆ¶é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-img"><a class="rightMenu-item" href="javascript:rmf.saveAs()"><i class="fa fa-download"></i><span>ä¿å­˜å›¾ç‰‡</span></a><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>åœ¨æ–°çª—å£æ‰“å¼€</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>å¤åˆ¶å›¾ç‰‡é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:randomPost()"><i class="fa fa-paper-plane"></i><span>éšä¾¿é€›é€›</span></a><a class="rightMenu-item" href="javascript:switchNightMode();"><i class="fa fa-moon"></i><span>æ˜¼å¤œåˆ‡æ¢</span></a><a class="rightMenu-item" href="/personal/about/"><i class="fa fa-info-circle"></i><span>å…³äºåšå®¢</span></a><a class="rightMenu-item" href="javascript:toggleWinbox();"><i class="fas fa-cog"></i><span>ç¾åŒ–è®¾ç½®</span></a><a class="rightMenu-item" href="javascript:rmf.fullScreen();"><i class="fas fa-expand"></i><span>åˆ‡æ¢å…¨å±</span></a><a class="rightMenu-item" href="javascript:window.print();"><i class="fa-solid fa-print"></i><span>æ‰“å°é¡µé¢</span></a></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.umd.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js" type="module"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script async="async">var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())
setTimeout(function(){preloader.endLoading();}, 5000);
document.getElementById('loading-box').addEventListener('click',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo.909111.xyz/',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo.909111.xyz/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.staticfile.org/twikoo/1.6.8/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script src="https://cdn.staticfile.org/jquery/3.6.3/jquery.min.js"></script><script async src="https://cdn1.tianli0.top/npm/vue@2.6.14/dist/vue.min.js"></script><script async src="https://cdn1.tianli0.top/npm/element-ui@2.15.6/lib/index.js"></script><script async src="https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script><script defer type="text/javascript" src="https://cdn1.tianli0.top/npm/sweetalert2@8.19.0/dist/sweetalert2.all.js"></script><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="https://cdn1.tianli0.top/gh/nextapps-de/winbox/dist/winbox.bundle.min.js"></script><script async src="//at.alicdn.com/t/c/font_3586335_hsivh70x0fm.js"></script><script async src="//at.alicdn.com/t/c/font_3636804_gr02jmjr3y9.js"></script><script async src="//at.alicdn.com/t/c/font_3612150_kfv55xn3u2g.js"></script><script async src="https://cdn.wpon.cn/2022-sucai/Gold-ingot.js"></script><canvas id="universe"></canvas><canvas id="snow"></canvas><script defer src="/js/music.js"></script><script defer src="/js/fomal.js"></script><script defer src="/js/emoji.js"></script><script src="https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/butterfly-extsrc/1.1.3/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdnjs.cloudflare.com/ajax/libs/butterfly-extsrc/1.1.3/click-heart.min.js" async="async" mobile="true"></script><link rel="stylesheet" href="/css/aplayer_css.css" media="print" onload="this.media='all'"><script src="/js/aplayer.js"></script><script src="/js/meting_js.js"></script><script src="https://lib.baomitu.com/pjax/0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show","#web_bg",".js-pjax","#bibi","body > title","#app","#tag-echarts","#posts-echart","#categories-echarts"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="nav-music"><div id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()">æ’­æ”¾éŸ³ä¹</div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random"></meting-js></div><!-- hexo injector body_end start --> <script data-pjax>if(document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    var parent = document.getElementById('recent-posts');
    var child = '<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="https://www.blog.909111.xyz/categories/javaå­¦ä¹ /"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ“š Miaow.Y.Huã®javaå­¦ä¹ ç¬”è®° (5)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://www.blog.909111.xyz/categories/å‰ç«¯/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ® Miaow.Y.Huã®å‰ç«¯å­¦ä¹ ç¬”è®° (2)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://www.blog.909111.xyz/categories/æ¼”ç¤º/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ±â€ğŸ‘“ Miaow.Y.Huã®æ¼”ç¤ºæ–‡æ¡£ (2)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://www.blog.909111.xyz/categories/é¢è¯•é¢˜/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ‘©â€ğŸ’» Miaow.Y.Huã®æ±‚èŒé¢è¯• (2)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><a class="magnet_link_more"  href="https://www.blog.909111.xyz/categories/" style="flex:1;text-align: center;margin-bottom: 10px;">æŸ¥çœ‹æ›´å¤š...</a></div></div>';
    console.log('å·²æŒ‚è½½magnet')
    parent.insertAdjacentHTML("afterbegin",child)}
     </script><style>#catalog_magnet{flex-wrap: wrap;display: flex;width:100%;justify-content:space-between;padding: 10px 10px 0 10px;align-content: flex-start;}.magnet_item{flex-basis: calc(50% - 5px);background: #e9e9e9;margin-bottom: 10px;border-radius: 8px;transition: all 0.2s ease-in-out;}.magnet_item:hover{background: var(--text-bg-hover)}.magnet_link_more{color:#555}.magnet_link{color:black}.magnet_link:hover{color:white}@media screen and (max-width: 600px) {.magnet_item {flex-basis: 100%;}}.magnet_link_context{display:flex;padding: 10px;font-size:16px;transition: all 0.2s ease-in-out;}.magnet_link_context:hover{padding: 10px 20px;}</style>
    <style></style><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('å·²æŒ‚è½½butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var qweather_key = '0c32fd4718b345988056812b5c304e80';
  var gaud_map_key = 'c050791b2b4806d9287232d3688ca41b';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '113.34532,23.15624';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/ac133265.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://cdn.909111.xyz/upload/20231206/69956bc04e2445f189b053fe8b8daac9.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-23</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/ac133265.html&quot;);" href="javascript:void(0);" alt="">çº¿ç¨‹æ± å­¦ä¹ </a><div class="blog-slider__text">ğŸ¥§æœ¬æ–‡å°†é‡ç‚¹ä»çº¿ç¨‹æ± è¿›è¡Œè®²è§£ï¼Œä»¥åŠå¦‚ä½•å®ç°çº¿ç¨‹æ± ï¼Œå¹¶ä¸”çº¿ç¨‹æ± çš„å®ç°æ–¹å¼ï¼Œä»¥åŠçº¿ç¨‹æ± çš„ä¸€äº›ç›¸å…³é—®é¢˜çš„è®²è§£</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/ac133265.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/b7fb4495.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://cdn.909111.xyz/upload/20231206/69956bc04e2445f189b053fe8b8daac9.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/b7fb4495.html&quot;);" href="javascript:void(0);" alt="">éŸ³ä¹</a><div class="blog-slider__text">ğŸ¥§æƒ³è¦å¬æ­Œå—?,æœ¬é¡µé¢å°†é›†æˆéƒ¨åˆ†åœ¨çº¿éŸ³ä¹ä¾›ä½ å€¾å¬ã€‚</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/b7fb4495.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/ece28c36.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://cdn.909111.xyz/upload/20231206/69956bc04e2445f189b053fe8b8daac9.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-27</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/ece28c36.html&quot;);" href="javascript:void(0);" alt="">äºŒåä¸‰ç§è®¾è®¡æ¨¡å¼</a><div class="blog-slider__text">æˆ‘å…¶å®å¾ˆå¤šæ—¶å€™éƒ½æƒ³æ”¾å¼ƒè¿™23ç§é¬¼ä¸œè¥¿ï¼Œçœ‹ç€å¤´ç–¼ï¼ŒäºŒåä¸‰ç§è®¾è®¡æ¨¡å¼ï¼Œé‚£æ˜¯çœŸçš„å¤´ç–¼ï¼Œä¸ä»…ä»…è¦äº†è§£åŸå›¾è¿˜è¦äº†è§£ç›¸å…³ä»£ç ï¼Œä½†æ˜¯è¿™ä¸œè¥¿åˆè´¼é‡è¦ï¼Œæ²¡åŠæ³•ï¼Œæˆ‘åªèƒ½æäº†ï¼Œæ¯•ç«Ÿè½¯è€ƒç¡®å®è›®é‡è¦çš„ï¼Œå¹¶ä¸”è¿™23ç§æ¨¡å¼ä¹Ÿç¡®å®å¾ˆé‡è¦ã€‚</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/ece28c36.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/42904f32.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://cdn.909111.xyz/upload/20231206/69956bc04e2445f189b053fe8b8daac9.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/42904f32.html&quot;);" href="javascript:void(0);" alt="">javaå¤šçº¿ç¨‹é¢è¯•é¢˜</a><div class="blog-slider__text">ğŸ¥§æœ¬æ–‡ä¸»è¦ä»‹ç»å¯¹å¤šçº¿ç¨‹é¢è¯•é¢˜çš„æ€»ç»“</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/42904f32.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/a378bd8e.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://cdn.909111.xyz/upload/20231206/69956bc04e2445f189b053fe8b8daac9.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/a378bd8e.html&quot;);" href="javascript:void(0);" alt="">Python</a><div class="blog-slider__text">ä½œä¸ºç›®å‰çš„ä¸»æµç¼–ç¨‹è¯­è¨€ä¹‹ä¸€ï¼ŒPythonæœ‰ç€ä»–è‡ªå·±çš„ç‰¹ç‚¹ï¼Œæœ¬ç¯‡å°†çºªå½•pythonçš„éƒ¨åˆ†çŸ¥è¯†ç‚¹ã€‚</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/a378bd8e.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://cdn.909111.xyz/upload/20231206/69956bc04e2445f189b053fe8b8daac9.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-22</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt="">Markdownè¯­æ³•ä¸å¤–æŒ‚æ ‡ç­¾å†™æ³•æ±‡æ€»</a><div class="blog-slider__text">ğŸ¥§æœ¬æ–‡æ±‡æ€»Markdownæ ¼å¼ä»¥åŠå¤–æŒ‚æ ‡ç­¾åœ¨ç½‘é¡µç«¯çš„æ¸²æŸ“æ•ˆæœï¼Œå¯ä½œä¸ºæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/135de23b.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://cdn.909111.xyz/upload/20231206/69956bc04e2445f189b053fe8b8daac9.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-20</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/135de23b.html&quot;);" href="javascript:void(0);" alt="">ç‰›å®¢åˆ·é¢˜ç¬”è®°1</a><div class="blog-slider__text">æœ¬æ–‡æ¥è‡ªç¬”è€…ç‰›å®¢åˆ·é¢˜çš„ç¬”è®°ï¼Œä»¥åŠé”™è¯¯çš„è®°å½•</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/135de23b.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/f7912a82.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://cdn.909111.xyz/upload/20231206/69956bc04e2445f189b053fe8b8daac9.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/f7912a82.html&quot;);" href="javascript:void(0);" alt="">åŠ›æ‰£åˆ·é¢˜</a><div class="blog-slider__text">å¿«æ¯•ä¸šäº†ï¼Œå‘ç°è‡ªå·±å†™ä»£ç çš„èƒ½åŠ›è¿˜æ˜¯ä¸æ˜¯å¾ˆå¼ºï¼ŒCVå·¥ç¨‹å¸ˆå€’æ˜¯ç©å¾—æŒº6ï¼Œä½†æ˜¯è‡ªå·±å»è§£å†³å¯¹å­—ç¬¦çš„å¤„ç†ï¼Œå¯¹æ•°ç»„çš„å¤„ç†ï¼Œå¯¹æ–‡ä»¶çš„å¤„ç†ï¼Œå‘ç°è‡ªå·±çœŸçš„å¤ªé€Šäº†ï¼Œæ—©çŸ¥å¦‚æ­¤ä½•å¿…å½“åˆå‘¢ï¼Ÿæ²¡åŠæ³•ï¼Œä¸œè¥¿è¿˜æ˜¯å¾—å­¦ï¼Œé€‰æ‹©äº†è¿™æ¡è·¯ï¼Œæ€»ä¸èƒ½ä¸èµ°å§ï¼Œä¸è¿‡è¯´çœŸçš„ï¼Œåˆ°æ—¶å€™è¯¥è½¬è¡Œè¿˜æ˜¯å¾—è½¬è¡Œï¼Œä½†æ˜¯ç°åœ¨è¯¥å­¦å­¦è¿˜æ˜¯å­¦å­¦ã€‚</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/f7912a82.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/afe2faba.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://cdn.909111.xyz/upload/20231206/69956bc04e2445f189b053fe8b8daac9.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-24</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/afe2faba.html&quot;);" href="javascript:void(0);" alt="">Mybatisæ¡†æ¶å­¦ä¹ </a><div class="blog-slider__text">æœ¬æ–‡å°†ä»0åˆ°1æ­å»ºMybatisé¡¹ç›®ï¼Œå¹¶å®ç°ä½¿ç”¨mybatiså®Œæˆç®€å•çš„å¯¹æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥æ“ä½œ</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/afe2faba.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/fd5ae9cb.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://cdn.909111.xyz/upload/20231206/69956bc04e2445f189b053fe8b8daac9.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/fd5ae9cb.html&quot;);" href="javascript:void(0);" alt="">IDEAå…¨å®¶æ¡¶æ¿€æ´»æ¿€æ´»ç </a><div class="blog-slider__text">æœ¬æ–‡å°†é‡ç‚¹ä»‹ç»IDEAå…¨å®¶æ¡¶æ¿€æ´»æ–¹å¼å’Œç›¸å…³çš„å…¨å®¶æ¡¶æ¿€æ´»ç ï¼Œæœ¬ç³»åˆ—å…¨éƒ¨ä½¿ç”¨çš„æ˜¯2022.1æœˆä»½çš„æ¿€æ´»ç </div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/fd5ae9cb.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('å·²æŒ‚è½½butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__rubberBand');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__backInRight');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>
  function gitcalendar_injector_config(){
      var parent_div_git = document.getElementById('gitZone');
      var item_html = '<div class="recent-post-item" id="gitcalendarBar" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 320px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      console.log('å·²æŒ‚è½½gitcalendar')
      }

    if( document.getElementById('gitZone') && (location.pathname ==='/site/census/'|| '/site/census/' ==='all')){
        gitcalendar_injector_config()
        GitCalendarInit("python-github-calendar-api-sand.vercel.app/api?luoxiaohei520",['#d9e0df', '#c6e0dc', '#a8dcd4', '#9adcd2', '#89ded1', '#77e0d0', '#5fdecb', '#47dcc6', '#39dcc3', '#1fdabe', '#00dab9'],'luoxiaohei520')
    }
  </script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":120,"height":240},"mobile":{"show":false},"log":false});</script></body></html>